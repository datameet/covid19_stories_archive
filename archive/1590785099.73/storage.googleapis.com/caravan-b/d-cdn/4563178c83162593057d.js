(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{197:function(t,e,n){"use strict";n(50);var r=n(8),o={en:" and ",hi:" और "},l={inheritAttrs:!0,props:["article"],mixins:[r.c],computed:{items:function(){var t=this,e=this.article.authors;if(0===e.length)return null;var n=e.map((function(e){return'<span itemscope itemProp="author" itemType="http://schema.org/Person">\n          <a href="/author/'.concat(e.id,'">').concat(e.name,'</a>\n          <meta itemProp="sameAs" content="').concat(t.baseUrl,"/author/").concat(e.id,'">\n          <meta itemProp="name" content="').concat(e.name,'">\n        </span>')})),r=n.pop();return 0===n.length?r:1===n.length?n[0]+o[this.lang]+r:n.join('<span class="comma">, </span>')+o[this.lang]+r}},methods:{handleClick:function(t){var e=t.target;e.getAttribute("href")&&this.$router.push({path:e.getAttribute("href")})}}},c=n(3),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"authors is-montserrat",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleClick(e)}}},[n("div",{staticClass:"author",domProps:{innerHTML:t._s(t.items)}})])}),[],!1,null,null,null);e.a=component.exports},216:function(t,e,n){"use strict";n(16);var r=n(38),o={data:function(){return{loaded:0,gaBlocked:!0}},props:["adSlot"],mounted:function(){this.init()},methods:{init:function(){var t=this;return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:Object(r.f)("//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js","adsbygoogle").then((function(e){t.loaded=1,t.gaBlocked=!1,setTimeout((function(){t.pushAdvertisement()}),300)})).catch((function(e){t.gaBlocked=!1,t.loaded=1}));case 1:case"end":return e.stop()}}))},pushAdvertisement:function(){adsbygoogle.push({})}}},l=n(3),component=Object(l.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"basic-promotion-slot"},[!1===this.gaBlocked?[this.adSlot?e("ins",{staticClass:"adsbygoogle",staticStyle:{display:"inline-block",width:"250px",height:"250px"},attrs:{"data-ad-client":"ca-pub-1059364442115504","data-ad-slot":this.adSlot,"data-full-width-responsive":"false"}}):e("ins",{staticClass:"adsbygoogle",staticStyle:{display:"block"},attrs:{"data-ad-client":"ca-pub-1059364442115504","data-ad-slot":"5014649347","data-ad-format":"auto","data-full-width-responsive":"true"}})]:this._e()],2)}),[],!1,null,null,null);e.a=component.exports},247:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=["short-horizontal","short-vertical","long-vertical","long-horizontal","photo-essay","gallery","video"]},248:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={theme:"theme",modimeter:"modimeter",insightBlock:"insightBlock",tag:"tag"}},266:function(t,e,n){"use strict";n(25),n(39),n(52),n(200);var r=n(196),o=n(38),l=n(247),c=n(8),d={props:["gallery"],mixins:[c.f],computed:{photos:function(){return this.gallery.content.filter((function(t){return"figure"===t.type}))}},mounted:function(){var t=this;Object(o.g)().then((function(e){t.prepareSlider(e)}))},beforeDestroy:function(){this.slider&&(this.slider.destroy(),this.slider=null)},methods:{calculateStyle:function(t){return{objectFit:t.attrs.w>t.attrs.h?"cover":"contain"}},getHtml:o.b,getCaption:function(t){if(t.content){var caption=t.content.find((function(t){return"caption"===t.type}));return caption&&caption.content?caption:null}return null},getCredits:function(t){if(t.content){var e=t.content.find((function(t){return"credit"===t.type}));return e&&e.content?e:null}return null},prepareSlider:function(t){var e=new t(this.$el.querySelector(".swiper-container"),{direction:"horizontal",loop:!0,keyboard:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});this.slider=e}}},h=n(3),v=Object(h.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"slider-photo-gallery"},[n("div",{staticClass:"container"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-8 is-offset-2"},[n("div",{staticClass:"wrapper"},[n("div",{staticClass:"content-wrapper"},[n("div",{staticClass:"swiper-button-prev swiper-nav"}),t._v(" "),n("div",{staticClass:"swiper-button-next swiper-nav"}),t._v(" "),n("div",{staticClass:"photo-list-wrapper"},[n("div",{staticClass:"swiper-container"},[n("div",{staticClass:"swiper-wrapper"},t._l(t.photos,(function(e,r){return n("div",{key:r,staticClass:"swiper-slide"},[n("img",{style:t.calculateStyle(e),attrs:{src:t.smartResizeInlineImage(e,450)}}),t._v(" "),t.getCaption(e)?n("figcaption",[n("span",{staticClass:"caption is-roboto",domProps:{innerHTML:t._s(t.getHtml(t.getCaption(e).content))}}),t._v(" "),t.getCredits(e)?n("span",{staticClass:"credits is-montserrat is-uppercase",domProps:{innerHTML:t._s(t.getHtml(t.getCredits(e).content))}}):t._e()]):t._e()])})),0)])])])])])])])])}),[],!1,null,null,null).exports,m=n(304),f=n(197),y=(n(50),{inheritAttrs:!0,props:["items"],computed:{contributors:function(){var t=this.items;if(0===t.length)return null;var e=t.map((function(t){return'<a href="/author/'.concat(t.id,'">').concat(t.name,"</a>")})),n=e.pop();return 0===e.length?n:1===e.length?e[0]+" and "+n:e.join(", ")+" and "+n}},methods:{handleClick:function(t){var e=t.target;e.getAttribute("href")&&this.$router.push({path:e.getAttribute("href")})}}}),C=Object(h.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"contributors is-montserrat",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleClick(e)}}},[n("div",{staticClass:"author",domProps:{innerHTML:t._s(t.contributors)}})])}),[],!1,null,null,null).exports,_=n(262),w=n(41),k=n(103),x=n(29),S={props:["onClose","showClose"],inheritAttrs:!0,mounted:function(){}},P=Object(h.a)(S,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal is-roboto is-active dark-modal is-large"},[n("div",{staticClass:"modal-background"}),t._v(" "),n("div",{staticClass:"modal-content"},[t._t("default")],2),t._v(" "),t.showClose?n("button",{staticClass:"modal-close is-large",attrs:{"aria-label":"close"},on:{click:function(e){return e.preventDefault(),t.onClose(e)}}}):t._e()])}),[],!1,null,null,null).exports,I=n(272),T=l.a,z={components:{CaravanVideoPlayer:function(){return n.e(4).then(n.bind(null,318))},FadeTransition:x.a,LazyHydrate:k.a,VideoEmbed:_.a,Contributors:C,Authors:f.a,SliderPhotoGallery:v,PhotoEssayModal:m.default,SubscriptionVideoComponent:I.a,WhiteModal:P},props:["article"],mixins:[c.f,c.c],data:function(){return{galleryLoaded:0,options:[],loaded:0,video:null,gallery:null,galleryMode:"header",photos:null,activeItem:null,hideDetails:0,showSubscribeModal:0,timer:4e3}},mounted:function(){this.checkVideoVisibility(),this.adjustCoverPhoto(),w.a.$on("app:insideGallery",this.prepareInlineImageGallery),w.a.$on("videoplayer:control",this.controlOverlappingElements)},watch:{showSubscribeModal:function(t){1===t&&this.decrementTimer()}},methods:{decrementTimer:function(){var t=this;this.handler=setInterval((function(){t.timer-=1e3,t.timer<=0&&(clearInterval(t.handler),t.handler=null)}),1e3)},checkVideoVisibility:function(t){var e=this.user,n=(localStorage,this.article.tags.find((function(t){return"covid-19"===t.slug})));console.log({tag:n});var o=localStorage.getItem("settings:closeSubscribeModal");o=o?Object(r.d)(new Date(o),new Date):0,console.log({closeModalUntilDate:o}),(!e.id||0===e.hasSubscribed)&&o<=0&&n&&(this.showSubscribeModal=1)},onCloseModal:function(){var t=Object(r.b)(new Date,120);localStorage.setItem("settings:closeSubscribeModal",t.toISOString()),this.showSubscribeModal=0,this.$ga.event("SubscriptionVideo","close","Closed Modal")},controlOverlappingElements:function(data){this.isMobile||1===data.playing&&(this.hideDetails=1)},getVideoPlayerAttributes:function(){return this.article.data.content[0].attrs},adjustCoverPhoto:function(){var t=this.$el.querySelector(".figure-wrap"),img=t.querySelector(".img-wrap").querySelector("img");img.classList.add("lazyload","blur-up"),setTimeout((function(){window.dispatchEvent(new Event("scroll"))}),200),this.article.coverPhoto.data.w<this.article.coverPhoto.data.h&&(img.style.objectFit="contain"),img.style.background="transparent","long-horizontal"!==this.type&&4!==this.article.style&&t&&this.isMobile&&t.classList.contains("low-ratio")&&console.log("the height needs to be adjusted for devices that does not support vh")},getCoverPosition:function(){if(["long-horizontal","long-vertical"].includes(this.type)){var t=this.article.design;if(t&&t.cover){var e="50% 50%";switch(t.cover){case"top":e="50% 0%";break;case"bottom":e="50% 100%";break;default:e="50% 50%"}return{objectPosition:e}}return{}}return{}},showInlineGallery:function(){var t=this.article.data.content[0];this.prepareInlineImageGallery({item:t})},prepareInlineImageGallery:function(data){4!==this.style?(this.galleryMode="inline",this.photos=[data.item],this.activeItem=0,this.galleryLoaded=1):this.handleGalleryClick()},coverStyle:function(){if(["short-horizontal","long-vertical","short-vertical"].includes(this.type))return{};var t=this.article.coverPhoto.data;t.h,t.w,t.url;return{backgroundPosition:"center",backgroundSize:"cover"}},checkPhotoSize:function(){var t=this.article.coverPhoto.data,e=t.h;t.w;return e>700?"high-res":""},imageSrcSet:function(){var t=this,image=this.article.coverPhoto;return[640,800,1200,1500,1900].map((function(e){return"".concat(t.smartResize(image,e),"?nocheck=gplus ").concat(e,"w")})).join(", ")},adjustHeight:function(){window.innerHeight;var t=this.$el.querySelector(".cover").offsetWidth,e=this.article.coverPhoto.data,n=e.h,r=t/e.w*n;this.$el.querySelector("figure").setAttribute("style","\n        height: ".concat(r,"px;\n        width: ").concat(t,"px;\n      "))},lowQualityImage:function(){return this.article.coverPhoto.data.url.replace("=s0","=s60-l20")},handleGalleryClick:function(){4===this.article.style&&(this.galleryLoaded=1,this.galleryMode="header",this.$ga.event("ShowGallery","click","Check Gallery Click"))},handleGalleryDismissal:function(){this.galleryLoaded=0},handlePlay:function(t){var video=this.article.data.content.find((function(t){return"embed"===t.type&&"youtube"===t.attrs.type})),e=document.querySelector("header");e&&e.classList.add("minimal-header"),this.video=video}},beforeDestroy:function(){w.a.$off("app:insideGallery",this.prepareInlineImageGallery),w.a.$off("videoplayer:control",this.controlOverlappingElements),this.handler&&(clearInterval(this.handler),this.handler=null)},computed:{galleryLoader:function(){return function(){return Promise.resolve().then(n.bind(null,304))}},style:function(){return this.article.style},headStrap:function(){return this.article.printTitle&&this.article.printTitle.trim().length>0?this.article.printTitle:this.article.title},subHeading:function(){return this.article.printTitle&&this.article.printTitle.trim().length>0?this.article.title:null!==this.article.subHeading&&this.article.subHeading.trim().length>0?this.article.subHeading:null},styleClass:function(){var style=this.article.style,t=this.article.data.content[0];if(4===style){var e=this.article.coverPhoto.data;return e.w>e.h?"header-long-horizontal":"header-long-vertical"}return"gallery"===t.type?"header-short-horizontal":6===style?"header-long-horizontal video-article":"header-".concat(["short-horizontal","short-vertical","long-vertical","long-horizontal","long-horizontal","short-horizontal"][style])},type:function(){if("gallery"===this.article.data.content[0].type&&4!==this.article.style)return"gallery";var style=this.article.style;if(4===style){var t=this.article.coverPhoto.data;return t.w>t.h?"long-horizontal":"long-vertical"}return 6===style?"long-horizontal":T[style]},caption:function(){var figure=this.article.data.content[0];if(!figure.content)return null;var t=figure.content.find((function(t){return"caption"===t.type}));return t&&t.content&&t.content.length>0?Object(o.b)(t.content):null},credits:function(){var figure=this.article.data.content[0];if(!figure.content)return null;var t=figure.content.find((function(t){return"credit"===t.type}));return t&&t.content&&t.content.length>0?Object(o.b)(t.content):null},publishDate:function(){return Object(r.j)(this.article.writtenAt,this.lang)},isLowRatio:function(){var image=this.article.coverPhoto;return image.data.w/image.data.h<=1&&1===this.article.style}}},M=Object(h.a)(z,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.article?n("header",{class:"post-header "+t.styleClass},["gallery"!==t.type?n("div",{staticClass:"wrap",class:{container:"long-vertical"===t.type}},[n("fade-transition",{directives:[{name:"show",rawName:"v-show",value:0===t.hideDetails,expression:"hideDetails === 0"}]},[n("div",{staticClass:"details-wrapper"},[n("div",{staticClass:"details",class:{container:"long-horizontal"===t.type||"photo-essay"===t.type}},[n("div",{staticClass:"markers",class:{container:"short-horizontal"===t.type||"short-vertical"===t.type}},[n("div",{staticClass:"pre-heading is-montserrat"},[n("meta",{attrs:{itemprop:"headline",content:t.article.title}}),t._v(" "),n("h2",{staticClass:"title is-5"},[t.article.topic?n("nuxt-link",{staticClass:"topic-name",attrs:{to:"/format/"+t.article.topic.slug}},[t._v("\n                  "+t._s(t.article.topic.name)+"\n                ")]):t._e(),t._v(" "),t.article.theme?n("nuxt-link",{staticClass:"theme",attrs:{to:"/"+t.article.theme.slug}},[t._v(t._s(t.article.theme.name)+"\n                ")]):t._e()],1)]),t._v(" "),n("h1",{staticClass:"title post-title is-serif",class:{"is-1-desktop is-3":"short-horizontal"!==t.type,"is-2-desktop is-3":"short-horizontal"===t.type}},[t._v("\n              "+t._s(t.headStrap)+"\n            ")]),t._v(" "),t.subHeading?n("p",{staticClass:"short-desc is-roboto"},[t._v("\n              "+t._s(t.subHeading)+"\n            ")]):t._e()]),t._v(" "),n("div",{staticClass:"author-details is-size-7 is-montserrat"},[n("div",{staticClass:"w"},[n("div",{staticClass:"authors-wrap"},[n("span",{staticClass:"main-authors"},[t.article.preAuthor?n("span",{staticClass:"pre-byline"},[t._v(t._s(t.article.preAuthor))]):t._e(),t._v(" "),n("authors",{attrs:{article:t.article}})],1),t._v(" "),t.article.contributions?n("div",{staticClass:"contributors-wrap"},t._l(t.article.contributions,(function(e,r){return n("div",{key:r,staticClass:"contribution"},[n("span",{staticClass:"c-t"},[t._v(t._s(e.title))]),t._v(" "),n("contributors",{attrs:{items:e.users}})],1)})),0):t._e()]),t._v(" "),n("span",{staticClass:"date"},[t._v(t._s(t.publishDate))])])]),t._v(" "),4===t.style?n("a",{staticClass:"gallery-icon-wrapper is-montserrat",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.handleGalleryClick(e)}}},[n("i",{staticClass:"icon icon-gallery"}),t._v("\n            View Gallery\n          ")]):t._e()])])]),t._v(" "),n("div",{staticClass:"cover",class:{container:"short-horizontal"===t.type||"short-vertical"===t.type}},[6===t.article.style?n("div",{staticClass:"video-controls-wrapper"},[n("lazy-hydrate",{attrs:{"when-idle":""}},[n("caravan-video-player",{attrs:{attrs:t.getVideoPlayerAttributes(),article:t.article}})],1)],1):t._e(),t._v(" "),n("figure",{attrs:{itemprop:"image",content:"https:"+t.plainImage(t.article.coverPhoto)}},[n("div",{staticClass:"figure-wrap",class:{"low-ratio":t.isLowRatio},style:t.coverStyle()},[n("div",{staticClass:"img-wrap",on:{click:function(e){return e.preventDefault(),t.showInlineGallery(0)}}},["long-horizontal"===t.type?n("span",{staticClass:"af",on:{click:function(e){return e.preventDefault(),t.showInlineGallery(0)}}}):t._e(),t._v(" "),n("img",{staticClass:"type:primaryImage",style:t.getCoverPosition(),attrs:{height:t.article.coverPhoto.data.h,width:t.article.coverPhoto.data.w,"data-srcset":t.imageSrcSet()}})])]),t._v(" "),"gallery"!==t.type?n("figcaption",[n("span",{staticClass:"caption is-roboto",domProps:{innerHTML:t._s(t.caption)}}),t._v(" "),t.credits?n("div",{staticClass:"credits is-montserrat",class:{"is-pulled-right":!t.caption||0===t.caption.length}},[t._v("\n            "+t._s(t.credits)+"\n          ")]):t._e(),t._v(" "),t.caption&&t.caption.length>0?n("div",{staticClass:"line"}):t._e()]):t._e()])])],1):t._e(),t._v(" "),"gallery"!==t.type?n("div",{staticClass:"caption-content container is-roboto"},[n("figcaption",[n("span",{staticClass:"caption",domProps:{innerHTML:t._s(t.caption)}}),t._v(" "),t.credits?n("div",{staticClass:"credits is-montserrat",class:{"is-pulled-right":!t.caption||0===t.caption.length}},[t._v("\n        "+t._s(t.credits)+"\n      ")]):t._e(),t._v(" "),t.caption&&t.caption.length>0?n("div",{staticClass:"line"}):t._e()])]):t._e(),t._v(" "),1===t.galleryLoaded?n(t.galleryLoader,{tag:"photo-essay-modal",attrs:{onDismiss:t.handleGalleryDismissal,items:t.photos,mode:t.galleryMode,activeItem:t.activeItem,article:t.article}}):"gallery"===t.type?n("div",{staticClass:"article-gallery-wrapper"},[n("div",{staticClass:"container"},[n("div",{staticClass:"details-wrapper"},[n("div",{staticClass:"details",class:{container:"long-horizontal"===t.type||"photo-essay"===t.type}},[n("div",{staticClass:"markers",class:{container:"short-horizontal"===t.type||"short-vertical"===t.type}},[n("div",{staticClass:"pre-heading is-montserrat"},[t.article.theme?n("h2",{staticClass:"title is-5"},[t.article.topic?n("a",{staticClass:"topic-name",attrs:{href:""}},[t._v(t._s(t.article.topic.name))]):t._e(),t._v(" "),n("nuxt-link",{staticClass:"theme",attrs:{to:"/"+t.article.theme.slug}},[t._v(t._s(t.article.theme.name))])],1):t._e()]),t._v(" "),n("h1",{staticClass:"title post-title is-serif",class:{"is-1-desktop is-3":"short-horizontal"!==t.type,"is-2-desktop is-3":"short-horizontal"===t.type}},[t._v("\n              "+t._s(t.article.title)+"\n            ")]),t._v(" "),n("p",{staticClass:"short-desc is-roboto"},[t._v(t._s(t.article.subHeading))])]),t._v(" "),n("div",{staticClass:"author-details is-size-7"},[n("authors",{attrs:{article:t.article}}),t._v(" "),n("span",{staticClass:"date"},[t._v(t._s(t.publishDate))])],1)])])]),t._v(" "),n("slider-photo-gallery",{attrs:{gallery:t.article.data.content[0]}})],1):t._e(),t._v(" "),1===t.showSubscribeModal?n("white-modal",{staticClass:"subscription-campaign-modal",attrs:{showClose:t.timer<=0,onClose:t.onCloseModal}},[n("div",{staticClass:"skip-content"},[t.timer>1?n("p",[t._v("\n        You can skip content in "+t._s(t.timer/1e3)+" seconds\n      ")]):n("p",[n("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.onCloseModal(e)}}},[t._v("Skip")])])]),t._v(" "),n("subscription-video-component")],1):t._e()],1):t._e()}),[],!1,null,null,null);e.a=M.exports},267:function(t,e,n){"use strict";n(133),n(16),n(39),n(52),n(200);var r=n(213),o=n(219),l=n(220),c=n(38),d=n(270),h=n(247),v=n(226),m=n(8),f=n(216),y=n(272),C=n(217),_={mixins:[m.c],components:{CurrentIssuePromo:C.a,SubscriptionVideoComponent:y.a,BasicAdSlot:f.a},props:["item","articleId"],inheritAttrs:!0,data:function(){return{loaded:0}},mounted:function(){},methods:{onChangeVisibility:function(t){t&&(this.loaded=1)},trackEvent:function(){this.$ga.event("ModimeterAd","click","InsideArticle")}}},w=n(3),k=Object(w.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:t.onChangeVisibility,expression:"onChangeVisibility"}],staticClass:"inline-promotion-content is-roboto-en",class:{"bg-fill":0===t.item.elementIndex}},[1===t.loaded?[0===t.item.elementIndex?n("div",{staticClass:"covid-slot"},[n("nuxt-link",{attrs:{to:"/covid-19?ref=article&id="+this.articleId}},[n("img",{staticClass:"lazyload blur-up",attrs:{"data-src":"//lh3.googleusercontent.com/KA9bvcqOQjNjqNKYuyy_d12sF_f9iAOsSVA9uW7pczbX5_Bs4s9LR99PeYTP6-nf45FA-nsKnMAN1CLIc0yQRmjxtMM=s600"}})])],1):t.item.elementIndex>1&&2!==t.item.elementIndex&&1===t.user.hasSubscribed?n("basic-ad-slot"):2===t.item.elementIndex&&1!==t.user.hasSubscribed?n("current-issue-promo"):1!==t.user.hasSubscribed&&1===t.item.elementIndex?n("subscription-video-component",{staticClass:"adv",attrs:{mode:"inline"}}):n("basic-ad-slot")]:t._e()],2)}),[],!1,null,null,null).exports,x=n(261),S=n(271),P=n(221),I=(n(50),n(248)),T=n(98),z={props:["articleId","theme","tags"],data:function(){return{intersectedOnce:!1}},methods:{checkVisibility:function(t){return!1},hasEntityExpired:function(t){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(this.$messaging.getToken());case 3:if(e.sent){e.next=6;break}return e.abrupt("return",!0);case 6:return e.abrupt("return",T.a.hasExpired("".concat(t.type,"-").concat(t.id)));case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",!0);case 12:case"end":return e.stop()}}),null,this,[[0,9]])},triggerAction:function(){var t;return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t={name:this.theme.name,type:I.a.theme,id:this.theme.id},e.next=3,regeneratorRuntime.awrap(this.hasEntityExpired(t));case 3:e.sent,this.$store.dispatch("disturber/showNotifier",{message:"Click to receive regular updates on topic <b>".concat(t.name,"</b> in this device"),askLogin:!1,action:"".concat(t.type,"-").concat(t.id),topicTitle:t.name,entity:t});case 5:case"end":return e.stop()}}),null,this)}}},M=Object(w.a)(z,(function(){var t=this.$createElement;return(this._self._c||t)("span",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:this.checkVisibility,expression:"checkVisibility"}],staticClass:"sl"})}),[],!1,null,null,null).exports,E=n(196),$={components:{FadeTransition:n(29).a,SuggestionListener:M,Bq:x.a,SocialEmbed:v.a,ImageElement:l.a,Pullquote:o.a,Paragraph:r.a,SocialShareStrip:d.a,InlineAdvertisement:k,MobileSharePanel:S.a,List:P.a},mixins:[m.c,m.e],props:["article"],data:function(){return{loaded:0,showNotificationPanel:0,notificationRequestPending:0}},mounted:function(){this.loaded=1,this.checkForContent()},computed:{type:function(){if("gallery"===this.article.data.content[0].type&&4!==this.article.style)return"gallery";var style=this.article.style;if(4===style){var t=this.article.coverPhoto.data;return t.w>t.h?"long-horizontal":"long-vertical"}return h.a[style]},extra:function(){var t={isSpecialArticle:0};return this.article.tags.find((function(t){return"covid-19"===t.slug}))&&(t.isSpecialArticle=1,t.link="/covid-19",t.imageUrl="//lh3.googleusercontent.com/80WK4HFJCUt6dwWyRbI8ATENdpJBo1tU12GZNPnuC01Mbn2GcS0vXTH0BBA_-S8MCw3leGHi0IMKNqNJgZ9QpuXGVA=s800"),t},mainContent:function(){var content=this.article.data.content.slice(1),style=this.article.style;if(!1===this.article.hasAds||0===this.loaded)return content;var t=5,e=!1;if([0,1].includes(style)||this.isMobile)for(var i=0,n=content.length,r=0,o=0;i<n;)if(i++,3!==r||!1!==e){if(i%t==0||1===o){if(o=1,"paragraph"!==content[i].type)continue;content.splice(i+r,0,{type:"ad",elementIndex:r}),r++,o=0}else o=0;9===i&&content.splice(i,0,{type:"suggestionListener"})}else t=8,e=!0,i=n<20?18:20;return content},freeContent:function(){return 1===this.article.isPremium?this.mainContent.slice(0,4):0===this.loaded?this.mainContent.slice(0,5):this.mainContent},premiumContent:function(){return 1===this.article.isPremium?this.mainContent.slice(4):[]}},methods:{handleExtraElementClick:function(t){this.$ga.event("SpecialBanner","click",this.isMobile?"mobile":"desktop",this.article.id)},subscribeToTopic:function(t,e){var n,r,o;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!==this.notificationRequestPending){t.next=2;break}return t.abrupt("return",!1);case 2:return n="hindi"===e?"BottomNotifier-hindi":"BottomNotifier",this.notificationRequestPending=1,r=this.$messaging,t.prev=5,t.next=8,regeneratorRuntime.awrap(r.askPermission());case 8:return t.next=10,regeneratorRuntime.awrap(r.getToken());case 10:(o=t.sent)&&this.addTokenToNotificationTopic({token:o,slug:e}),this.notificationRequestPending=0,this.$ga.event(n,"success",e),t.next=21;break;case 16:t.prev=16,t.t0=t.catch(5),console.log(t.t0),this.notificationRequestPending=0,this.$ga.event(n,"fail","Rejected Permission");case 21:case"end":return t.stop()}}),null,this,[[5,16]])},addTokenToNotificationTopic:function(t){var e,n,data;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=t.token,n=t.slug,r.prev=1,r.next=4,regeneratorRuntime.awrap(this.$axios.$post("/api/notification-topics/add",{token:e,slug:n}));case 4:(data=r.sent)&&(console.log({data:data}),data&&data.message&&(this.$showLog(data.message),this.addSubscribedTopic(n),this.showNotificationPanel=0)),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),console.log(r.t0);case 11:case"end":return r.stop()}}),null,this,[[1,8]])},askForNotifications:function(t,e,n){!0===!!(window.Notification||window.webkitNotifications||navigator.mozNotification)&&!0===t&&this.hasLocalStorageSupport()&&!this.hasSubscribedToTopic(n)&&!1===this.hasDismissedNotificationRecently()&&(console.log("yeah"),this.showNotificationPanel=1)},hasLocalStorageSupport:function(){return void 0!==window.localStorage},addSubscribedTopic:function(t){var e=localStorage.getItem("topics")?JSON.parse(localStorage.getItem("topics")):[];-1===e.indexOf(t)&&e.push(t),localStorage.setItem("topics",JSON.stringify(e))},hasSubscribedToTopic:function(t){return(localStorage.getItem("topics")?JSON.parse(localStorage.getItem("topics")):[]).indexOf(t)>=0},hasDismissedNotificationRecently:function(){var t=localStorage.getItem("notificationPanelDismissedAt");return!!(t&&(t=new Date(t),Object(E.c)(new Date,t)<=7))},dismissNotificationPanel:function(t,e){console.log({e:t,topic:e}),t.preventDefault(),localStorage.setItem("notificationPanelDismissedAt",(new Date).toISOString()),this.showNotificationPanel=0},trackSubscribeEvent:function(t){var e=this.isMobile?"mobile":"desktop";this.$ga.event("SubscriptionBait","click",e,this.article.id)},checkForContent:function(){this.$emit("contentCheck",{childCount:this.$refs.articleBody.childElementCount})},getHtml:c.b,handleNavigation:function(t){var e=t.target,n=e.tagName.toLowerCase();if("a"!==n&&(n=(e=e.parentElement).tagName.toLowerCase()),"a"!==n)return!0;var link=e.getAttribute("href");link.startsWith("/")||link.startsWith("http://www.caravanmagazine")||link.startsWith("https://caravanmagazine")||(t.preventDefault(),window.open(link))},signIn:function(){this.$store.commit("settings/change",{key:"needsReload",value:1}),this.$store.dispatch("settings/showLogin")}}},A=Object(w.a)($,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("article",{staticClass:"post",class:"is-"+t.type,attrs:{id:"single-article"}},[n("div",{staticClass:"content",class:{"is-relative":0===t.article.style||1===t.article.style}},[n("div",{staticClass:"w is-calluna"},[1===t.loaded?n("div",{staticClass:"addons"},[n("social-share-strip",{attrs:{article:t.article}})],1):t._e(),t._v(" "),n("div",{ref:"articleBody",staticClass:"t",attrs:{itemprop:"articleBody"},on:{click:t.handleNavigation}},[1===t.loaded&&1===t.extra.isSpecialArticle?n("div",{staticClass:"custom-logo"},[n("nuxt-link",{attrs:{to:t.extra.link},nativeOn:{click:function(e){return t.handleExtraElementClick(e)}}},[n("img",{staticClass:"lazyload",attrs:{"data-src":t.extra.imageUrl,alt:""}})])],1):t._e(),t._v(" "),"hi"===t.article.lang?n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:{callback:function(e,n){return t.askForNotifications(e,n,"hindi")},once:!0},expression:"{\n            callback: (isVisible, entry) =>\n              askForNotifications(isVisible, entry, 'hindi'),\n            once: true\n          }"}],staticClass:"notification-listener"}):t._e(),t._v(" "),"hi"===t.article.lang&&1===t.showNotificationPanel?[n("fade-transition",{directives:[{name:"show",rawName:"v-show",value:1===t.showNotificationPanel,expression:"showNotificationPanel === 1"}]},[n("div",{staticClass:"ask-for-notification"},[n("div",{staticClass:"panel-wrap"},[n("button",{staticClass:"dismiss-panel delete",on:{click:function(e){return e.preventDefault(),t.dismissNotificationPanel(e,"hindi")}}}),t._v(" "),n("p",[t._v("\n                  कारवां की खबरों के लिए हमें सब्सक्राइब करें.\n                ")]),t._v(" "),n("button",{staticClass:"button is-primary panel-btn",on:{click:function(e){return e.preventDefault(),t.subscribeToTopic(e,"hindi")}}},[0===t.notificationRequestPending?n("span",[t._v("सब्सक्राइब")]):n("span",[n("i",{staticClass:"icon icon-spinner"})])])])])])]:t._e(),t._v(" "),t._l(t.freeContent,(function(e,r){return["paragraph"===e.type&&e.content?n("paragraph",{key:r,attrs:{item:e}}):"blockquote"===e.type?n("bq",{key:r,attrs:{content:e.content}}):"pullquote"===e.type?n("pullquote",{key:r,attrs:{item:e}}):"ad"===e.type?n("inline-advertisement",{key:r,staticClass:"breaker",attrs:{"article-id":t.article.id,item:e}}):"figure"===e.type&&e.attrs&&e.attrs.src?n("image-element",{key:r,attrs:{item:e}}):"embed"===e.type?n("social-embed",{key:r,attrs:{item:e}}):"suggestionListener"===e.type?n("suggestion-listener",{key:r,attrs:{"article-id":t.article.id,theme:t.article.theme,tags:t.article.tags}}):"horizontal_rule"===e.type?n("hr",{key:r}):["ordered_list","bullet_list"].includes(e.type)?n("list",{key:r,attrs:{item:e}}):t._e()]})),t._v(" "),t.premiumContent.length>0?n("div",{staticClass:"paywall",attrs:{itemprop:"hasPart",itemscope:"",itemType:"https://schema.org/WebPageElement"}},[n("meta",{attrs:{itemprop:"isAccessibleForFree",content:"False"}}),t._v(" "),n("meta",{attrs:{itemprop:"cssSelector",content:".paywall"}}),t._v(" "),t._l(t.premiumContent,(function(e,r){return["paragraph"===e.type&&e.content?n("paragraph",{key:r,attrs:{item:e}}):"blockquote"===e.type?n("bq",{key:r,attrs:{content:e.content}}):"pullquote"===e.type?n("pullquote",{key:r,attrs:{item:e}}):"ad"===e.type?n("inline-advertisement",{key:r,staticClass:"breaker",attrs:{item:e}}):"figure"===e.type&&e.attrs&&e.attrs.src?n("image-element",{key:r,attrs:{item:e}}):"embed"===e.type?n("social-embed",{key:r,attrs:{item:e}}):"horizontal_rule"===e.type?n("hr",{key:r}):"suggestionListener"===e.type?n("suggestion-listener",{key:r,attrs:{tags:t.article.tags,"article-id":t.article.id,theme:t.article.theme}}):["ordered_list","bullet_list"].includes(e.type)?n("list",{key:r,attrs:{item:e}}):t._e()]}))],2):t._e(),t._v(" "),!0===t.article.paywall?n("div",[n("div",{staticClass:"subscribe-plan"},[n("nuxt-link",{attrs:{to:"/subscribe?ref="+t.article.id},nativeOn:{click:function(e){return t.trackSubscribeEvent(e)}}},[n("img",{staticClass:"lazyload blur-up",attrs:{"data-src":"/img/subscribe-photo.jpg?v=01-2019"}})]),t._v(" "),t.user.id?t._e():n("p",{staticClass:"hint is-roboto"},[t._v("\n              Already a subscriber?\n              "),n("strong",[n("a",{attrs:{href:"#"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.signIn(e)}}},[t._v("Sign in")])])])],1)]):t._e()],2),t._v(" "),n("div",{staticClass:"authors is-roboto"},[t._l(t.article.authors,(function(e,r){return[e.info&&e.info.data?n("div",{key:r,staticClass:"about-author"},[n("p",[n("nuxt-link",{attrs:{to:"/author/"+e.id}},[t._v(t._s(e.name))]),t._v(" "),n("span",{domProps:{innerHTML:t._s(t.getHtml(e.info.data))}})],1)]):t._e()]})),t._v(" "),1===t.loaded&&t.article.contributions&&t.article.contributions.length>0?t._l(t.article.contributions,(function(e){return n("span",{key:e.id},[n("span",[n("div",{staticClass:"about-author"},t._l(e.users,(function(e,r){return n("p",{key:r},[e?[n("span",{staticClass:"author"},[t._v(t._s(e.name))]),t._v(" "),e.info&&e.info.data?n("span",{domProps:{innerHTML:t._s(t.getHtml(e.info.data))}}):t._e()]:t._e()],2)})),0)])])})):t._e()],2),t._v(" "),n("meta",{attrs:{itemprop:"keywords",content:t.article.tags.map((function(t){return t.name})).join(",")}}),t._v(" "),t.article.tags.length>0?n("span",{staticClass:"tags is-roboto-en"},[n("span",{staticClass:"key-word-title"},[t._v("Keywords: ")]),t._v(" "),t._l(t.article.tags,(function(e,r){return n("nuxt-link",{key:r,staticClass:"tag",attrs:{to:"/tag/"+e.slug}},[t._v("\n          "+t._s(e.name)+"\n        ")])}))],2):t._e()]),t._v(" "),1===t.loaded&&t.isMobile?n("mobile-share-panel",{attrs:{article:t.article}}):t._e()],1)])}),[],!1,null,null,null);e.a=A.exports},272:function(t,e,n){"use strict";n(16);var r=n(262),o={inheritAttrs:!0,props:["mode"],mixins:[n(8).c],components:{VideoEmbed:r.a},mounted:function(){this.getItem()},data:function(){return{id:null}},methods:{trackEvent:function(t){"inline"===this.mode?this.$ga.event("InlineSubscriptionVideo","subscribeClick","Clicked on Subscribe Button"):this.$ga.event("SubscriptionVideo","subscribeClick","Clicked on Subscribe Button")},getItem:function(){var data;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,regeneratorRuntime.awrap(this.$axios.$get("/api/subscription-videos",{params:{context:"popupPanel"}}));case 3:(data=t.sent)&&data.video&&(this.id=data.video),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),null,this,[[0,7]])}}},l=n(3),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box subscription-video-component"},[n("div",{staticClass:"bgw"},[n("img",{staticClass:"vc-img",class:{center:"inline"===t.mode},attrs:{src:"//lh3.googleusercontent.com/KKQVMIUzho6CodVWVnwRwBSSIOJKKujBbY6GTBq8ytQjmkRPw9DQ6TvpJlq-EpAATPfqZ7aNVQbzz0hW9cQjRFdpbw=s200",alt:""}}),t._v(" "),t.id?n("video-embed",{attrs:{noPadding:!0,item:{id:t.id,height:560,width:315,type:"youtube"},autoplay:"inline"!==t.mode}}):t._e(),t._v(" "),n("p",{staticStyle:{"text-align":"center","margin-top":"1rem"}},[n("a",{staticClass:"button is-primary is-uppercase is-roboto-en",attrs:{href:"https://"+t.settings.domain+"/subscribe"},nativeOn:{click:function(e){return t.trackEvent(e)}}},[t._v("Subscribe")])])],1)])}),[],!1,null,null,null);e.a=component.exports},304:function(t,e,n){"use strict";n.r(e);n(25),n(200);var r=n(197),o=n(38),l=n(8),c={components:{Authors:r.a},props:["article","onDismiss","items","mode","activeItem"],mixins:[l.c,l.f],data:function(){return{selectedIndex:0,showText:0,loaded:0}},mounted:function(){var t=this;this.loaded=1,"inline"===this.mode&&this.isMobile&&(this.showText=1),setTimeout((function(){t.loadLibs()}),400),console.log({mode:this.mode})},computed:{link:function(){return"".concat(this.baseUrl).concat(this.article.slug)},photos:function(){return this.items?this.items:this.article.data.content[0].content.filter((function(t){return"figure"===t.type}))},caption:function(){var caption=this.photos[this.selectedIndex].content.find((function(t){return"caption"===t.type}));return caption&&caption.content&&caption.content.length>0?caption.content:null},credits:function(){var t=this.photos[this.selectedIndex].content.find((function(t){return"credit"===t.type}));return t&&t.content&&t.content.length>0?t.content:null}},beforeDestroy:function(){this.slider&&(this.slider.destroy(),this.slider=null)},methods:{smartFigureResize:function(t,e){return t.src.replace("=s0","=s".concat(e))},smartSrcSet:function(t){var image=t.attrs;return"".concat(this.smartFigureResize(image,1500)," 1500w,\n              ").concat(this.smartFigureResize(image,1800)," 1800w,\n              ").concat(this.smartFigureResize(image,2400)," 2400w")},getCredits:function(t){var e=t.content.find((function(t){return"credit"===t.type}));return e&&e.content&&e.content.length>0?e.content:null},getCaption:function(t){var caption=t.content.find((function(t){return"caption"===t.type}));return caption&&caption.content&&caption.content.length>0?caption.content:null},toggleText:function(){this.isMobile&&(this.showText=0===this.showText?1:0)},getHtml:o.b,handleDismiss:function(t){document.removeEventListener("keyup",this.listenToEscape),this.onDismiss()},loadLibs:function(){var t=this;Object(o.g)().then((function(e){t.initGallery(e)}))},calculateStyle:function(t){},onSlideChanged:function(){if(this.slider){var t=this.slider.slides[this.slider.activeIndex],e=t.querySelector("img").parentElement,n=e.getAttribute("data-id"),r=this.photos.find((function(t){return t.attrs.id===n})),o=e.getBoundingClientRect(),l={width:o.width,height:o.height};if(r.attrs.w&&r.attrs.h){var c={width:r.attrs.w,height:r.attrs.h},d=c.width/c.height,h=null;h=d>=1?l.width/d:l.height,h=Math.round(h),l.height>c.height&&(console.log("yes thats the case"),h=c.height);var caption=t.querySelector(".caption"),img=e.querySelector("img"),v=(l.height-h)/2;caption&&v>0&&!this.isMobile&&(caption.style.marginBottom="".concat(v,"px")),v>0&&(img.style.marginTop="".concat(v,"px")),img.style.height="".concat(h,"px"),img.style.opacity="1",d<1&&(this.isMobile?(h=Math.floor(l.width/d),img.style.height="".concat(h,"px"),l.height>h&&(img.style.marginTop="".concat(Math.floor((l.height-h)/2),"px")),img.style.width=""):img.style.width="".concat(Math.floor(h*d),"px"))}}},initGallery:function(t){var e=this,n=this.activeItem&&-1!==this.activeItem?this.activeItem:0;this.selectedIndex=n;var r={direction:"horizontal",loop:!0,keyboard:!0,preload:!1,lazy:{loadPrevNext:!0,loadPrevNextAmount:2},slidesPerView:1,initialSlide:n,init:!1};"inline"!==this.mode?r.navigation={nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}:r.keyboard=!1;var o=new t(this.$el.querySelector(".swiper-container"),r);o.on("slideChange",(function(t){e.updateIndex(t)})),setTimeout((function(){if(e.isMobile){var t=e.$el.querySelector(".content-wrapper"),footer=e.$el.querySelector(".social-media-wrapper");t.style.height="".concat(window.innerHeight-t.offsetTop-footer.offsetHeight,"px")}var n=e.$el.querySelector(".swiper-wrapper"),r=e.$el.querySelector(".photo-list-wrapper");n.style.height="".concat(r.offsetHeight,"px"),n.style.maxHeight="".concat(r.offsetHeight,"px"),console.log("adjusting height is complete")}),100),this.slider=o,this.slider.on("slideChange",(function(){setTimeout((function(){e.onSlideChanged()}),100)})),"inline"===this.mode&&(o.allowTouchMove=!1),o.on("click",(function(t){e.toggleText()})),o.init(),this.isMobile||this.listenToKeyboardEvents()},listenToEscape:function(t){27===t.keyCode&&this.handleDismiss(t)},listenToKeyboardEvents:function(){document.addEventListener("keyup",this.listenToEscape)},updateIndex:function(){var t=this.slider.realIndex;t===this.photos.length&&t--,this.selectedIndex=t}}},d=n(3),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"photo-essay-modal",class:{"show-captions-mobile":1===t.showText}},[n("div",{staticClass:"main-logo-wrapper"},[n("nuxt-link",{staticClass:"logo",attrs:{to:"/"}})],1),t._v(" "),n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"modal-wrapper"},[n("div",{staticClass:"title-wrapper"},["inline"!==t.mode?[n("h3",{staticClass:"title is-3 is-inline-block-tablet",on:{click:function(e){return e.preventDefault(),t.handleDismiss(e)}}},[t._v("\n            "+t._s(t.article.printTitle)+"\n          ")]),t._v(" "),n("authors",{staticClass:"is-inline-block-tablet is-montserrat",attrs:{article:t.article}})]:t._e(),t._v(" "),n("a",{staticClass:"delete",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.handleDismiss(e)}}})],2),t._v(" "),n("div",{staticClass:"content-wrapper"},["inline"!==t.mode?[n("div",{staticClass:"swiper-button-prev swiper-nav"}),t._v(" "),n("div",{staticClass:"swiper-button-next swiper-nav"})]:t._e(),t._v(" "),n("div",{staticClass:"photo-list-wrapper"},[n("div",{staticClass:"swiper-container"},[n("div",{staticClass:"swiper-wrapper"},t._l(t.photos,(function(e,r){return n("div",{key:r,staticClass:"swiper-slide"},[n("div",{staticClass:"flex-wrapper"},[n("div",{staticClass:"p",attrs:{"data-id":e.attrs.id}},[n("img",{staticClass:"swiper-lazy",style:t.calculateStyle(e),attrs:{"data-src":t.smartResizeInlineImage(e,400),"data-srcset":t.smartSrcSet(e)}})]),t._v(" "),t.getCaption(e)||t.getCredits(e)?n("div",{staticClass:"text-wrapper is-roboto"},[n("div",{staticClass:"caption"},[n("p",[t.getCaption(e)?n("span",{staticClass:"is-caption",domProps:{innerHTML:t._s(t.getHtml(t.getCaption(e)))}}):t._e(),t._v(" "),t.getCredits(e)?n("span",{staticClass:"is-montserrat is-credits",domProps:{innerHTML:t._s(t.getHtml(t.getCredits(e)))}}):t._e()])])]):t._e()]),t._v(" "),n("div",{staticClass:"swiper-lazy-preloader"})])})),0)])])],2),t._v(" "),n("div",{staticClass:"is-flex social-media-wrapper"},[n("div",{staticClass:"social-media-buttons is-roboto is-size-7"},[1===t.loaded?n("social-sharing",{staticClass:"icons",attrs:{url:t.link,title:t.article.title,"twitter-user":"thecaravanindia"},inlineTemplate:{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("network",{attrs:{network:"facebook"}},[e("i",{staticClass:"icon icon-facebook"})]),this._v(" "),e("network",{attrs:{network:"twitter"}},[e("i",{staticClass:"icon icon-twitter"})])],1)},staticRenderFns:[]}}):t._e(),t._v(" "),t.photos.length>1?n("div",{staticClass:"slide-count"},[t._v("\n            "+t._s(t.selectedIndex+1)+" / "+t._s(t.photos.length)+"\n          ")]):t._e()],1)])])])])}),[],!1,null,null,null);e.default=component.exports}}]);