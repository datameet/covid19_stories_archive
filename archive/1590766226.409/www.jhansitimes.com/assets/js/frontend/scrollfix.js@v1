!function(o){o.isScrollToFixed=function(i){return void 0!==o(i).data("ScrollToFixed")},o.ScrollToFixed=function(i,e){var t=this;t.$el=o(i),t.el=i,t.$el.data("ScrollToFixed",t);var n,l,r,d=!1,s=t.$el,x=0,c=0,p=-1,f=-1,u=null;function a(){var o=t.options.limit;return o?"function"==typeof o?o.apply(s):o:0}function F(){return"fixed"===n}function g(){return"absolute"===n}function T(){return!(F()||g())}function S(){F()||(u.css({display:s.css("display"),width:s.outerWidth(!0),height:s.outerHeight(!0),float:s.css("float")}),s.css({width:s.width(),position:"fixed",top:-1==t.options.bottom?h():"",bottom:-1==t.options.bottom?"":t.options.bottom,"margin-left":"0px"}),s.addClass("scroll-to-fixed-fixed"),t.options.className&&s.addClass(t.options.className),n="fixed")}function b(){var o=a(),i=c;t.options.removeOffsets&&(i=0,o-=x),s.css({width:s.width(),position:"absolute",top:o,left:i,"margin-left":"0px",bottom:""}),n="absolute"}function m(){T()||(f=-1,u.css("display","none"),s.css({width:"",position:l,left:"",top:r.top,"margin-left":""}),s.removeClass("scroll-to-fixed-fixed"),t.options.className&&s.removeClass(t.options.className),n=null)}function w(o){o!=f&&(s.css("left",c-o),f=o)}function h(){var o=t.options.marginTop;return o?"function"==typeof o?o.apply(s):o:0}function v(){if(o.isScrollToFixed(s)){var i=d;d||(s.trigger("preUnfixed.ScrollToFixed"),m(),s.trigger("unfixed.ScrollToFixed"),f=-1,x=s.offset().top,c=s.offset().left,t.options.offsets&&(c+=s.offset().left-s.position().left),-1==p&&(p=c),n=s.css("position"),d=!0,-1!=t.options.bottom&&(s.trigger("preFixed.ScrollToFixed"),S(),s.trigger("fixed.ScrollToFixed")));var e=o(window).scrollLeft(),r=o(window).scrollTop(),u=a();t.options.minWidth&&o(window).width()<t.options.minWidth?T()&&i||(U(),s.trigger("preUnfixed.ScrollToFixed"),m(),s.trigger("unfixed.ScrollToFixed")):-1==t.options.bottom?u>0&&r>=u-h()?g()&&i||(U(),s.trigger("preAbsolute.ScrollToFixed"),b(),s.trigger("unfixed.ScrollToFixed")):r>=x-h()?(F()&&i||(U(),s.trigger("preFixed.ScrollToFixed"),S(),f=-1,s.trigger("fixed.ScrollToFixed")),w(e)):T()&&i||(U(),s.trigger("preUnfixed.ScrollToFixed"),m(),s.trigger("unfixed.ScrollToFixed")):u>0?r+o(window).height()-s.outerHeight(!0)>=u-(h()||-(t.options.bottom?t.options.bottom:0))?F()&&(U(),s.trigger("preUnfixed.ScrollToFixed"),"absolute"===l?b():m(),s.trigger("unfixed.ScrollToFixed")):(F()||(U(),s.trigger("preFixed.ScrollToFixed"),S()),w(e),s.trigger("fixed.ScrollToFixed")):w(e)}}function U(){var o=s.css("position");"absolute"==o?s.trigger("postAbsolute.ScrollToFixed"):"fixed"==o?s.trigger("postFixed.ScrollToFixed"):s.trigger("postUnfixed.ScrollToFixed")}var y=function(o){s.is(":visible")&&(d=!1,v())},A=function(o){v()};t.init=function(){t.options=o.extend({},o.ScrollToFixed.defaultOptions,e),t.$el.css("z-index",t.options.zIndex),u=o("<div />"),n=s.css("position"),l=s.css("position"),r=o.extend({},s.offset()),T()&&t.$el.after(u),o(window).bind("resize.ScrollToFixed",y),o(window).bind("scroll.ScrollToFixed",A),t.options.preFixed&&s.bind("preFixed.ScrollToFixed",t.options.preFixed),t.options.postFixed&&s.bind("postFixed.ScrollToFixed",t.options.postFixed),t.options.preUnfixed&&s.bind("preUnfixed.ScrollToFixed",t.options.preUnfixed),t.options.postUnfixed&&s.bind("postUnfixed.ScrollToFixed",t.options.postUnfixed),t.options.preAbsolute&&s.bind("preAbsolute.ScrollToFixed",t.options.preAbsolute),t.options.postAbsolute&&s.bind("postAbsolute.ScrollToFixed",t.options.postAbsolute),t.options.fixed&&s.bind("fixed.ScrollToFixed",t.options.fixed),t.options.unfixed&&s.bind("unfixed.ScrollToFixed",t.options.unfixed),t.options.spacerClass&&u.addClass(t.options.spacerClass),s.bind("resize.ScrollToFixed",function(){u.height(s.height())}),s.bind("scroll.ScrollToFixed",function(){s.trigger("preUnfixed.ScrollToFixed"),m(),s.trigger("unfixed.ScrollToFixed"),v()}),s.bind("detach.ScrollToFixed",function(i){var e;(e=(e=i)||window.event).preventDefault&&e.preventDefault(),e.returnValue=!1,s.trigger("preUnfixed.ScrollToFixed"),m(),s.trigger("unfixed.ScrollToFixed"),o(window).unbind("resize.ScrollToFixed",y),o(window).unbind("scroll.ScrollToFixed",A),s.unbind(".ScrollToFixed"),t.$el.removeData("ScrollToFixed")}),y()},t.init()},o.ScrollToFixed.defaultOptions={marginTop:0,limit:0,bottom:-1,zIndex:1e3},o.fn.scrollToFixed=function(i){return this.each(function(){new o.ScrollToFixed(this,i)})}}(jQuery);