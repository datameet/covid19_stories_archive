var targettingObj,mnmenu,msmore,bLazy;function getTargetingObj(){targettingObj=JSON.parse(document.getElementById("page-targeting").getAttribute("data-targeting"));var e=tnTrafficSrcCookie.getCookie();return targettingObj.source=e.source,targettingObj.medium=e.medium,targettingObj}function getLazyLoadEffect(){bLazy=new Blazy({success:function(){updateCounter()},error:function(e,t){"missing"===t?console.log("Data-src is missing"):"invalid"===t&&console.log("Data-src is invalid")}})}!function(e,t){var a=location.hostname.split(".").reverse(),r="."+a[1]+"."+a[0];function n(e,t){try{var a=e.match("[?&]"+t+"=([^&]+)");return a?a[1]:""}catch(e){return""}}var s=function(){for(var e,a=t.cookie.split(";"),r=0;r<a.length;r++)if(a[r].indexOf("tn_traffic_src")>=0){e=a[r];break}return e?(e=e.substring(e.indexOf("=")+1,e.length),JSON.parse(e)):null};e.tnTrafficSrcCookie={setCookie:function(){var e=s(),a=function(){var e="",a="",r="",s=[["bing","q"],["google","q"],["yahoo","q"],["baidu","q"],["yandex","q"],["ask","q"]],o=t.referrer;o=o.substr(o.indexOf("//")+2),ref_domain=o,ref_path="/",ref_search="";var i=t.location.search;if(i.indexOf("utm_source")>-1)e=n(i,"utm_source"),a=n(i,"utm_medium"),r=n(i,"utm_campaign"),n(i,"utm_term"),n(i,"utm_content");else if(n(i,"gclid"))e="google",a="cpc",r="(not set)";else if(o){o.indexOf("/")>-1&&(ref_domain=o.substr(0,o.indexOf("/")),ref_path=o.substr(o.indexOf("/")),ref_path.indexOf("?")>-1&&(ref_search=ref_path.substr(ref_path.indexOf("?")+1),ref_path=ref_path.substr(0,ref_path.indexOf("?")))),a="referral",e=ref_domain;for(var c=0;c<s.length;c++)if(ref_domain.indexOf(s[c][0])>-1){a="organic",e=s[c][0],n(ref_search,s[c][1]);break}}return e=0===e.length?"direct":e,a=0===a.length?"none":a,r=0===r.length?"direct":r,"referral"===a&&(r=""),{source:e,medium:a,campaign:r}}();0!==t.referrer.indexOf(location.protocol+"//"+location.host)&&"direct"!=a.source||null==e||(a=e);var o=JSON.stringify(a),i=new Date;i.setTime(i.getTime()+18e5),t.cookie="tn_traffic_src="+o+"; domain="+r+"; path=/; expires="+i.toUTCString()+";"},getCookie:s}}(window,document),tnTrafficSrcCookie.setCookie(),$(document).ready(function(){if($("body .b-lazy").length>0&&(getLazyLoadEffect(),setTimeout(function(){bLazy.revalidate()},1e3)),0==$("#article_id").length)$("ul.tabs li").click(function(){var e=$(this).attr("data-tab");$("ul.tabs li").removeClass("current"),$(".tab-content").removeClass("current"),$(this).addClass("current"),$("#"+e).addClass("current")}),$.fn.dfp&&(targettingObj=getTargetingObj(),$(".adunit").dfp({setTargeting:targettingObj,setRequestNonPersonalizedAds:personalAds}));else if($.fn.dfp){articleId=$("#article_id").val(),targettingObj=JSON.parse(document.getElementById("page-targeting-"+articleId).getAttribute("data-targeting"));var e=tnTrafficSrcCookie.getCookie();targettingObj.source=e.source,targettingObj.medium=e.medium,$("#article_id").length>0&&(targettingObj.id=articleId,targettingObj.article_sequence="0"),$(".adunit").dfp({setTargeting:targettingObj,setRequestNonPersonalizedAds:personalAds})}}),window.onbeforeunload=function(){window.scrollTo(0,0)},$.fn.slick&&$(".flash-news").slick({dots:!1,infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1,arrows:!1,autoplay:!0}),$("header > .header > .main-menu > ul > li").on({mouseenter:function(){var e=$(this);e.find(".sub-cover").length>0&&(mnmenu=setTimeout(function(){e.find(".sub-cover").fadeIn(),$(".page-cover").fadeIn(),$(".search-content").fadeOut(),$(e.find(".sub-cover > .sub-menu > ul > li")).on({mouseenter:function(){$(this).find(".l2").fadeIn()},mouseleave:function(){$(this).find(".l2").fadeOut()}})},300))},mouseleave:function(){clearTimeout(mnmenu),$(this).find(".sub-cover").fadeOut(),$(".page-cover").fadeOut()}}),$(".menu-more").on({mouseenter:function(){var e=$(this);msmore=setTimeout(function(){e.addClass("active"),$(".page-cover").fadeIn(),$(".search-content").fadeOut()},300)},mouseleave:function(){clearTimeout(msmore),$(this).removeClass("active"),$(".page-cover").fadeOut()}}),$(".search-icon img").on("click",function(){$(this).parent().find(".search-content").toggle(),$(".page-cover").fadeToggle(),$(".search").val(""),$(".search-result").empty()}),$(".page-cover").on("click",function(){$(this).fadeOut(),$(".search-content").fadeOut()}),$(".close-search").on("click",function(){$(".search-content").slideUp(150),$(".page-cover").fadeOut(),$(".search").val(""),$(".search-result").empty()}),$(".search").on("click",function(){var e=$(".search").val();console.log("searchKeywords"+e),""!=e&&e.length<3&&($(".search").val(""),$(".search-result").remove())}),$(".search").keyup(function(e){if(console.log("hwrwer"),13==e.which)goToSearch();else{var t=$(".search").val();""!=t&&t.length>3?$.ajax({url:"/searchresults",data:{searchterm:t,autosuggest:1},dataType:"json",async:!1,success:function(e){searchTitle={},searchTitle=e.result_items;var t="";$.each(searchTitle,function(e,a){t+="<a onclick=setThisValue(this) href='"+a.story_url+"'>"+a.title+"</a>"}),$(".search-result").html(),$(".search-result").html(t)}}):$(".search-result").html("")}});var imageLoaded=0,eleCountLoadedImages=$("#loaded-images");function updateCounter(){imageLoaded++,eleCountLoadedImages.html(imageLoaded)}function goToSearch(){var e=$(".search").val(),t=$(".page-header-text").val();""!=e?(ga("send","event",t,"Search",e),$("#autosuggest").val(0),window.location.href="/searchresults?searchterm="+e):""==e&&alert("Please enter search keywords")}function setThisValue(e){var t=$(e).text();$(".search").val(t),$(".search-result").html(""),$(".search").focus(),goToSearch()}function comscoreCall(){setTimeout(function(){self.COMSCORE&&COMSCORE.beacon({c1:"2",c2:"26200502"});var e=Date.now(),t=new XMLHttpRequest,a="/scorecard.xml?"+e;t.open("GET",a),t.send()},2e3)}function setEvent(e,t,a){var r=$("#header_text").val();ga("send","event",r,a+"-"+e,t)}function sendEvent(e,t,a){ga("send","event",e,t,a)}function addPollData(e,t,a){var r=$(e).closest(".sub-section1").find("input[name='answer']:checked").val();""!=r&&null!=r?(url="/story/add_poll_data",$.ajax({type:"POST",url:url,data:{nid:t,choice_id:r,title:a},dataType:"json",async:!1,success:function(t){var a=t.poll_lang,r="",n="vote";$(e).closest(".widgets").find(".poll_widgets_1").hide(),$(e).closest(".widgets").find(".poll_widgets_2").removeClass("hide"),$(e).closest(".widgets").find(".poll_ques").append(t.msg),r+="<div class='progress-wrap'>";var s;s=t.poll_results.poll_choice,$.each(s,function(e,t){r+='<div class="data">'+t.poll_choice_label+"</div>",r+='<div class="progress">',r+='<div class="active-progress-bar"  style="width:'+t.votes+'%"></div>',r+='<div class="percent">'+t.votes+"%</div>",r+="</div>"}),r+="</div>";var o=t.poll_results.totalVotes;"hindi"==a||"marathi"==a?n="वोट":("hindi"!=a&&"marathi"!=a)&&o>1&&(n="votes"),r+="<div class='poll_votes'>"+t.poll_results.totalVotes+" "+n+"</div>",$(e).closest(".widgets").find(".poll_widgets_2").find(".sub-section2").append(r)}})):($(".note").empty(),$(".alert-box").slideDown().delay(2e3).fadeOut(),$(".alert-box").removeClass("hide"),$(".alert-box").removeClass("success"),$(".alert-box").removeClass("primary"),$(".alert-box").addClass("show"),$(".note").append("Please select choice."))}function getSearchResult(){parseInt($("#total_count").val());var e=parseInt($("#no_of_page").val()),t=(parseInt($("#curr_page").val()),parseInt($("#fetched_count").val()),$("#lang").val(),$("#searchterm").val(),$("#sub_type").val());e>1&&($(".pages").show(),$(".pages").twbsPagination({totalPages:e,visiblePages:5,onPageClick:function(e,t){}}).on("page",function(e,a){getStoriesOfSearch(t,a,1)}))}function getStoriesOfSearch(e,t,a){getLazyLoadEffect(),$(this).scrollTop(0);var r=parseInt(t)-1,n=$("#searchterm").val();url="/searchresults/"+e+"/"+r,$.ajax({url:url,type:"GET",dataType:"json",data:{searchterm:n},async:!1,success:function(t){$("#curr_page").val(r),$("#sub_type").val(e),$("#fetched_count").val(t.fetched_stories),$("#no_of_page").val(t.no_of_pages),$("#total_count").val(t.result_items),$("#result_count").html(t.result_items);var a={};if(t.result_items.length>0){a=t.result_items;var n="";n+='<div class="search-box">',$.each(a,function(e,t){n+='<a href="'+t.story_url+'" class="component_2">',n+='<div class="img-pod">',n+='<img data-src="'+t.image_thumb+'?tr=w-100,h-75" src="'+global_default_img+'" class="b-lazy img-responsive" alt="'+t.alt_text+'"/> ',"Image Gallery"!=t.sub_type&&"Photo Story"!=t.sub_type||(n+='<div class="gallery-icon">',n+="</div>"),"Video"==t.sub_type&&(n+='<div class="video-icon"></div>'),n+="</div>",n+='<div class="text">'+t.title+"</div>"}),n+="</div>",$(".search-box").html(""),$(".search-box").html(n)}}})}function socialSharing(e,t){var a=$("#"+t).attr("title"),r=$("#"+t).attr("desc"),n=$("#"+t).attr("shortUrl"),s=$("#"+t).attr("data-src");sendEvent("Share",e,a),"twitter"==e&&(r="");var o="";o=""!=n&&null!=n&&"gplus"!=e?n:window.location.href,share(e,a,r,o,s)}function mailTo(e,t,a){sendEvent("Share","Mail",e),window.location.href="mailto:?subject="+encodeURIComponent(e)+"&body="+encodeURIComponent(t)+"%0D%0A\r\n"+encodeURIComponent(a)}var observer,images=document.querySelectorAll(".lazy-image"),config={rootMargin:"50px 0px",threshold:.01},imageCount=images.length;if("IntersectionObserver"in window){observer=new IntersectionObserver(onIntersection,config);for(var i=0;i<images.length;i++){var image=images[i];image.classList.contains("js-lazy-image--handled")||observer.observe(image)}}else loadImagesImmediately(images);function fetchImage(e){return new Promise(function(t,a){var r=new Image;r.src=e,r.onload=t,r.onerror=a})}function preloadImage(e){var t=e.dataset.src;if(t)return fetchImage(t).then(function(){applyImage(e,t)})}function loadImagesImmediately(e){for(var t=0;t<e.length;t++){preloadImage(e[t])}}function disconnect(){observer&&observer.disconnect()}function onIntersection(e){0===imageCount&&observer.disconnect();for(var t=0;t<e.length;t++){var a=e[t];a.intersectionRatio>0&&(imageCount--,observer.unobserve(a.target),preloadImage(a.target))}}function applyImage(e,t){e.classList.add("js-lazy-image--handled"),e.src=t,e.classList.add("fade-in")}function getLazyImageLoaded(){var e=document.querySelectorAll(".lazy-image");if(imageCount=e.length,"IntersectionObserver"in window){observer=new IntersectionObserver(onIntersection,{rootMargin:"50px 0px",threshold:.01});for(var t=0;t<e.length;t++){var a=e[t];a.classList.contains("js-lazy-image--handled")||observer.observe(a)}}else loadImagesImmediately(e)}$("ul.tab-block li").click(function(){var e=$(this).attr("data-tab");$("ul.tab-block li").removeClass("current"),$(".section-lang-block").removeClass("current"),$(this).addClass("current"),$("#"+e).addClass("current")});
