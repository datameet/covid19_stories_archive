window.loadPaginationAds=null;var parScript=document.currentScript;var parScriptSrc=parScript.src;var parVer="";if(parScriptSrc.indexOf("?")>0){parVer=parScriptSrc.split("?");parVer="?"+parVer[1];}
$(document).ready(function(){var winpathAdsense=window.location.pathname;var curDevice="desktop";curDevice=device;var lk_adListPage="ROS";function isDemoPage(myvar){var re=new RegExp("adclient=demo","g");var result=re.test(myvar);if(result){var pgdemo=getDemoPage(myvar);pg=pgdemo.split("=");return{isDemo:true,pageDemo:pg[1]}}
return{isDemo:false,pageDemo:null};}
function getDemoPage(myvar){var re1=/adclient=([^(?:&|\n)]*)/gm
const subst=`$1`;result=myvar.match(re1);return result[0];}
var demoPage=isDemoPage(window.top.location.href);if(curDevice=="desktop"){lk_adListPage="ROS";lk_adListPage=(winpathAdsense.length==1)?"Homepage":lk_adListPage;lk_adListPage=(winpathAdsense=="/latestnews/")?"LatestNews":lk_adListPage;const regexDesktopArticle=/\/(?:(?!(photos|videos))[^\/]*)\/(?:(?!page).*)\//gm;if(winpathAdsense.length==1){lk_adListPage="Homepage";}else if(winpathAdsense=="/latestnews/"){lk_adListPage="LatestNews";}else if(pagevar=="city"){lk_adListPage="City";}else if(regexDesktopArticle.test(winpathAdsense)){const regexPhotoArt=/\/photos\//gm;if(regexPhotoArt.test(winpathAdsense)){lk_adListPage="DesktopPhotoDetail";}}}else{lk_adListPage="ROS-mobile";const regex=/\/(?:(?!(photos|videos))[^\/]*)\/(?:(?!page).*)\//gm;if(winpathAdsense.length==1){lk_adListPage="Homepage-mobile";}else if(regex.test(winpathAdsense)){const photoregMob=/\/photos\//gm
lk_adListPage="MobileArt";if(photoregMob.test(winpathAdsense)){lk_adListPage="MobilePhotoDetail";}}}
if(demoPage.isDemo){lk_adListPage=lk_adListPage+"-"+demoPage.pageDemo;}
console.log("lk_adListPage  for google Ads : "+lk_adListPage);headTag=document.head||document.getElementsByTagName("head")[0];bodyTag=document.body||document.getElementsByTagName("body")[0];var docDomain=document.location.hostname;var adArrayURL="https://s3.ap-south-1.amazonaws.com/lokmat.com/orient/lokmat/google-adArray.json"+parVer;if(docDomain=="erfan.com"){adArrayURL="google-adArray.json"+parVer;}else if(docDomain=="staging.lokmat.com"){adArrayURL="http://staging.lokmat.com/assets/js/google-adArray.json"+parVer;}
console.log("adArrayURL : ",adArrayURL)
window.adArray=null;(function(){mydata=window.navigator.userAgent
$("#details").html(mydata);fetch(adArrayURL).then(response=>response.json()).then(response=>window.adArray=response).then(()=>{createAdTags()}).catch(()=>console.log("error in loading ad array json file"))}());function loadScript(src){return new Promise(function(resolve,reject){let script=document.createElement('script');script.src=src;script.onload=()=>resolve(script);script.onerror=()=>reject(new Error(`Script load error for ${src}`));document.head.append(script);});}
function loadbanner(row){var targetElem=document.body.querySelector(row[3]);scriptdisplay=create_push(row[2]);create_adDiv(row,targetElem);targetElem.appendChild(scriptdisplay);}
function create_push(id){var scriptdisplay="";scriptdisplay=document.createElement("script");scriptdisplay.type="text/javascript";scriptdisplay.text="googletag.cmd.push(function() { googletag.display('"+id+"'); });";return scriptdisplay;}
function create_adDiv(row,targetElem){console.log(row)
adDiv=document.createElement("div");adDiv.id=row[2];var isID=false;var isClass=false;if(row[3].indexOf("#")>-1){isID=true;}else if(row[3].indexOf(".")>-1){isClass=true;}else{if(row[3]!=="body"){return false;}}
var pnode="";if(isID){pnode=document.body.querySelector(row[3]);}else if(isClass){pnode=document.body.querySelector(row[3]);}else{pnode=document.body.querySelector(row[3][0]);}
if(row[4]=="insertBefore"){targetElem.parentNode.insertBefore(adDiv,pnode);}else if(row[4]=="insertAfter"){pnode.insertAdjacentElement("afterend",adDiv);}else if(row[4]=="prepend"){document.body.prepend(adDiv);}else{targetElem.appendChild(adDiv);}}
var offscreen_ads=[];function createAdTags(){screenheight=window.screen.height;let promise=loadScript("https://www.googletagservices.com/tag/js/gpt.js");promise.then(function(){advars=document.createElement("script");advars.type="text/javascript";advars.text="window.googletag = window.googletag || {};";advars.text=advars.text+" googletag.cmd = googletag.cmd || [];";headTag.appendChild(advars);}).then(()=>{googletag.cmd.push(function(){googletag.pubads().enableSingleRequest();googletag.pubads().collapseEmptyDivs();googletag.pubads().setTargeting("category",pagevar);googletag.enableServices();});}).then(function(){if(typeof(window.adArray[lk_adListPage])!=="undefined"){window.adArray[lk_adListPage].forEach(function(val,idx){if($(val[3]).length==0){console.log(">>>   returning false on define slot "+val);}
googletag.cmd.push(function(){googletag.defineSlot(val[0],val[1],val[2]).addService(googletag.pubads());});});}}).then(()=>{if(typeof(window.adArray[lk_adListPage])!=="undefined"){window.adArray[lk_adListPage].forEach(function(val,idx){if(document.body.querySelector(val[3])!=null&&$(val[3]).offset().top<screenheight){loadbanner(val);}else{offscreen_ads.push(val);}});}}).then(()=>{console.log(offscreen_ads);window.addEventListener('scroll',loadAllAds);}).then(()=>{currentPage=null;if(curDevice=="desktop"){currentPage="categoryDesktop";const regexd=/\/(?:(?!(photos|videos))[^\/]*)\/(?:(?!page).*)\//gm;if(winpathAdsense.length==1){currentPage="homeDesktop";}else if(regexd.test(winpathAdsense)){currentPage="articleDesktop";}}else{currentPage="categoryMobile";const regexm=/\/(?:(?!(photos|videos))[^\/]*)\/(?:(?!page).*)\//gm;if(winpathAdsense.length==1){currentPage="homeMobile";}else if(regexm.test(winpathAdsense)){currentPage="articleMobile";}}
insertNative_ads(currentPage);}).then(()=>{}).catch(err=>console.log(err));}
function loadAllAds(){var scrttp=$(window).scrollTop();if(scrttp>100){offscreen_ads.forEach(function(val,idx){if(document.body.querySelector(val[3])!=null){loadbanner(val);}});window.removeEventListener('scroll',loadAllAds);}}
function isValidView(elArr){if(demoPage.isDemo&&typeof(elArr["interstitialMobile"])!="undefined"&&typeof(elArr["interstitialMobile"][0])!="undefined"){return true;}
else if(typeof(elArr["interstitialMobile"])!="undefined"&&typeof(elArr["interstitialMobile"][0])!="undefined"&&elArr["interstitialMobile"][0][0]==1){return true;}
return false;}
function insertNative_ads(currentPage){if(currentPage==null||currentPage=="articleDesktop"){return false;}
var elArr=window.adArray["nativeAdArray"];if(window.innerWidth<=768){showFooterSticky(elArr)}
if(currentPage==="articleMobile"){showIntersetial_onFrequency(elArr)
return false;}
for(i=0;i<elArr[currentPage].length;i++){if(document.body.querySelector(elArr[currentPage][i][0])==null){console.log("%c element not found falling out : "+elArr[currentPage][i][0],"background:#ccc; padding:5px; font-size:12px; color:#222");break;}
if(elArr[currentPage][i][0].trim().length==0||elArr[currentPage][i][1].trim().length==0||elArr[currentPage][i][2].trim().length==0){console.log("%c element object value is blank at : "+elArr[currentPage][i][0],"background:#ccc; padding:5px; font-size:12px; color:#222");continue;}
var targetElem=document.body.querySelector(elArr[currentPage][i][0]);var scriptAd=document.createElement("script");scriptAd.type="text/javascript";scriptAd.text="googletag.cmd.push(function() {googletag.defineSlot('"+elArr[currentPage][i][1]+"', ['fluid'], '"+elArr[currentPage][i][2]+"').addService(googletag.pubads());});";var scriptdisplay=document.createElement("script");scriptdisplay.type="text/javascript";scriptdisplay.text="googletag.cmd.push(function() { googletag.display('"+elArr[currentPage][i][2]+"'); });";var scriptDiv=document.createElement("div");scriptDiv.id=elArr[currentPage][i][2];scriptDiv.style=(currentPage!=="homeDesktop")?"padding:10px 0px;":"padding:0px 0px 0px;";if(currentPage=="homeDesktop"){var pnode=document.body.querySelector(elArr[currentPage][i][0]);pnode.innerHTML="";pnode.appendChild(scriptDiv);pnode.appendChild(scriptAd);pnode.appendChild(scriptdisplay);}
else if(currentPage=="categoryDesktop"){var pnode=document.body.querySelector(elArr[currentPage][i][0]);targetElem.parentNode.insertBefore(scriptDiv,pnode);targetElem.parentNode.insertBefore(scriptAd,pnode);targetElem.parentNode.insertBefore(scriptdisplay,pnode);}
else if(currentPage=="categoryMobile"){var pnode=document.body.querySelector(elArr[currentPage][i][0]);targetElem.parentNode.insertBefore(scriptDiv,pnode);targetElem.parentNode.insertBefore(scriptAd,pnode);targetElem.parentNode.insertBefore(scriptdisplay,pnode);}
else if(currentPage=="homeMobile"){var pnode=document.body.querySelector(elArr[currentPage][i][0]);pnode.insertAdjacentElement('afterend',scriptDiv);pnode.insertAdjacentElement('afterend',scriptAd);pnode.insertAdjacentElement('afterend',scriptdisplay);}}}
function showFooterSticky(elArr){if(window.innerWidth<=768){if((typeof(elArr["stickyMobile"])!="undefined"&&typeof(elArr["stickyMobile"][0])!="undefined"&&elArr["stickyMobile"][0][0]==1)||(demoPage.isDemo&&typeof(elArr["stickyMobile"])!="undefined"&&typeof(elArr["stickyMobile"][0])!="undefined")){var style_footerWrap=document.createElement("style");style_footerWrap.type="text/css";style_footerWrap.innerText="#footerStickyWrapper{position:fixed; background:#fff; width:100%; height:75px; left:0px; bottom:0px;}#footerStickyWrapper:empty{display:none}";document.body.append(style_footerWrap);var scriptDiv_footerWrap=document.createElement("div");scriptDiv_footerWrap.style="position:fixed; background:#fff; width:100%; height:75px; left:0px; bottom:0px;";scriptDiv_footerWrap.id="footerStickyWrapper";document.body.append(scriptDiv_footerWrap);var scriptDiv_footer=document.createElement("div");scriptDiv_footer.id=elArr["stickyMobile"][0][2];scriptDiv_footer.style="margin:0px auto; width:320px;";var scriptAd_footer=document.createElement("script");scriptAd_footer.type="text/javascript";scriptAd_footer.text="googletag.cmd.push(function() {googletag.defineSlot('"+elArr["stickyMobile"][0][1]+"', [320,75], '"+elArr["stickyMobile"][0][2]+"').addService(googletag.pubads());});";var scriptdisplay_footer=document.createElement("script");scriptdisplay_footer.type="text/javascript";scriptdisplay_footer.text="googletag.cmd.push(function() { googletag.display('"+elArr["stickyMobile"][0][2]+"'); });";setTimeout(function(){var pnode_footer=document.body.querySelector("#footerStickyWrapper");pnode_footer.appendChild(scriptDiv_footer);pnode_footer.appendChild(scriptAd_footer);pnode_footer.appendChild(scriptdisplay_footer);document.body.style.marginBottom="50px";},200)}}}
function showIntersetial(elArr){if(window.innerWidth<=768){if(isValidView(elArr)){var style_Intersetial=document.createElement("style");style_Intersetial.type="text/css";style_Intersetial.id="interstyle";style_Intersetial.innerText=''+'.blkintersetial{position:fixed; left:0px; top:0px; height:101%; width:100%; background:rgba(255,255,255,0.85); z-index:999;}'+'.blkintersetial #inter-close{position: absolute; right:5px; top:5px; color:#000; font-family:Arial, Helvetica, sans-serif; font-size:18px; cursor: pointer; width:30px; height:30px; border:2px solid #ffc800; border-radius:15px; background:#e30613; padding:3px 0px 0px 0px; text-align:center; color:#fff;}'+'.blkintersetial .autocloseText{padding:10px 15px; font-size:14px; display:none}'+'.blkintersetial .inter-adblk{width:100%; height:calc(100% - 40px); position:absolute; left:0px; bottom:0px;}';document.body.append(style_Intersetial);var scriptDiv_intersetialWrap=document.createElement("div");scriptDiv_intersetialWrap.id="scriptDiv_intersetialWrap";scriptDiv_intersetialWrap.className="blkintersetial";scriptDiv_intersetialWrap.id="blkintersetial";document.body.append(scriptDiv_intersetialWrap);var scriptDiv_intersetial=document.createElement("div");scriptDiv_intersetial.id="scriptDiv_intersetial";scriptDiv_intersetial.id=elArr["interstitialMobile"][0][2];scriptDiv_intersetial.style="margin:0px auto;width:320px;";var scriptAd_intersetial=document.createElement("script");scriptAd_intersetial.id="scriptAd_intersetial";scriptAd_intersetial.type="text/javascript";scriptAd_intersetial.text="googletag.cmd.push(function() {googletag.defineSlot('"+elArr["interstitialMobile"][0][1]+"', [1,1], '"+elArr["interstitialMobile"][0][2]+"').addService(googletag.pubads());});";var scriptdisplay_intersetial=document.createElement("script");scriptdisplay_intersetial.id="scriptdisplay_intersetial";scriptdisplay_intersetial.type="text/javascript";scriptdisplay_intersetial.text="googletag.cmd.push(function() { googletag.display('"+elArr["interstitialMobile"][0][2]+"'); });";function intersetialCloseEvent(){document.getElementById("interstyle").innerHTML="";document.getElementById("blkintersetial").style.display="none";}
function startTimer(){var elapse=12;document.body.querySelector(".autocloseText").style.display="block";var int_tm=setInterval(()=>{elapse=elapse-1;timebox=document.body.querySelector(".autocloseText span");timebox.innerText="";timebox.innerText=elapse;if(elapse<0){intersetialCloseEvent();clearInterval(int_tm);}},1000);}
setTimeout(function(){document.getElementById("blkintersetial").innerHTML="<div class='inter-timer'><p class='autocloseText'>This ad will auto close after <span>12</span> seconds</p><span id='inter-close'>X</span></div><div class='inter-adblk'></div>";document.getElementById("inter-close").addEventListener("click",intersetialCloseEvent);var pnode_intersetial=document.body.querySelector(".inter-adblk");pnode_intersetial.append(scriptDiv_intersetial);pnode_intersetial.append(scriptAd_intersetial);pnode_intersetial.append(scriptdisplay_intersetial);document.body.style.marginBottom="50px";setTimeout(function(){startTimer();},5000)},200)}}}
function showIntersetial_onFrequency(elArr){if(isValidView(elArr)&&demoPage.isDemo){showIntersetial(elArr);return false;}
if(typeof(Storage)!=="undefined"){if(sessionStorage.getItem('intersetial_session')===null){sessionStorage.setItem('intersetial_session',true)
var local_val=localStorage.getItem("intersetial_count");if(local_val===null){var curTime=new Date().getTime();localStorage.setItem("intersetial_count","[1,"+curTime+"]");showIntersetial(elArr);}
else{local_val=JSON.parse(local_val);intcount=local_val[0];local_Date=new Date(local_val[1]);var curTime=new Date();var isToday=(curTime.toDateString()==local_Date.toDateString());if(isToday){if(intcount<elArr["interstitialMobile"][0][3]){intcount++;localStorage.setItem("intersetial_count","["+intcount+","+curTime.getTime()+"]");showIntersetial(elArr);}}else{var curTime=new Date().getTime();localStorage.setItem("intersetial_count","[1,"+curTime+"]");showIntersetial(elArr);}}}}
else{showIntersetial(elArr);console.log("Sorry, your browser does not support Web Storage...");}}
function insertCustomAd(newID){newID=(newID=="body")?"body":"#"+newID;return new Promise(function(resolve,reject){if(document.querySelector(newID)){resolve()}else{reject()}});}
window.loadPaginationAds=function(newID){var adsnsID="#"+newID;var newIdx=null;insertCustomAd(newID).then(function(e){console.log("pagination infinite article")}).then(function(e){window.adArray[lk_adListPage].forEach(function(val,idx){if(val[3]==adsnsID){newIdx=idx;}});}).then(function(){if(newIdx==null){console.log("ad divID "+adsnsID+" not found on page")
return false;}}).then(function(){var adrow=window.adArray[lk_adListPage][newIdx];loadbanner(adrow);}).catch(function(e){console.log("some error while insert adcode at : "+newID+"\n"+e);});}});
