var requirejs,require,define;(function(M){var J,Q,E,D,N={},O={},x={},A={},F=Object.prototype.hasOwnProperty,I=[].slice,G=/\.js$/;function w(b,a){return F.call(b,a)}function C(g,k){var n,a,c,q,m,d,i,e,o,p,b,f,j=k&&k.split("/"),h=x.map,l=(h&&h["*"])||{};if(g){g=g.split("/");m=g.length-1;if(x.nodeIdCompat&&G.test(g[m])){g[m]=g[m].replace(G,"")}if(g[0].charAt(0)==="."&&j){f=j.slice(0,j.length-1);g=f.concat(g)}for(o=0;o<g.length;o++){b=g[o];if(b==="."){g.splice(o,1);o-=1}else{if(b===".."){if(o===0||(o===1&&g[2]==="..")||g[o-1]===".."){continue
}else{if(o>0){g.splice(o-1,2);o-=2}}}}}g=g.join("/")}if((j||l)&&h){n=g.split("/");for(o=n.length;o>0;o-=1){a=n.slice(0,o).join("/");if(j){for(p=j.length;p>0;p-=1){c=h[j.slice(0,p).join("/")];if(c){c=c[a];if(c){q=c;d=o;break}}}}if(q){break}if(!i&&l&&l[a]){i=l[a];e=o}}if(!q&&i){q=i;d=e}if(q){n.splice(0,d,q);g=n.join("/")}}return g}function y(b,a){return function(){var c=I.call(arguments,0);if(typeof c[0]!=="string"&&c.length===1){c.push(null)}return Q.apply(M,c.concat([b,a]))}}function B(a){return function(b){return C(b,a)
}}function L(a){return function(b){N[a]=b}}function K(a){if(w(O,a)){var b=O[a];delete O[a];A[a]=true;J.apply(M,b)}if(!w(N,a)&&!w(A,a)){throw new Error("No "+a)}return N[a]}function z(a){var c,b=a?a.indexOf("!"):-1;if(b>-1){c=a.substring(0,b);a=a.substring(b+1,a.length)}return[c,a]}function H(a){return a?z(a):[]}E=function(c,d){var b,a=z(c),f=a[0],e=d[1];c=a[1];if(f){f=C(f,e);b=K(f)}if(f){if(b&&b.normalize){c=b.normalize(c,B(e))}else{c=C(c,e)}}else{c=C(c,e);a=z(c);f=a[0];c=a[1];if(f){b=K(f)}}return{f:f?f+"!"+c:c,n:c,pr:f,p:b}
};function P(a){return function(){return(x&&x.config&&x.config[a])||{}}}D={require:function(a){return y(a)},exports:function(b){var a=N[b];if(typeof a!=="undefined"){return a}else{return(N[b]={})}},module:function(a){return{id:a,uri:"",exports:N[a],config:P(a)}}};J=function(g,h,j,k){var c,l,b,i,e,d,a=[],f=typeof j,m;k=k||g;d=H(k);if(f==="undefined"||f==="function"){h=!h.length&&j.length?["require","exports","module"]:h;for(e=0;e<h.length;e+=1){i=E(h[e],d);l=i.f;if(l==="require"){a[e]=D.require(g)
}else{if(l==="exports"){a[e]=D.exports(g);m=true}else{if(l==="module"){c=a[e]=D.module(g)}else{if(w(N,l)||w(O,l)||w(A,l)){a[e]=K(l)}else{if(i.p){i.p.load(i.n,y(k,true),L(l),{});a[e]=N[l]}else{throw new Error(g+" missing "+l)}}}}}}b=j?j.apply(N[g],a):undefined;if(g){if(c&&c.exports!==M&&c.exports!==N[g]){N[g]=c.exports}else{if(b!==M||!m){N[g]=b}}}}else{if(g){N[g]=j}}};requirejs=require=Q=function(d,b,c,a,e){if(typeof d==="string"){if(D[d]){return D[d](b)}return K(E(d,H(b)).f)}else{if(!d.splice){x=d;
if(x.deps){Q(x.deps,x.callback)}if(!b){return}if(b.splice){d=b;b=c;c=null}else{d=M}}}b=b||function(){};if(typeof c==="function"){c=a;a=e}if(a){J(M,d,b,c)}else{setTimeout(function(){J(M,d,b,c)},4)}return Q};Q.config=function(a){return Q(a)};requirejs._defined=N;define=function(b,a,c){if(typeof b!=="string"){throw new Error("See almond README: incorrect module build, no module name")}if(!a.splice){c=a;a=[]}if(!w(N,b)&&!w(O,b)){O[b]=[b,a,c]}};define.amd={jQuery:true}}());(function(){var j={};var k={};
var l=[];var n=".min";var i=[{module:"json",variable:"JSON",js:"//cdnjs.cloudflare.com/ajax/libs/json2/20121008/json2"+n},{module:"jquery",variable:"jQuery",js:["//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery"+n,"//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.2/jquery"+n]}];for(var h=0;h<i.length;h++){var m=i[h];if(!window[m.variable]){k[m.module]=m.js;j[m.module]={exports:m.variable};l.push(m.module)}else{define(m.module,(function(a,b){return function(){return window[a.variable]}}(m,n)))}}require({deps:l,shim:j,paths:k})
}());define("config",[],function(){return{}});require.config({shim:{},paths:{},config:{"tiljs/page":{channel:"AM",siteId:"1c86554c95d4b9ef28a483b8dbeabf5e",domain:"indiatimes.com"},"tiljs/plugin/lazy":{skew:0,error_image:$("[data-default-image-msid]").length?("/photo/"+$("[data-default-image-msid]").attr("data-default-image-msid")+".cms"):"/photo/63186464.cms"},"tiljs/social/facebook":{xfbml:true,parse:false,appid:773871422637679,load_js:false,init:false},"tiljs/social/twitter":{parse:false,load_js:false,init:false},"tiljs/analytics/mytimes":{appKey:"AM"},"tiljs/apps/times/comments":{loadCommentFromMytimes:true,commentType:"comments_agree"},"tiljs/apps/times/api":{post_comment:{url:"/postro2.cms",params:{medium:"WEB"}},comments:{url:"/commentsdata.cms",type:"json",params:{appkey:"AM",pcode:"AM",msid:window.msid,sortcriteria:"CreationDate",order:"asc",size:25,lastdeenid:123,pcode:"AM",after:true,withReward:true}},comments_oldest:{url:"/commentsdata.cms",type:"json",appkey:"AM",pcode:"AM",params:{appkey:"AM",msid:window.msid,sortcriteria:"CreationDate",order:"desc",size:25,lastdeenid:123,after:true,withReward:true}},comments_agree:{url:"/commentsdata.cms",type:"json",appkey:"AM",pcode:"AM",params:{appkey:"AM",msid:window.msid,sortcriteria:"AgreeCount",order:"desc",size:25,lastdeenid:123,after:true,withReward:true,medium:"WEB"}},comments_disagree:{url:"/commentsdata.cms",appkey:"AM",pcode:"AM",type:"json",params:{appkey:"AM",msid:window.msid,sortcriteria:"DisagreeCount",order:"desc",size:25,lastdeenid:123,after:true,withReward:true}},comments_discussed:{url:"/commentsdata.cms",appkey:"AM",pcode:"AM",type:"json",params:{appkey:"AM",msid:window.msid,sortcriteria:"discussed",order:"desc",size:25,lastdeenid:123,after:true,withReward:true}}},"tiljs/apps/times/login":{login_channel:(function(){if(location.href.indexOf("ahmedabadmirror.com")>-1){return"mirror"
}else{return"ahmdmirrorin"}}()),base_url:(function(){if(location.href.indexOf("ahmedabadmirror.com")>-1){return"https://www.ahmedabadmirror.com"}else{return"https://www.ahmedabadmirror.indiatimes.com"}}()),base_sso_url:(function(){if(location.href.indexOf("ahmedabadmirror.com")>-1){return"https://www.ahmedabadmirror.com"}else{return"https://www.ahmedabadmirror.indiatimes.com"}}())}}});define("jquery",[],function(){return jQuery});define("tiljs/compatibility",["jquery"],function(c){var d={};if(!Array.prototype.indexOf){Array.prototype.indexOf=d.Array_indexOf=function(f,b){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined')
}var a=this.length>>>0;b=+b||0;if(Math.abs(b)===Infinity){b=0}if(b<0){b+=a;if(b<0){b=0}}for(;b<a;b++){if(this[b]===f){return b}}return -1}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gm,"")}}if(!String.prototype.splice){String.prototype.splice=function(f,a,b){return(this.slice(0,f)+b+this.slice(f+Math.abs(a)))}}c(function(){c("body").on("focus","[placeholder]",function(){var a=c(this);if(a.val()===a.attr("placeholder")){a.val("");a.removeClass("placeholder")
}});c("body").on("blur","[placeholder]",function(){var a=c(this);if(a.val()===""||a.val()===a.attr("placeholder")){a.addClass("placeholder");a.val(a.attr("placeholder"))}});c("[placeholder]").blur()});return d});define("tiljs/cookie",[],function(){var b={};b.get=function(o){var a=o?undefined:{};var k=document.cookie?document.cookie.split("; "):[];for(var l=0,p=k.length;l<p;l++){var i=k[l].split("=");var m=decodeURIComponent(i.shift());var n=i.join("=");n=b._parseCookieValue(n);if(o&&o===m){a=n;break
}if(!o&&n!==undefined){a[m]=n}}return a};b.getAll=function(){return b.get()};b.remove=function(a,e,f){if(a){f=(f||document.location.host).split(":")[0];e=e||document.location.pathname;b.set(a,null,-1,e,f)}};b.set=function(o,m,j,k,n,l){var a="";j=(j!==undefined)?j:30;var p=new Date();p.setTime(p.getTime()+(j*24*60*60*1000));a="; expires="+p.toGMTString();n=(n||document.location.host).split(":")[0];k=k||document.location.pathname;if(/\/.*\..*/.test(k)){k=k.split("/");k.pop();k=k.join("/")}document.cookie=o+"="+m+a+((k)?";path="+k:"")+((n&&n!="localhost")?";domain="+n:"")+((l)?";secure":"")
};b._parseCookieValue=function(a){if(a.indexOf('"')===0){a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{return decodeURIComponent(a.replace(/\+/g," "))}catch(d){}};return b});define("tiljs/event",[],function(){var f={},e={},g="__on_",h=(function(){var a=0;return function(){return a++}})();f.publish=function(k,b){if(!k){return null}if(e[k]){for(var a in e[k]){if(e[k].hasOwnProperty(a)){var c=e[k][a];try{c(b)}catch(d){f.publish("logger.error",d.stack)}}}}};f.subscribeAll=function(i,a,l){if(i instanceof Array){var c=[];
var b=[];for(var d=0;d<i.length;d++){c.push(f.subscribe(i[d],function(j){b.push(j);if(c.length===b.length){if(a){a(b)}b=[]}},l))}return c}return f.subscribe(i,a,l)};f.subscribe=function(i,a,l){if(i instanceof Array){var c=[];for(var d=0;d<i.length;d++){c.push(f.subscribe(i[d],a,l))}return c}if(!i||!a){return null}if(!e[i]){e[i]={}}var b=i+":"+h();e[i][b]=a;if(l){l.__callback=a}f.publish(g+i,l);return b};f.unsubscribe=function(b){if(!b){return null}var a=b.split(":");if(a.length===2){var c=a[0];if(e[c][b]){delete e[c][b];
return true}}return false};f.getSubscriptions=function(a){if(!a){return e}return e[a]};f.onsubscribe=function(c,a){if(!c||!a){return null}c=g+c;if(!e[c]){e[c]={}}var b=c+":"+h();e[c][b]=a;return b};return f});define("tiljs/logger",["./cookie","module","./event","jquery"],function(v,t,w,n){var p={},u=[];var m=["log","debug","info","warn","error"];var o={cookieName:"d",hashString:"#debugdsfgw456g",prefix:"[times_log] ",time:false,handleWindowError:true,handleJqueryError:true,logModuleLoad:true,log:false};
var q=n.extend({},o,t.config());function r(b){var c=new RegExp("/(.*):([0-9]*):([0-9]*)","g");var a=c.exec(b);a=c.exec(b);a=c.exec(b);if(a){a.shift()}return a?a.join(":").replace(q.hashString,""):null}p={};p.disable=function(){q.log=false;v.remove(q.cookieName,"/");var b,a;for(b in m){if(m.hasOwnProperty(b)){a=m[b];p[a]=(function(c){return function(){u.push.apply(u,arguments)}})(a)}}return"Logging Disabled"};p.enable=function(){q.log=true;v.set(q.cookieName,q.hashString,30,"/");var a,c;for(a in m){if(m.hasOwnProperty(a)){c=m[a];
function b(){console.log.apply(this,arguments)}p[c]=(function(e){var d=function(){};var f;var g=q.prefix;if(console.log.bind==="undefined"){f=Function.prototype.bind.call(console[e],console,g)}else{f=console[e].bind(console,g)}return f})(c);(function(d){w.subscribe("logger."+d,function(e){Function.prototype.apply.call(p[d],console,arguments)})}(c))}}return"Logging Enabled"};p.isEnabled=function(){return q.log||(window.location.hash.length>0&&window.location.hash===(q.hashString))||(v.get(q.cookieName)===q.hashString)
};p.handleWindowError=function(){window.onerror=function(c,d,e,a,b){p.error.apply(this,["Error message: "+c+"\n\tURL: "+d+(e?":"+e+":"+a:"")+"\n\tLine Number: "+e+":"+a+"\n\tError: "+b]);return true}};p.handleJqueryError=function(){n(document).ajaxError(function(d,c,a,b){if(b==="timeout"){p.error.apply(this,[b+": "+a.url])}else{p.error.apply(this,[b])}});n(document).error(function(a){p.error.apply(this,a)})};function l(){q.log=p.isEnabled();if(q.log){p.enable()}else{p.disable()}if(q.handleWindowError===true){p.handleWindowError();
w.subscribe("window.load",function(){p.handleWindowError()})}if(q.handleJqueryError===true){p.handleJqueryError()}}p.getLogs=function(){return u.slice(0)};p.getLogsStr=function(){return p.getLogs().join("\n")};l();return p});define("tiljs/is",[],function(){var b={};b.number=function(a){return typeof a==="number"};b.string=function(a){return typeof a==="string"};b.funct=b.method=function(a){return typeof a==="function"};b.object=function(a){return a!==null&&typeof a==="object"};b.array=Array&&Array.isArray?Array.isArray:function(a){return a instanceof Array
};b.undefined=function(a){return typeof a==="undefined"};b.defined=function(a){return typeof a!=="undefined"};b.exists=function(a){return b.defined(a)||a===""};b.empty=function(f){if(!b.defined(f)){return true}else{if(b.string(f)||b.array(f)){return f.length===0}else{if(b.object(f)){var a=0,e;for(e in f){if(f.hasOwnProperty(e)){a++}}return a===0}else{if(b.number(f)){return false}else{return true}}}}};b.alphaOnly=function(a){return/^[A-z\s]+$/.test(a)};b.numberOnly=function(a){return/^[0-9]+$/.test(a)
};b.mobile=function(){return(function(a){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))
})(navigator.userAgent||navigator.vendor||window.opera)};b.tablet=function(){return(function(a){return/(?:ipad|tab)/i.test(a)})(navigator.userAgent||navigator.vendor||window.opera)};b.desktop=function(){return !b.mobile()&&!b.tablet()};b.touch=function(){return(("ontouchstart" in window)||("DocumentTouch" in window))};b.IE=function(){var d=window.navigator.userAgent;var a=d.indexOf("MSIE ");if(a>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){return true}else{return false}};b.IE11=function(){return(!!navigator.userAgent.match(/Trident\/7\./))
};b.visible=function(a){return a&&a.is(":visible")};b.iframe=function(a){return a.tagName==="IFRAME"};b.dateStr=function(d){try{new Date(d);return true}catch(a){return false}};b.email=function(a){var d=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return d.test(a)};b.url=function(d){var a=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-]*)?\??(?:[\-\+=&;%@\.\w]*)#?(?:[\.\!\/\\\w]*))?)/g;
return a.test(d)};return b});define("tiljs/string",[],function(){var b={};b.camelCase=function(a){return a.replace(/(?:^|\s)\w/g,function(d){return d.toUpperCase()}).replace(/(\s|-|_)/g,"")};b.splice=function(g,a,f,h){return(g.slice(0,a)+h+g.slice(a+Math.abs(f)))};b.startsWith=function(a,d){return a.indexOf(d)===0};return b});define("json",[],function(){return JSON});define("tiljs/util",["./logger","jquery","./is","./string","json"],function(i,l,n,j,p){i.log("util loaded");var k={};k.extend=l.extend;
k.deepextend=function(){return l.extend.apply(this,arguments)};k.xor=function(a,c){var d={},b;for(b in c){if(!a.hasOwnProperty(b)){d[b]=c[b]}}return d};k.convertObj=function(c,a){var b={};util.each(c,function(d,e){b[d]=a(d,e)});return b};k.each=function(c,a){var d,b;if(!a){return null}if(c instanceof Array){for(d=0;d<c.length;d++){if(a(d,c[d])===false){break}}}else{if(c instanceof Object){for(b in c){if(c.hasOwnProperty(b)){if(a(b,c[b])===false){break}}}}else{}}};k.wrapCallback=function(a,b){try{if(a){a.apply(this,args)
}}catch(c){i.error(c)}};k.formatNumber=function(a){if(a>=1000000000){return(a/1000000000).toFixed(1)+"G"}if(a>=1000000){return(a/1000000).toFixed(1)+"M"}if(a>=1000){return(a/1000).toFixed(1)+"K"}return a};k.getJsonFromString=function(a,d,c){d=d||"&";c=c||"=";var e={};var b=a.split(d);k.each(b,function(g,h){var f=h.split(c);e[f[0]]=f[1]});return e};k.val=function(a,b){if(n.funct(a)){return a(b)}return a};k.throttle=function(d,a){var c;var b=0;return function e(){var r=+new Date()-b;var g=this;var h=arguments;
function f(){b=+new Date();a.apply(g,h)}c&&clearTimeout(c);if(r>d){f()}else{c=setTimeout(f,d-r)}}};k.getDate=function(a){try{if(n.number(a)){return new Date(a)}else{a=a.replace(/(\d)(A|P)M/,"$1 $2M")}return new Date(a)}catch(b){i.error(b);return null}};var o=0;k.uuid=function(){var a=new Date().getTime();var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var d=(a+Math.random()*16)%16|0;a=Math.floor(a/16);return(c=="x"?d:(d&7|8)).toString(16)});return b};k.mapObj=function(b,a){if(!n.object(b)&&!n.object(a)){throw new Error("Invalid Parameters")
}var c={};k.each(b,function(d,e){if(n.funct(e)){c[d]=e(a)}else{c[d]=a[e]}});return c};k.getDomainOnly=function(a){return"."+(a||document.location.host).split(":")[0].split(".").reverse().slice(0,2).reverse().join(".")};k.format=function(a,b){var c=a;k.each(b,function(d,e){c=c.replace("{{:"+d+"}}",b[d])});c=c.replace(/{{:[a-zA_Z0-9]+}}/,"");return c};k.stringify=JSON?JSON.stringify:null;k.checkNoScript=function(a){};k.getClick=function(){return n.touch()?"touchstart":"click"};k.getParam=function(a){var b=window.location.search.replace("?","");
if(n.defined(a)){return k.deparam(b)[a]}else{return k.deparam(b)}};k.deparam=function(a){var b={};k.each(a.replace(/\+/g," ").split("&"),function(e,c){var d=c.split("=");b[decodeURIComponent(d[0])]=decodeURIComponent(d[1]||"")});return b};k.data=function(b){var a={};var c=l(b)[0].attributes;l.each(c,function(e,f){var d=f.nodeName.substr(0,5);if(d==="data-"){a[f.nodeName.replace(d,"")]=f.nodeValue}});return a};var m=function(a){Error.prototype.constructor.apply(this,arguments);this.message=a};m.prototype=new Error();
k.wrapCallback=function(a){return function(){try{return a.apply(this,arguments)}catch(b){if(b instanceof m){throw b}i.error(b);throw b}}};k.md5=function(f){function K(F,x){return(F<<x)|(F>>>(32-x))}function E(ae,G){var F,I,Z,x,H;Z=(ae&2147483648);x=(G&2147483648);F=(ae&1073741824);I=(G&1073741824);H=(ae&1073741823)+(G&1073741823);if(F&I){return(H^2147483648^Z^x)}if(F|I){if(H&1073741824){return(H^3221225472^Z^x)}else{return(H^1073741824^Z^x)}}else{return(H^Z^x)}}function e(x,F,G){return(x&F)|((~x)&G)
}function d(x,F,G){return(x&G)|(F&(~G))}function c(x,F,G){return(x^F^G)}function ab(x,F,G){return(F^(x|(~G)))}function h(x,ae,I,Z,H,F,G){x=E(x,E(E(e(ae,I,Z),H),G));return E(K(x,F),ae)}function T(x,ae,I,Z,H,F,G){x=E(x,E(E(d(ae,I,Z),H),G));return E(K(x,F),ae)}function z(x,ae,I,Z,H,F,G){x=E(x,E(E(c(ae,I,Z),H),G));return E(K(x,F),ae)}function g(x,ae,I,Z,H,F,G){x=E(x,E(E(ab(ae,I,Z),H),G));return E(K(x,F),ae)}function S(F){var af;var x=F.length;var I=x+8;var ae=(I-(I%64))/64;var H=(ae+1)*16;var ag=Array(H-1);
var Z=0;var G=0;while(G<x){af=(G-(G%4))/4;Z=(G%4)*8;ag[af]=(ag[af]|(F.charCodeAt(G)<<Z));G++}af=(G-(G%4))/4;Z=(G%4)*8;ag[af]=ag[af]|(128<<Z);ag[H-2]=x<<3;ag[H-1]=x>>>29;return ag}function w(H){var G="",x="",F,I;for(I=0;I<=3;I++){F=(H>>>(I*8))&255;x="0"+F.toString(16);G=G+x.substr(x.length-2,2)}return G}function D(G){G=G.replace(/rn/g,"n");var x="";for(var F=0;F<G.length;F++){var H=G.charCodeAt(F);if(H<128){x+=String.fromCharCode(H)}else{if((H>127)&&(H<2048)){x+=String.fromCharCode((H>>6)|192);x+=String.fromCharCode((H&63)|128)
}else{x+=String.fromCharCode((H>>12)|224);x+=String.fromCharCode(((H>>6)&63)|128);x+=String.fromCharCode((H&63)|128)}}}return x}var y=Array();var P,V,B,q,U,ad,ac,L,J;var a=7,Q=12,N=17,M=22;var v=5,u=9,t=14,r=20;var b=4,aa=11,Y=16,X=23;var C=6,A=10,R=15,O=21;f=D(f);y=S(f);ad=1732584193;ac=4023233417;L=2562383102;J=271733878;for(P=0;P<y.length;P+=16){V=ad;B=ac;q=L;U=J;ad=h(ad,ac,L,J,y[P+0],a,3614090360);J=h(J,ad,ac,L,y[P+1],Q,3905402710);L=h(L,J,ad,ac,y[P+2],N,606105819);ac=h(ac,L,J,ad,y[P+3],M,3250441966);
ad=h(ad,ac,L,J,y[P+4],a,4118548399);J=h(J,ad,ac,L,y[P+5],Q,1200080426);L=h(L,J,ad,ac,y[P+6],N,2821735955);ac=h(ac,L,J,ad,y[P+7],M,4249261313);ad=h(ad,ac,L,J,y[P+8],a,1770035416);J=h(J,ad,ac,L,y[P+9],Q,2336552879);L=h(L,J,ad,ac,y[P+10],N,4294925233);ac=h(ac,L,J,ad,y[P+11],M,2304563134);ad=h(ad,ac,L,J,y[P+12],a,1804603682);J=h(J,ad,ac,L,y[P+13],Q,4254626195);L=h(L,J,ad,ac,y[P+14],N,2792965006);ac=h(ac,L,J,ad,y[P+15],M,1236535329);ad=T(ad,ac,L,J,y[P+1],v,4129170786);J=T(J,ad,ac,L,y[P+6],u,3225465664);
L=T(L,J,ad,ac,y[P+11],t,643717713);ac=T(ac,L,J,ad,y[P+0],r,3921069994);ad=T(ad,ac,L,J,y[P+5],v,3593408605);J=T(J,ad,ac,L,y[P+10],u,38016083);L=T(L,J,ad,ac,y[P+15],t,3634488961);ac=T(ac,L,J,ad,y[P+4],r,3889429448);ad=T(ad,ac,L,J,y[P+9],v,568446438);J=T(J,ad,ac,L,y[P+14],u,3275163606);L=T(L,J,ad,ac,y[P+3],t,4107603335);ac=T(ac,L,J,ad,y[P+8],r,1163531501);ad=T(ad,ac,L,J,y[P+13],v,2850285829);J=T(J,ad,ac,L,y[P+2],u,4243563512);L=T(L,J,ad,ac,y[P+7],t,1735328473);ac=T(ac,L,J,ad,y[P+12],r,2368359562);ad=z(ad,ac,L,J,y[P+5],b,4294588738);
J=z(J,ad,ac,L,y[P+8],aa,2272392833);L=z(L,J,ad,ac,y[P+11],Y,1839030562);ac=z(ac,L,J,ad,y[P+14],X,4259657740);ad=z(ad,ac,L,J,y[P+1],b,2763975236);J=z(J,ad,ac,L,y[P+4],aa,1272893353);L=z(L,J,ad,ac,y[P+7],Y,4139469664);ac=z(ac,L,J,ad,y[P+10],X,3200236656);ad=z(ad,ac,L,J,y[P+13],b,681279174);J=z(J,ad,ac,L,y[P+0],aa,3936430074);L=z(L,J,ad,ac,y[P+3],Y,3572445317);ac=z(ac,L,J,ad,y[P+6],X,76029189);ad=z(ad,ac,L,J,y[P+9],b,3654602809);J=z(J,ad,ac,L,y[P+12],aa,3873151461);L=z(L,J,ad,ac,y[P+15],Y,530742520);
ac=z(ac,L,J,ad,y[P+2],X,3299628645);ad=g(ad,ac,L,J,y[P+0],C,4096336452);J=g(J,ad,ac,L,y[P+7],A,1126891415);L=g(L,J,ad,ac,y[P+14],R,2878612391);ac=g(ac,L,J,ad,y[P+5],O,4237533241);ad=g(ad,ac,L,J,y[P+12],C,1700485571);J=g(J,ad,ac,L,y[P+3],A,2399980690);L=g(L,J,ad,ac,y[P+10],R,4293915773);ac=g(ac,L,J,ad,y[P+1],O,2240044497);ad=g(ad,ac,L,J,y[P+8],C,1873313359);J=g(J,ad,ac,L,y[P+15],A,4264355552);L=g(L,J,ad,ac,y[P+6],R,2734768916);ac=g(ac,L,J,ad,y[P+13],O,1309151649);ad=g(ad,ac,L,J,y[P+4],C,4149444226);
J=g(J,ad,ac,L,y[P+11],A,3174756917);L=g(L,J,ad,ac,y[P+2],R,718787259);ac=g(ac,L,J,ad,y[P+9],O,3951481745);ad=E(ad,V);ac=E(ac,B);L=E(L,q);J=E(J,U)}var W=w(ad)+w(ac)+w(L)+w(J);return W.toLowerCase()};k.encodeHTML=function(a){return l("<div/>").text(a).html()};k.decodeHTML=function(a){return l("<div/>").html(a).text()};k.reloadIframe=function(a){if(l(a).length>0){l(a).attr("src",l(a).attr("src"));return true}return false};k.trimText=function(a,b){var c=a.substr(0,b);if(a.length>b){c=a.replace(new RegExp("^(.{"+b+"}[^\\s]*).*"),"$1")
}return c};return k});define("tiljs/timer",["./util","./is"],function(e,f){var d={};d.every=function(b,a){return setInterval(a,b)};d.after=d.delay=function(b,a){return setTimeout(a,b)};d.available=function(h,a,b,c){if(c==0){a(null)}if(window[h]){if(a){a(window[h])}}else{b=b||2000;setTimeout(function(){d.available(h,a,b,--c)},b)}};d.cancel=function(a){try{clearTimeout(a)}catch(b){}try{clearInterval(a)}catch(b){}};d.elapsedTime=function(i,x,z){if(!f.number(i)){try{i=parseInt(i,10);return d.elapsedTime(i,x,z)
}catch(l){return""}}var a={year:"year",day:"day",hour:"hour",minute:"minute",second:"second",ago:"ago"};var t=e.extend(true,{},a,x);var b=[{name:t.year,div:31536000000,mod:10000},{name:t.day,div:86400000,mod:365},{name:t.hour,div:3600000,mod:24},{name:t.minute,div:60000,mod:60},{name:t.second,div:1000,mod:60}];var u=0,w=b.length,v,c=[],y=new Date().getTime()-i;while(u<w){v=Math.floor(y/b[u].div)%b[u].mod;if(v&&v>=0){c.push(v+" "+b[u].name+(v>1?"s":""))}u+=1}if(c.length===0){c.push("1 "+t.second)}if(z===true){return c[0]+" "+t.ago
}else{return c.join(", ")+" "+t.ago}};return d});define("tiljs/ajax",["./timer","./util","jquery","./is","module"],function(k,j,l,n,o){var m={timeout:60000},p=j.extend(true,{},m,o.config()),i={};l.ajaxSetup({timeout:p.timeout});i.getAll=function(g,u,a,d){var c=this,v=[],f=[],e,b;function h(q){f.push(q);if(f.length===g.length){a.apply(c,f)}}for(e=0;e<g.length;e++){b=u&&u.length>e?u[e]:{};v.push(l.get(g[e],b,h,d))}return v};i.param=l.param;i.ajax=l.ajax;i.get=function(d,b,a,c){if(n.funct(d)){return d(b,a)
}else{return l.get(d,b,a,c)}};i.post=function(d,b,a,c){return l.post(d,b,a,c)};i.postCrossDomain=function(d,a){var e="postFrame"+new Date().getTime()+Math.floor((Math.random()*1000)),c=l("<iframe></iframe>").attr("name",e),b=l("<form action='"+d+"' method='post' target='"+e+"'></form>");j.each(a,function(f,g){b.append(l("<input type='hidden' name='"+f+"' />").attr("value",g))});c.appendTo("body");b.appendTo("body").submit().remove();k.after(10000,function(){c.remove()})};i.getJSONP=function(c,b,a){return i.get(c,b,a,"jsonp")
};i.getJSON=function(c,b,a){return i.get(c,b,a,"json")};return i});define("tiljs/user",["./util","./ajax","./cookie","./event","jquery","./is","./logger","./string"],function(o,l,t,u,q,p,k,n){var r={},m=function(c,b){var d={},a=this;if(b&&p.object(b)){c=o.mapObj(b,c)}o.each(c,function(f,g){d[f]=g;var e=n.camelCase(f);a["get"+e]=function(){return d[f]}});this.getMappedUser=function(){return d};this.getOriginalUser=function(){return c};this.toString=this.toJson=function(){return o.stringify(d,true,"\t")
}};r.getNewUser=function(a,b){if(a instanceof m){return a}else{if(p.object(a)){return new m(a,b)}else{return null}}};r.isUser=function(a){return a instanceof m};return r});define("tiljs/login",["./util","./ajax","./cookie","./event","jquery","module","./user","./string","./logger"],function(t,q,B,C,u,A,v,r,p){var w,y,z,x,o;w={autoinit:false,multiuser:false,login:"",logout:"",check_user_status:"",login_channel:(function(){if(location.href.indexOf("ahmedabadmirror.com")>-1){return"mirror"}else{return"ahmdmirrorin"
}}()),mapping:null,isEUuser:false,renderer:true};y=t.extend(true,{},w,A.config());z={};x={};o="SINGLE_USER";if(window.TimesGDPR&&TimesGDPR.common.consentModule.gdprCallback){TimesGDPR.common.consentModule.gdprCallback(function(a){if(!a.isEUuser){w.isEUuser=false}else{w.isEUuser=true}})}z.login=function(a,c,b){if(!a){b(null,"Username is required for login.")}if(!c){b(null,"Password is required for login.")}q.get(y.login,{username:a,password:c},function(e,d){var f=v.getNewUser(e,y.mapping);if(f){z.setUser(f)
}else{z.removeUser()}if(d){C.publish("login.error",d)}if(b){b(f,d)}})};z.logout=function(a){q.get(y.logout,{},function(b){z.removeUser();if(a){a(b)}})};z.register=function(){p.info("Register event called.")};z.isLoggedIn=function(a){q.get(y.check_user_status,{},function(b){var c=v.getNewUser(b,y.mapping);if(c){c.loginType=B.get("LoginType");c.facebook={name:B.get("fbookname"),location:B.get("fbooklocation"),image:B.get("Fbimage"),email:B.get("FaceBookEmail"),oauth:B.get("Fboauthid")};c.twitter={name:B.get("TwitterUserName"),image:B.get("Twimage"),oauth:B.get("Twoauthid")};
z.setUser(c);if(w.isEUuser){z.checkAndUpdateGDPRConsent(b)}}else{z.removeUser()}if(a){a(c)}})};z.removeUser=function(a){if(y.multiuser){if(a){delete x[a]}else{throw new Error("'userId' is required to remove a user.")}}else{delete x[o]}z.statusChange(null)};z.setUser=z.addUser=function(a){if(typeof a!=="undefined"&&!v.isUser(a)){throw new Error("Object is not an instance of User, use 'user.getNewUser()' to get a User object.")}if(y.multiuser){x[a.id](a)}else{x[o]=a}z.statusChange(a)};z.getUser=function(a){if(y.multiuser){return t.extend(true,{},x[a])
}else{return x[o]}};z.checkAndUpdateGDPRConsent=function(e){var b=e.uid;var a,h;if(e.AM_S_P){a=1}if(!e.AM_P_C){h="1"}else{h="0"}var f=B.get("ckns_policyV2");var d=B.get("optoutV2");if(typeof a!=="undefined"){TimesGDPR.common.consentModule.setConsentToCookies(a,h)}else{if(typeof f!=="undefined"&&typeof d!=="undefined"&&typeof a=="undefined"){var c=!!(d);var g=!(parseInt(d,10));var i={AM_S_P:c,AM_P_C:g};z.updateGDPRConsent(b,i,function(j){console.log("Consent updated for EU: "+j)})}}};z.updateGDPRConsent=function(c,a,b){if(typeof c!=="undefined"&&typeof a!=="undefined"){if(Object.keys(a).length>0){var d="https://myt.indiatimes.com/mytimes/profile/update";
u.getJSON(d,{propertyKeyValuePairs:JSON.stringify(a),uuId:c},function(e){b(e)})}}};z.statusChange=function(a){p.info("User Status:"+(a?a.toString():null));C.publish("user.status",a);z.refreshIframes()};z.refreshIframes=function(){u(window.parent.document).find("iframe[data-refreshstate]").each(function(b,a){u(a).attr("src",u(a).attr("src"))})};z.onStatusChange=function(a){C.subscribe("user.status",a)};z.updateConfig=function(a){if(a){y=t.extend(true,{},y,a)}};z.init=function(b){var a=function(){z.updateConfig(b);
if(y.renderer===true){z.onStatusChange(function(c){z.renderPlugins(c)})}z.isLoggedIn(function(c){});z.initActions()};a()};z.initActions=function(){var a=function(){u("[data-plugin='user-isloggedin']").on("click","[data-plugin='user-logout']",function(){z.logout()});u("[data-plugin='user-notloggedin']").on("click","[data-plugin='user-login']",function(){z.login(function(){if(window.ga){ga("send","event","Login","Mast Head Success",document.location.href,{nonInteraction:1})}})}).on("click","[data-plugin='user-register']",function(){z.register()
}).on("click","[data-plugin='user-login-facebook']",function(){z.loginWithFacebook()}).on("click","[data-plugin='user-login-twitter']",function(){z.loginWithTwitter()}).on("click","[data-plugin='user-login-google']",function(){z.loginWithGoogle()})};a()};z.renderPlugins=function(c){var a=u("[data-plugin='user-isloggedin']"),b=u("[data-plugin='user-notloggedin']");if(b.length===0){p.warn("Cannot render plugins. data-plugin='user-isloggedin' not found")}if(c){a.show();b.hide();u("[data-plugin='user-info']").each(function(){var f=u(this),e=f.attr("data-info");
try{f.text(c["get"+r.camelCase(e)]());p.info("user-info="+e+":"+c["get"+r.camelCase(e)]())}catch(d){p.error("user-info="+e+":"+d.message)}})}else{a.hide();b.show()}};if(y.autoinit===true){z.init()}return z});define("tiljs/page",["module","./util","jquery"],function(k,h,i){var j={msid:window.msid,channel:"",siteId:"",domain:""};var l=h.extend(true,{},j,k.config());var g={};g.getMsid=function(b){try{if(!b||b.length===0||b==="#"){b=location.href;return/(\d*)\.cms/.exec(b)[1]}else{return l.msid}}catch(a){return l.msid
}};g.getSiteId=function(){return l.siteId};g.getDomain=function(){return l.domain};g.getChannel=function(){return l.channel};g.getMeta=function(b){if(b){return i("meta[property='"+b+"']").attr("content")}else{var a={};i("meta[property]").each(function(c,d){var e=i(d);a[e.attr("property")]=e.attr("content")});return a}};return g});define("tiljs/analytics/mytimes",["module","../ajax","../util"],function(l,j,h){var i={};var k={url:"https://myt.indiatimes.com/mytimes/",appKey:"AM"};var g=h.extend(true,{},k,l.config());
i.log=function(c,a){var b=new Image();b.src=c+"?"+j.param(a)};i.logActivity=function(c){var b=g.url+"addActivity";var a=h.extend(true,{},c);i.log(b,a)};i.logCommentActivity=function(b){var a=h.extend(true,{appKey:g.appKey,parentCommentId:0,activityType:"",baseEntityType:"ARTICLE",objectType:"A",url:document.location.href},b);i.logActivity(a)};i.agreeComment=function(b){var a={parentCommentId:b,activityType:"Agreed"};i.logCommentActivity(a)};i.disagreeComment=function(b){var a={parentCommentId:b,activityType:"Disagreed"};
i.logCommentActivity(a)};i.recommendComment=function(b){var a={parentCommentId:b,activityType:"Reccomended"};i.logCommentActivity(a)};i.logShareCount=function(b,c){var d=g.url+"entityCount";var a={appKey:g.appKey,via:c,entityId:b};i.log(d,a)};i.getShareCount=function(c,a){var d=g.url+"sharedEntity";var b={appKey:g.appKey,msids:c};j.ajax({type:"GET",url:d,jsonpCallback:"getShareCount"+Math.random()*1000000000000000000,dataType:"jsonp",data:b,success:function(e){var f=e&&e.length>0?e[0]:null;if(f&&a){if(a){a(f)
}else{a(null)}}},error:a})};i.getNotifications=function(a){var c=g.url+"notification";var b={appKey:g.appKey,openNetworkId:"sso",size:100,lastSeenId:0,after:true};j.ajax({type:"GET",url:c,jsonpCallback:"getNotifications"+Math.random()*1000000000000000000,dataType:"jsonp",data:b,success:a,error:a})};i.followUser=function(b,a){j.getJSONP(g.url+"followuser",{userId:b,fromMyTimes:true},a)};i.unfollowUser=function(b,a){j.getJSONP(g.url+"unfollowuser",{userId:b,fromMyTimes:true},a)};i.getFollowers=function(a){j.getJSONP(g.url+"activity/myfriends",{openNetworkId:"sso",size:-1,lastSeenId:0,after:true,type:"follower"},a)
};i.getFollowee=function(a){j.getJSONP(g.url+"activity/myfriends",{openNetworkId:"sso",size:-1,lastSeenId:0,after:true,type:"followee"},a)};i.followUser=function(b,a){j.getJSONP(g.url+"followuser",{userId:b,fromMyTimes:true,medium:"WEB"},a)};i.updateUserCity=function(b,a){j.getJSONP(g.url+"/profile/update?city="+b,{openNetworkId:"sso",size:-1,lastSeenId:0,after:true},a)};return i});define("tiljs/apps/times/api",["module","../../util","../../ajax","../../cookie","../../event","../../string","../../page","../../analytics/mytimes"],function(u,o,l,v,w,n,m,q){var r={};
var p={ticket:{url:"https://jsso.indiatimes.com/sso/crossdomain/getTicket"},usersInfo:{url:"https://myt.indiatimes.com/mytimes/profile/info/v1/",params:{ssoid:""}},badges:{url:"https://rewards.indiatimes.com/bp/api/urs/mubhtry",params:{format:"json",pcode:m.getChannel(),uid:""}},rewards:{url:"https://rewards.indiatimes.com/bp/api/urs/ups",params:{format:"json",pcode:m.getChannel(),uid:""}},comments:{url:document.location.host=="test.indiatimes.com"||document.location.host=="test.happytrips.com"?"lib/getComments.php":"/json/new_cmtofart2_nit_v1.cms",type:"json",params:{msid:"",curpg:1,pcode:m.getChannel()}}};
p.comments_newest=p.comments;p.comments_oldest={url:p.comments.url,type:p.comments.type,params:{msid:"",curpg:1,ordertype:"asc",pcode:m.getChannel()}};p.comments_recommended={url:p.comments.url,type:p.comments.type,params:{msid:"",curpg:1,commenttype:"mostrecommended",pcode:m.getChannel()}};p.comments_discussed={url:p.comments.url,type:p.comments.type,params:{msid:"",curpg:1,commenttype:"mostdiscussed",pcode:m.getChannel()}};p.comments_agree={url:p.comments.url,type:p.comments.type,params:{msid:"",curpg:1,commenttype:"agree",pcode:m.getChannel()}};
p.comments_disagree={url:p.comments.url,type:p.comments.type,params:{msid:"",curpg:1,commenttype:"disagree",pcode:m.getChannel()}};p.validate_comment={url:"/validatecomment.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};p.post_comment={url:"/postro.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};
p.post_comment_withoutverification={url:"/postro_nover.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};p.post_comment_withverification={url:"/postroemailverification.cms",type:"html",params:{fromname:null,fromaddress:null,userid:null,location:null,imageurl:null,loggedstatus:null,message:null,roaltdetails:null,ArticleID:null,msid:null,parentid:null,rootid:null}};
p.rate={url:"/rate_techreview.cms",type:"html",params:{msid:null,getuserrating:null,vote:null,criticrating:null}};p.rate_comment={url:"/ratecomment_new.cms",type:"html",params:{opinionid:null,typeid:null,rateid:null}};p.rate_comment_offensive={url:"/offensive/mark",type:"html",params:{ofusername:null,ofreason:"NONE",ofcommenteroid:null,ofcommenthostid:83,ofcommentchannelid:-2128958273,ofcommentid:null,ofuserisloggedin:null,ofuserssoid:null,ofuseremail:null}};var t=o.extend(true,{},p,u.config());r.updateConfig=function(a){t=o.extend(true,t,a)
};r.getConfig=function(a){return t};r.getTicket=function(b,a){return r.api("ticket",b,a)};r.getUsersInfo=function(b,a){return r.api("usersInfo",{ssoid:b.ssoids},a)};r.getBadges=function(b,a){return r.api("badges",b,a)};r.getRewards=function(b,a){return r.api("rewards",b,a)};r.getComments=r.getComments_newest=function(b,a){return r.api("comments",b,a)};r.getComments_oldest=function(b,a){return r.api("comments_oldest",b,a)};r.getComments_recommended=function(b,a){return r.api("comments_recommended",b,a)
};r.getComments_discussed=function(b,a){return r.api("comments_discussed",b,a)};r.getComments_agree=function(b,a){return r.api("comments_agree",b,a)};r.getComments_disagree=function(b,a){return r.api("comments_disagree",b,a)};r.validateComment=function(b,a){return r.post("validate_comment",b,a)};r.postComment=function(b,a){return r.post("post_comment",b,a)};r.postCommentWithoutVerification=function(b,a){return r.post("post_comment_withoutverification",b,a)};r.postCommentWithVerification=function(b,a){return r.post("post_comment_withverification",b,a)
};r.rate=function(d,c,a){var b={msid:d.msid,getuserrating:d.user_rating,vote:d.rating,criticrating:d.critic_rating};return r.api("rate",b,c)};r.rateComment=function(a,c,b){if(b){switch(a.typeid){case 100:q.agreeComment(a.opinionid);break;case 101:q.disagreeComment(a.opinionid);break;case 102:q.recommendComment(a.opinionid);break;case 103:r.rateCommentOffensive(a,b);break}}return r.api("rate_comment",a,c)};r.rateCommentOffensive=function(a,b,c){if(b){var d={};d.ofcommenteroid=a.opinionid;d.ofcommentid=window.msid;
d.ofuserisloggedin=1;d.ofuserssoid=d.ofuseremail=b.getEmail();d.ofusername=b.getFullName();return r.api("rate_comment_offensive",d,c)}else{w.publish("logger.error","Cannot rate comment offensive, user not available.")}};r.api=function(a,b,c){var d=t[a];return l.get(o.val(d.url,d.params),o.extend(true,{},d.params,b),function(f){if(c){try{c(f)}catch(e){w.publish("logger.error",e.stack)}}},d.type||"jsonp").error(function(){if(c){try{c()}catch(e){w.publish("logger.error",e.stack)}}})};r.post=function(a,b,c){var d=t[a];
return l.post(o.val(d.url,d.params),o.extend(true,{},d.params,b),function(f){if(c){try{c(f)}catch(e){w.publish("logger.error",e.stack)}}}).error(function(g,e,f){g.publish("comment.post.error",f)})};r.get=function(a,c){if(c){var d=t[a];var b=o.extend(true,{},d.params,c);return{url:o.val(d.url,b),params:b}}else{return t[a]}};r.init=function(){o.each(t,function(b,a){var c=n.camelCase("get "+b);r[c]=function(e,d){l.getJSONP(o.val(a.url,a.params),o.extend(true,{},a.params,e),function(f){if(d){d(f)}})}
})};return r});define("tiljs/ui",["./util","./logger","./event","jquery","./is","./timer"],function(m,l,t,o,n,r){l.log("ui loaded");var u={},q={},k,p;u.window=function(h,i){l.log("ui.window called");var d,f,a,b,e,g;d={width:300,height:300,name:"Window",mask:true,resizable:false,disableScroll:false,closeCallback:function(){l.log("Empty ui.window callback function.")}};f=m.extend(true,{},d,i);a=window.screen.width/2-f.width/2;b=window.screen.height/2-f.height/2;e=["width="+f.width,"height="+f.height,"left="+(n.defined(f.left)?f.left:a),"top="+(n.defined(f.top)?f.top:(b-20)),"scrollbars="+(n.defined(f.scrollbars)&&(f.scrollbars==1)?f.scrollbars:0),"resizable="+f.resizable];
if(f.mask===true&&n.desktop()){u.mask(null,{},false)}if(f.disableScroll===true){u.disableScroll()}g=window.open(h,f.name,e.join(","));if(g){g.focus();l.log("Popup opened: "+h);l.log(g)}try{g.reposition=function(){var w=window.screen.width/2-f.width/2,j=(window.screen.height/2-f.height/2);g.moveTo(w,j)}}catch(c){l.warn("Handled Exception in IE10.");l.error(c)}if(!g){alert("Popups are blocked. Please enable them.");l.error("Popups are blocked. Please enable them.");u.unmask();return g}(function(A,y,j){var z=window.setInterval(function(){try{l.log("Checking if popup is closed:"+y+":"+A.closed);
if(A===null||A.closed!==false){u.window.close(j.name)}}catch(v){l.warn("Handled exception while closing popup.");l.error(v.stack);window.clearInterval(z);z=null}},500);q[j.name]={opt:j,popup:A,interval:z,url:y}}(g,h,f));return g};u.window.close=function(b,a){if(!b){l.error("Window name is required to close it.");return}var c=q[b];if(a===true){m.each(q,function(d){u.window.close(d)})}else{if(c){l.log("Closing popup is closed:"+c.opt.name+":"+c.url);if(c.opt.mask===true){u.unmask()}if(c.opt.disableScroll===true){u.enableScroll()
}window.clearInterval(c.interval);c.interval=null;c.popup.close();q[c.opt.name]=null;c.opt.closeCallback(c.popup)}else{l.warn("Popup '"+b+"' not found.")}}};if(window.closeWindow){l.warn("window.closeWindow is already defined, open windows may not close properly.")}else{window.closeWindow=u.window.close}u.iframe=function(a,b){var d={width:300,height:300,name:"Window",disablePopup:true,closeCallback:function(){l.log("Empty ui.iframe callback function.")}},g=m.extend(true,{},d,b),f=o("<iframe class='loginsignupframe'></iframe>"),e,c;
f.attr("src",a);f.css({width:"100%",height:"100%",border:"4px solid #cccccc",backgroundColor:"#FFF"});e=f[0];c=u.popup(f,g);e.close=function(){f.remove();c.remove();u.unmask()};e.resizeTo=function(h,i){if(h&&i){c.width(h);c.height(i)}};e.reposition=c.reposition;return e};u.closeButton=function(a){var b=o("<span></span>");b.on("click",a);return b};u.popup=function(e,g){var d,a,b,f,c;d={width:300,height:300,name:"Window",closeCallback:function(){l.log("Empty ui.popup callback function.")},disableScroll:false};
f=m.extend(true,{},d,g);c=o("<div></div>");c.width(f.width);c.height(f.height);c.css({position:"absolute",zIndex:p.zIndex+1});c.append(e);if(f.disableScroll===true){u.disableScroll()}if(f.closeCallback){if(window.closePopup){l.warn("'window.closePopup' is already defined.")}if(window.disablePopup){l.warn("'window.disablePopup' is already defined.")}window.closePopup=window.disablePopup=function(){c.remove();u.unmask();if(f.disableScroll===true){u.enableScroll()}if(f.closeCallback){f.closeCallback()
}window.closePopup=null;window.disablePopup=null};a=u.closeButton(window.closePopup);a.addClass("popup_close_button");a.css({position:"absolute",top:"5px",right:"5px",cursor:"pointer",background:"url('/photo/25494620.cms') no-repeat scroll -160px -20px rgba(0, 0, 0, 0)",width:"18px",height:"18px"});c.append(a)}o("body").append(c);b=u.mask(c,{},false);c.reposition=function(){var j=o(window),y=j.width(),h=j.height(),x=((y/2)-(c.width()/2)),i=((h/2)-(c.height()/2));if(x<0){x=0}if(i<0){i=0}c.css({left:x,top:i+o(window).scrollTop()})
};c.reposition();c.close=function(){c.remove();u.unmask()};t.subscribe("window.resize",function(){c.reposition()});return c};u.img=function(a,c){var b=o("<img>");b.attr("src",a);m.each(c,function(d,e){b.attr(d,e)});return b};u.anchor=function(a,d,c){var b=o("<a>");b.attr("href",a);b.text(d);m.each(c,function(e,f){b.attr(e,f)});return b};u.inView=function(d,j,i){i=i||0;var b=o(window),e=o(d),g,f,a,c,h;if(e.is(":hidden")){return false}g=b.scrollTop()-i;f=g+b.height()+i;a=e.offset()?e.offset().top:0;
c=a+e.height();h=false;if(j===true){h=((c>g)&&(a<=f))}else{h=((c<=f)&&(a>=g))}return h};u.init=function(){var b=m.throttle(500,function(d){t.publish("window.scroll",d)}),c=function(d){t.publish("window.load",d)},a=m.throttle(500,function(d){t.publish("window.resize",d)});if(window.addEventListener){window.addEventListener("scroll",b,false);window.addEventListener("load",c,false);window.addEventListener("resize",a,false)}else{if(window.attachEvent){window.attachEvent("onscroll",b);window.attachEvent("onload",c);
window.attachEvent("onresize",a)}}o(function(d){t.publish("document.ready",d)})};u.getGravatar=function(b,a){if(!b||b.length===0){return null}a=a||80;return"https://www.gravatar.com/avatar/"+m.md5(b.trim().toLowerCase())+".jpg?s="+a};u.maxlength=function(b,c,d,e,a){o(e||"body").off("keyup change",b);o(e||"body").on("keyup change",b,function(){var f=o(this).val(),g=f.length;c=parseInt(c,10);d.call(this,c-g,g);if(g>c){o(this).val(f.substr(0,c));if(a){window.alert(a)}return false}})};u.getActionReferences=function(b,c){var a={current:o(b)};
a.parent=c?a.current.parents(c):a.current;a.parent.find("[data-plugin]").each(function(d,e){a[o(e).attr("data-plugin")]=o(this)});return a};k=null;p={position:"fixed",left:0,top:0,width:"100%",height:"100%",backgroundColor:"#000",opacity:0.5,zIndex:99999};u.mask=function(b,c,a){if(!k){k=o("<div></div>");k.popup=b;k.css(m.extend(p,c));if(k.popup){k.popup.show()}if(typeof a==="undefined"||a===true){k.on("click",function(){if(k.popup){k.popup.hide()}u.unmask()})}o(document).one("keyup",function(d){if(d.keyCode===27){if(k){if(k.popup){k.popup.hide()
}u.unmask()}}});o("body").append(k)}else{l.warn("Already masked. Use ui.unmask() before masking again.")}return k};u.isMasked=function(){return k?true:false};u.unmask=function(){if(k){if(k.popup){k.popup.hide()}k.remove();k=null}else{l.warn("No mask available. Use ui.mask() before unmasking.")}};u.tooltip=function(b,c){c=c||5;var a=o("<div></div>");if(c>0){r.after(function(){a.fadeOut(function(){})})}return a};u.dialog=function(a){var b=o("<div></div>");b.css({backgroundColor:"#FFF"});b.html(a.html());
return b};u.customScrollbar=function(a){if(window.$&&window.$&&window.$.fn&&window.$.fn.mCustomScrollbar){a=window.$(a);a.mCustomScrollbar("destroy");a.mCustomScrollbar({scrollButtons:{enable:true},advanced:{updateOnContentResize:true,updateOnBrowserResize:true}})}else{l.warn("mCustomScrollbar not found.")}};u.disableScroll=function(a){o("html,body").css({overflow:"hidden",height:"100%",padding:"0",margin:"0"});o(a||"#container").css({overflowY:"scroll",height:"100%"})};u.enableScroll=function(a){o("html,body").css({overflow:"",height:"",padding:"",margin:""});
o(a||"#container").css({overflowY:"",height:""})};u.init();return u});define("tiljs/load",["./event","./logger","./util","./is"],function(h,j,g,i){j.log("load loaded");var f={};f.js=function(n,a,b,d){var e=document.getElementsByTagName("head")?document.getElementsByTagName("head")[0]:null;if(e){var o=document.createElement("script");var c;if(!n){throw new Error("Param 'url' not defined.")}var p=false;if(b){c=document.getElementById(b);if(c&&c.src===n){return}o.id=b;c=document.getElementById(b)}if(d){o.async=d
}if(!n){throw new Error("Param 'url' not defined.")}o.src=n;o.onload=o.onreadystatechange=function(){if(!o.loaded&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){o.loaded=true;var m=new Date().getTime();var l=m-o.startTime;h.publish("load.js",["_trackTiming","js",n,l,n]);if(a){try{a()}catch(k){h.publish("logger.error",k.stack)}}o.onload=o.onreadystatechange=null}};o.startTime=new Date().getTime();e.appendChild(o);return o}else{j.info("Head Element not found. JS '"+n+"' not loaded. ");
return null}};f.css=function(c,a){var b=document.getElementsByTagName("head")?document.getElementsByTagName("head")[0]:null;if(b){var d=document.createElement("link");d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href",c);b.appendChild(d);if(a){setTimeout(a,0)}}else{j.info("Head Element not found. CSS '"+c+"' not loaded. ")}return d};f.iframe=function(a,b,m,d){var e=document.getElementById(d)||document.body;if(e){var c=document.createElement("iframe");c.src=a;
c.scrolling="no";c.frameBorder="0";c.width=b||0;c.height=m||0;e.appendChild(c);return c}else{j.info("Container with id '"+d+"' not found. iframe '"+a+"' not loaded. ")}};f.image=function(a){if(i.array(a)){g.each(ajaxLogout,function(c,d){f.image(d)})}else{var b=new Image();b.src=a}};f._content=function(a,b){};f.isLoaded=function(a){return $('script[src="'+a+'"]').length>0||$('link[href="'+a+'"]').length>0};return f});define("tiljs/localstorage",["module","./util","json","./is","./logger"],function(r,n,l,o,k){var m={};
var p={};var q=n.extend(true,{},p,r.config());var j=window.localStorage;if(!j){k.warn("'localStorage' is not available.");j={getItem:function(){},removeItem:function(){},setItem:function(){}}}m.get=function(b){var a=j.getItem(b);if(a!=null){var c=l.parse(a);if(!c){return null}return(new Date().getTime()<c.timestamp)?c.value:null}else{return null}};m.getAll=function(){return m.get()};m.remove=function(c,a,b){if(c){j.removeItem(c)}};m.set=function(h,b,a,u,f,i){var g=new Date();var c=g.getTime()+((a||365)*24*60*60*1000);
var e={value:b,timestamp:new Date().getTime()+c,path:u,domain:f};try{j.setItem(h,l.stringify(e))}catch(d){k.error("Unable to save item in localStorage:"+h)}};return m});define("tiljs/apps/times/login",["../../login","../../util","module","../../page","../../ajax","../times/api","../../is","../../cookie","../../ui","../../logger","../../event","../../load","../../localstorage"],function(O,ag,ad,Y,Q,L,X,R,I,K,G,V,W){window.newLogin=true;var S={autoinit:false,multiuser:false,login:"",logout:"",channel:"ahmedabadmirror",login_channel:(function(){if(location.href.indexOf("ahmedabadmirror.com")>-1){return"mirror"
}else{return"ahmdmirrorin"}}()),mapping:null,renderer:false};var M=ag.extend(true,{},S,ad.config());try{document.domain=Y.getDomain()}catch(e){K.info("Domain cannot be set:"+Y.getDomain())}var H;if(navigator.userAgent.match("CriOS")){localStorage.removeItem("_ssodata");H=H||setInterval(function(){ac()},1000)}var ac=function(){if(localStorage.getItem("_ssodata")!=null){__sso(JSON.parse(localStorage.getItem("_ssodata")));localStorage.removeItem("_ssodata")}};var U=function(b,a){F=I.window(b,{width:850,height:780,scrollbars:0},function(c){if(c&&c.code==="200"){af.isLoggedIn()
}else{if(a){a(null,c)}}});F.moveTo(315,250)};var af=O;var aa=null;var ab=null;var ae=function(a){T({error:{code:a,message:M.messages[a]}})};var T=function(a){ab=a};var P=function(){return;if(F){F.close();F=null}ab=null};window.getLoginCallback=function(){return aa};window.getLoginData=function(){return ab};window.getDomain=function(){return Y.getDomain()};var Z=function(a){if(X.iframe(F)){F.src=a}else{F.document.location.href=a}};var N=function(b,c,a){Z(b);if(c){ae(c)}else{if(a){T(a)}}};var F=null;
window.__sso=function(a,b){K.log("__sso called");K.log(a);K.log(F);if(a&&F){K.log(b);var c=ab?ab.data:null;a.site=a.site||"email";if(a.closeWindow){K.log("Close pressed, closing window / popup");F.close()}else{if(a.status=="logout"){K.log("Closing window / popup");F.close()}else{if(a.status=="signinsuccess"||a.status=="ssosigninsuccess"){K.log("Closing window / popup");F.close()}else{if((a.site=="facebook"||a.site=="googleplus")&&a.status=="MappingUpdated"){K.log("Closing window / popup");F.close()
}else{if(a.status=="ssosigninfailure"&&a.ssoerror=="E119"){N(M.base_url+"/loginview.cms?x=error&site="+a.site,"email_failure")}else{if(a.status=="ssosigninfailure"&&a.ssoerror=="E104"){N(M.base_url+"/loginview.cms?x=error&site="+a.site,"email_failure")}else{if(a.err=="E104"&&a.facebooktoken){N(M.base_url+"/loginview.cms?x=error&site="+a.site,"facebook_failure_no_email")}else{if(a.status=="signinfailure"&&a.error=="F101"){N(M.base_url+"/loginview.cms?x=error&site="+a.site,a.site+"_failure")}else{if(a.status=="signinfailure"&&a.error=="twitter"&&a.site=="twitter"){N(M.base_url+"/loginview.cms?x=error&site=twitter","twitter_failure_unknown")
}else{if(a.status=="signinfailure"&&a.error=="user_denied"&&a.site=="facebook"){N(M.base_url+"/loginview.cms?x=error&site="+a.site,"facebook_failure_user_denied")}else{if(a.error=="E104"&&a.site=="twitter"){N(M.base_url+"/socialconnect.cms?site=twitter",null,{data:a,twitter_connect:true})}else{if(a.error=="E119"&&a.site=="twitter"){N(M.base_url+"/socialconnect.cms?site=twitter","twitter_link_username_failure");ab.data=c}else{if(a.status=="signinfailure"&&a.error=="T102"&&a.site=="twitter"){N(M.base_url+"/socialconnect.cms?site="+a.site,"twitter_failure_server_error")
}else{if(a.error=="E103"&&a.site=="twitter"){N(M.base_url+"/socialconnect.cms?site="+a.site,"twitter_failure_already_exist",ab?ab.data:null);ab.data=c}else{if(a.error=="SSO_INVALID_RES_CHK_MAIL_AV"&&a.site=="twitter"){N(M.base_url+"/socialconnect.cms?site="+a.site,"twitter_failure_invalid_email");ab.data=c}else{K.warn("Login case not handled");N(M.base_url+"/loginview.cms?x=error&site="+a.site,"unknown_error")}}}}}}}}}}}}}}}}K.log("Checking user status in __sso");af.isLoggedIn(aa)};af.closeWindow=window.closeLoginWindow=function(){if(F){F.close()
}};af.setLoginWindowDimension=window.setLoginWindowDimension=function(a,b){if(F){F.resizeTo(a,b);if(F.reposition){F.reposition()}F.focus()}};af.login=function(a,c,d){var f,b="http:";aa=function(g){G.publish("user.login",g);if(window.ga){ga("send","event","Login","Mast Head",document.location.href,{nonInteraction:1})}if(a){a(g)}};P();if(window.toiprops&&toiprops.useSSL){b="https:"}f="https://jsso.indiatimes.com/sso/identity/login?channel="+M.login_channel.toLowerCase()+"&ru=https://ahmedabadmirror.indiatimes.com/sso.cms?ru="+encodeURIComponent(location.href);
U(f,a)};af.loginWithTwitter=function(a){aa=function(c){G.publish("user.login",c);if(a){a(c)}};P();var b="https://jsso.indiatimes.com/sso/identity/login/socialLogin?channel="+M.login_channel.toLowerCase()+"&oauthsiteid=twitter";U(b,a)};af.loginWithFacebook=function(a){aa=function(c){G.publish("user.login",c);if(a){a(c)}};P();var b="https://jsso.indiatimes.com/sso/identity/login/socialLogin?channel="+M.login_channel.toLowerCase()+"&oauthsiteid=facebook";U(b,a)};af.loginWithGoogle=function(a){aa=function(c){G.publish("user.login",c);
if(a){a(c)}};P();var b="https://jsso.indiatimes.com/sso/identity/login/socialLogin?channel="+M.login_channel.toLowerCase()+"&oauthsiteid=googleplus";U(b,a)};af.logout=function(a){aa=function(){G.publish("user.logout");if(a){a()}};P();var d="https://jsso.indiatimes.com/sso/identity/profile/logout/external?channel="+M.login_channel.toLowerCase();var b=V.iframe(d);$(b).load(function(){$(b).remove();af.removeUser();if(window.__sso){window.__sso()}});W.remove("sso_user");var c=Y.getDomain();R.remove("ssoid","/",c);
R.remove("Fbsecuritykey","/",c);R.remove("fbookname","/",c);R.remove("CommLogP","/",c);R.remove("CommLogU","/",c);R.remove("FaceBookEmail","/",c);R.remove("Fbimage","/",c);R.remove("fbooklocation","/",c);R.remove("Fboauthid","/",c);R.remove("fbname","/",c);R.remove("fbLocation","/",c);R.remove("fbimage","/",c);R.remove("fbOAuthId","/",c);R.remove("MSCSAuth","/",c);R.remove("MSCSAuthDetail","/",c);R.remove("MSCSAuthDetails","/",c);R.remove("Twimage","/",c);R.remove("TwitterUserName","/",c);R.remove("Fboauthid","/",c);
R.remove("Twoauthid","/",c);R.remove("Twsecuritykey","/",c);R.remove("ssosigninsuccess","/",c);R.remove("prc","/",c);R.remove("ipr","/",c);R.remove("ssoid");R.remove("MSCSAuthDetail");R.remove("articleid");R.remove("txtmsg");R.remove("tflocation");R.remove("tfemail");R.remove("setfocus");R.remove("fbookname");R.remove("CommLogP");R.remove("CommLogU");R.remove("FaceBookEmail");R.remove("Fbimage");R.remove("fbooklocation");R.remove("Fboauthid");R.remove("Fbsecuritykey");R.remove("fbname");R.remove("fbLocation");
R.remove("fbimage");R.remove("fbOAuthId");R.remove("MSCSAuth");R.remove("MSCSAuthDetail");R.remove("MSCSAuthDetails");R.remove("ssosigninsuccess");R.remove("Twimage");R.remove("TwitterUserName");R.remove("Twoauthid");R.remove("Twsecuritykey");R.remove("prc");R.remove("ipr")};var J={check_user_status:function(c,a){var b=R.get("ssoid")||R.get("ssoId");var f=R.get("MSCSAuthDetails");if(!b&&f){b=f.split("=")[1]}if(b&&b.length>0){var d=O.getUser();if(d){if(a){a(d)}}else{if(f){L.getUsersInfo({ssoids:b},function(g){if(a){a(g[0]||g)
}})}else{Q.getJSONP("https://jsso.indiatimes.com/sso/crossdomain/getTicket?version=v1",function(g){if(g.ticketId!=null&&g.ticketId!=undefined&&g.ticketId.length>0){var h="https://socialappsintegrator.indiatimes.com/socialsite/v1validateTicket?ticketId="+g.ticketId+"&channel="+M.login_channel.toLowerCase();Q.getJSONP(h,function(i){if(location.hostname.indexOf(".indiatimes.com")>-1){L.getUsersInfo({ssoids:b},function(k){if(a){a(k[0]||k)}})}else{var j="https://"+location.hostname+"/v1validateTicket?ticketId="+g.ticketId+"&channel="+M.login_channel.toLowerCase();
Q.getJSONP(j,function(k){L.getUsersInfo({ssoids:b},function(l){if(a){a(l[0]||l)}})})}})}else{if(a){a(null)}}})}}}else{if(a){a(null)}}},check_user_status1:function(b,a){var c=O.getUser();if(c){if(a){a(c)}}else{Q.getJSONP("https://jsso.indiatimes.com/sso/crossdomain/getTicket?version=v1",b,function(f){var d=null;if(f&&f.ticketId){Q.getJSONP("lib/validateTicket.php",{ticketId:f.ticketId,siteId:Y.getSiteId(),type:"JSON"},function(h){var g=h.emailId;if(X.string(g)){g=g.split(",")}L.getUsersInfo({ssoids:g.join(",")},function(i){L.getBadges({uid:g.join(",")},function(j){L.getRewards({uid:g.join(",")},function(k){i[0].badges=j.output&&j.output.userbadgehistory?j.output.userbadgehistory[0].userbadges.activityBadge:[];
i[0].rewards=k&&k.output&&k.output.user?k.output.user:null;if(a){a(i[0])}})})})})}else{if(a){a(d)}}})}},mapping:{uid:"uid",email:"EMAIL",id:"_id",name:"FL_N",username:"D_N_U",fullName:"FL_N",firstName:"F_N",lastName:"L_N",icon:"tiny",link:"profile",CITY:"CITY",thumb:"thumb",followersCount:"F_C",FE_C:"FE_C",I_U_A:"I_U_A",I_I_L:"I_I_L",badges:"badges",rewards:"rewards",whatsonid:"W_ID",ps:"SUB_U_J"}};af.renderPlugins=function(a){a=a||af.getUser();$(function(){if(a){$("[data-plugin='user-isloggedin']").show();
$("[data-plugin='user-notloggedin']").hide();$("[data-plugin='user-name']").text(a.getFirstName());$("[data-plugin='user-icon']").attr("src",a.getIcon());$("[data-plugin='user-thumb']").attr("src",a.getThumb());L.getRewards({uid:a.getUid()},function(b){if(b&&b.output&&b.output.user&&b.output.user.levelName){$("[data-plugin='user-points']").text((b.output.user.statusPoints));$("[data-plugin='user-level']").text((b.output.user.levelName));$("[data-plugin='user-points-wrapper']").show().addClass("points_"+b.output.user.levelName.toLowerCase())
}else{$("[data-plugin='user-points-wrapper']").hide()}})}else{$("[data-plugin='user-icon']").attr("src",M.default_user_icon);$("[data-plugin='user-thumb']").attr("src",M.default_user_icon);$("[data-plugin='user-isloggedin']").hide();$("[data-plugin='user-notloggedin']").show()}$("body").toggleClass("loggedin",!!a);$("body").toggleClass("notloggedin",!a)})};af.updateConfig(J);return af});define("login",["tiljs/apps/times/login"],function(b){return b});define("api",["tiljs/apps/times/api"],function(c){var d=c;
return d});define("tiljs/plugin/plugin",["../load","../util","../event","../ui","../logger","../is"],function(l,n,q,m,j,o){var p={init:true,root:"body",dependency:function(a){this.dep_data={};if(a){a()}}};var k=function(a,b){if(!a){throw new Error("'id' param is required.")}this.id=a;this.updateConfig(b)};k.prototype.updateConfig=function(a){this.config=n.extend(true,{},p,a)};k.prototype.find=function(){return $(this.config.root).find("[data-plugin='"+this.id+"']")};k.prototype.init=function(){q.publish(r("beforeinit"));
if(o.funct(this.config.dependency)){var a=this;this.config.dependency(function(){a.render()})}else{this.render()}};k.prototype.render=function(){q.publish(r("beforerender"));var a=this;this.find().each(function(c,b){a.renderEach(b)});q.publish(r("afterrender"))};k.prototype.renderEach=function(a){};var r=function(a){return"plugin."+this.id+a};return k});define("tiljs/plugin/dynamic",["../timer","../util","../plugin/plugin"],function(g,f,h){var e=new h("dynamic-uptime");e.uptime=function(){var a=$("[data-plugin='dynamic-uptime']");
a.each(function(c,b){e.renderEach(b)})};e.renderEach=function(b){var c=$(b);var a=c.attr("data-time");var d=g.elapsedTime(a,{minute:"min",second:"sec"},true);c.html(d)};g.every(60000,function(){e.render()});e.init();return e});define("rodate",[],function(){var b={};b.uptime=function(){var a=$("[rodate]");a.each(function(f,e){b.renderEach(e)})};b.renderEach=function(j){var k=$(j);var h=k.attr("rodate");var l=h.match(/^(\d+)-(\d+)-(\d+) (\d+)\:(\d+)\:(\d+)$/);if(!l){h=!isNaN(h)?parseInt(h):h;var i=new Date(h);
if(!isNaN(i.getTime())){rod=i}else{if(h.indexOf("hrs IST")!=-1){h=h.replace(" hrs IST","");h=h.splice(-2,0,":")}h=h.replace("IST","");h=h.replace("hrs","");h=h.replace("AM"," AM");h=h.replace("PM"," PM");rod=new Date(h);if(isNaN(rod.getTime())){if(h.indexOf(":")>-1){h=h.split(" ").join("T");h=h.concat("+05:30");rod=new Date(h)}}}l=["",rod.getYear()+1900,rod.getMonth()+1,rod.getDate(),rod.getHours(),rod.getMinutes(),rod.getSeconds()]}var a=b.elapsedTime(new Date(l[1],l[2]-1,l[3],l[4],l[5],l[6]).getTime(),{minute:"min",second:"sec"},true);
k.html(a)};b.elapsedTime=function(o,u,w){if(typeof o!=="number"){return""}var a={year:"year",day:"day",hour:"hour",minute:"minute",second:"second",ago:"ago"};var p=$.extend({},a,u);var i=[{name:p.year,div:31536000000,mod:10000},{name:p.day,div:86400000,mod:365},{name:p.hour,div:3600000,mod:24},{name:p.minute,div:60000,mod:60},{name:p.second,div:1000,mod:60}];var q=0,t=i.length,r,l=[],v=new Date().getTime()-o;while(q<t){r=Math.floor(v/i[q].div)%i[q].mod;if(r&&r>=0){l.push(r+" "+i[q].name+(r>1?"s":""))
}q+=1}if(l.length===0){l.push("1 "+p.second)}if(w===true){return l[0]+" "+p.ago}else{return l.join(", ")+" "+p.ago}};return b});define("tiljs/plugin/lazy",["../event","../ui","module","../util"],function(l,j,m,h){var i={};var k={skew:1000,error_image:"/photo/63186464.cms"};var n=h.extend(true,{},k,m.config());i.init=function(){var a=this;a.load();l.subscribe("window.scroll",function(){a.load()})};i.load=function(){var a=this;var b=$("[data-src]");b.each(function(d,c){if(j.inView(c,true,n.skew)){a.loadEach(c)
}})};i.loadEach=function(a){var b=$(a);if(n.error_image){b.error(function(){$(this).attr("src",n.error_image)})}b.attr("src",b.attr("data-src"));b.removeAttr("data-src")};i.init();return i});define("jsrender",["jquery"],function(b){if(!b.fn.render){throw new Error("Missing js: https://timesofindia.indiatimes.com/jsrender.cms")}return b.fn.render});define("localstoragec",["tiljs/cookie"],function(d){var c={};c.isEnabled=function(){return typeof(Storage)!=="undefined"};c.checkExpiry=function(b){var a=localStorage.getItem(b);
if(a&&!(a.hasOwnProperty("timestamp")&&a.hasOwnProperty("expires"))){return b}if(a&&(Number(new Date().getTime())-Number(a.timestamp)>Number(a.expires)*60*60*24*1000)){localStorage.removeItem(b);return}return b};c.set=function(n,l,p,a,m,b){try{var o={value:l,timestamp:new Date().getTime(),expires:p};localStorage.setItem(n,JSON.stringify(o))}catch(e){d.set(n,l,p,a,m,b)}};c.get=function(b){var a="";try{a=JSON.parse(localStorage.getItem(b))}catch(f){a=localStorage.getItem(b)}return(a&&a.value)?a.value:a
};c.csget=function(a){return(c.isEnabled()&&c.get(a))?c.get(a):d.get(a)};c.remove=function(a){return localStorage.removeItem(a)};return c});define("tiljs/comments",["./util","./ui","jquery","module","./is","./plugin/lazy","./event"],function(m,k,o,t,n,r,u){var p={gravatar:false,wrapper:"#comment-section",main:"#comments",comment:"[data-plugin='comment']",tmpl:"comment_tmpl",count:"[data-plugin='comments-count']",post_button:"[data-plugin='comment-post']",comment_input:"[data-plugin='comment-input']",form:"[data-plugin='comment-form']",loadonscroll:true};
var q=function(a){this.config=m.extend(true,{},a)};q.config=m.extend(true,{},p,t.config());var l=[{text:"Hello World",name:"Del Sanic",image:"https://www.gravatar.com/avatar/?d=identicon",uid:"123456",badge:[{name:"Silver"},{name:"Gold"}]},{text:"Test Comment",name:"John",image:"https://www.gravatar.com/avatar/?d=identicon",uid:"123457",badge:[{name:"Silver"},{name:"Gold"}]}];q.getConfig=function(){return this.config};q.prototype.getConfig=function(){return this.config};q.prototype.initialize=function(){var a=this;
this.comments=[];this.getData(function(b,c){a.renderCommentCount(c||(b?b.length:0));if(b&&b.length>0){a.renderNoComment(false);a.render(b)}else{a.renderNoComment(true)}});if(a.config.loadonscroll===true){(function(b){u.subscribe("window.scroll",function(){b.loadNextPg()})})(a)}};q.prototype.getData=function(a){a(l)};q.prototype.renderCommentCount=function(a,b){o("[data-plugin='comment-count']").text(a)};q.prototype.renderNoComment=function(a){if(a){o("[data-plugin='comment-none']").show()}else{o("[data-plugin='comment-none']").hide()
}};q.prototype.render=function(e,d,c){var a=this;if(e){var b=o(a.config.wrapper+" "+a.config.main);if(c==false||typeof c==="undefined"){b.empty()}m.each(e,function(f,g){b.append(a.renderEach(f,g));if(d){d(e)}});r.load()}};q.prototype.renderEach=function(b,a){if(this.config.tmpl&&o.fn.render){return this.renderUsingTemplate(b,a,this.config.tmpl)}else{u.publish("logger.error","$.fn.render not defined. Render using jquery. this.config.tmpl="+this.config.tmpl+"&$.fn.render="+o.fn.render);return this.renderUsingjQuery(b,a)
}};q.prototype.renderUsingTemplate=function(a,d,b,c){return o("#"+b).render(d)};q.prototype.renderUsingjQuery=function(b,a){var c=o("<li></li>");c.text(a.name+": "+a.text);return c};q.prototype.loadingDiv=function(a){o("[data-plugin='comment-loading']").text(a)};q.prototype.loadNextPg=function(){var a=this;if(a.isLoading===0&&k.inView(a.config.main+" .comment:last-child",true,1000)){a.loadComment(a.config.commentType,function(b){},true,++a.config.curpg)}};q.prototype.loading=function(a){this.loadingDiv("Loading...");
this.isLoading=1};q.prototype.loaded=function(){this.loadingDiv("");this.isLoading=0;u.publish("comments.loaded",this);if(this.config.loadonscroll==false){o(this.config.wrapper).find("#"+this.config.commentType).append("<div class='loadmore'>View more comments</div>")}};q.prototype.loadedAll=function(){this.loadingDiv("Loaded all comments");o(this.config.wrapper+" #"+this.config.commentType+" .loadmore").hide();if(this.comments.length==0){u.publish("comments.loaded.none",this)}else{if(this.comments.length>=0){u.publish("comments.loaded.all",this)
}}this.isLoading=2};return q});define("tiljs/social/social",["../load","../util","jquery","../event","../ui","../logger"],function(j,h,k,m,l,n){var i=function(a){this.id=a;this.config={js:null,js_id:null};this.config=function(c){this.config=h.extend(true,{},this.config,c);this.js=c.js;this.js_id=c.js_id};this.setJS=function(d,c){this.js=d;this.js_id=c};this.plugins={};this._getPluginID=function(c){return b.id+"-"+c};this.addPlugin=function(e){b.plugins[this._getPluginID(e.id)]=e;if(e.alias){for(var d=0;
d<e.alias.length;d++){var c=h.extend(true,{},e,{id:e.alias[d]});delete c.alias;this.addPlugin(c)}}};this.getPlugin=function(c){return b.plugins[this._getPluginID(c)]};var b=this;this.beforeinit=function(){};this.afterloadjs=function(){};this.beforeloadjs=function(){};this.init=function(c){if(b.beforeinit){b.beforeinit()}var d=b.find();n.log(b.id+" init:"+d.length);if(d&&d.length>0||c.parse===true){if(b.beforeloadjs){b.beforeloadjs()}if(b.js&&(b.isJSdependent(d)||c.parse===true)){j.js(b.js,function(e,f){return function(){if(b.afterloadjs){b.afterloadjs(c)
}b.initPlugins(f)}}(b,d),b.js_id)}else{b.initPlugins(d)}}};this.find=function(){return k("[data-plugin^='"+this.id+"-']")};this.isJSdependent=function(f){for(var e=0;e<f.length;e++){var d=f[e];var c=k(d).attr("data-plugin");if(b.plugins[c]&&b.plugins[c].js){return true}}return false};this.initPlugins=function(c){this.registerPluginEvents()};this.registerPluginEvents=function(){h.each(b.plugins,function(c,d){h.each(d.events,function(f,g){k("body").off(f,"[data-plugin='"+c+"']");k("body").on(f,"[data-plugin='"+c+"']",function(p){if(g){try{m.publish("social.action",{plugin:c,event:f,element:this,dom_event:p});
g.call(this,p)}catch(p){m.publish("logger.error",p.stack)}}p.stopImmediatePropagation();return false})});var e=k("body").find("[data-plugin='"+c+"']");e.each(function(p,f){if(d.init){try{d.init(f,d)}catch(g){m.publish("logger.error",g.stack)}}})})};this.preAttachPluginEvent=function(d){var c=0;h.each(b.plugins,function(g,e){var f=d.filter("[data-plugin='"+g+"']");f.each(function(q,r){c++;if(e.init){e.init(r,e);k(r).css("border","2px solid red")}})});n.log(b.id+" found plugin : "+c+"/"+d.length)};
this.renderPlugin=function(r,f,d){var e=k(r);var c=h.data(r);var g=h.extend(true,{},f,c);g.href=c.url||c.href||e.attr("href")||g.href;var q=k(d);k.each(g,function(p,o){q.attr("data-"+p,o)});e.empty();e.append(q);this.parse(r)};this.getAbsoluteUrl=function(d){var c=(d&&d.length>0&&d!=="#")?d:document.location.href;c=c.split("#")[0];if(c&&c.length>2&&c[0]==="/"&&c[1]!=="/"){c=location.protocol+"//"+location.host+c}return c};this._share=function(u,g,c,r){m.publish("social.onBeforeShare",{params:g,element:r,network:this.id});
var t=this.getAbsoluteUrl(u);var d="social_share_"+new Date().getTime();var f=k.extend({name:d,width:700,height:400},c);var e=l.window(t+"?"+k.param(g),f);if(e){e.moveTo(275,275)}}};i.onBeforeShare=function(a){m.subscribe("social.onBeforeShare",a)};return i});define("tiljs/social/facebook",["../social/social","../ui","../logger","../event","../util","module","jquery","../ajax","../is"],function(D,r,p,E,u,C,w,q,v){var y={parse:false,init:true,appid:null,js:"//connect.facebook.net/en_US/sdk.js",js_id:"facebook-jssdk",load_js:false,share_url:"https://www.facebook.com/sharer.php",oauth:false,status:false,xfbml:false,fb_version:"v2.12",share_params:function(c,a,d,b){return{"url[url]":c}
}};var A=u.extend(true,{},y,C.config());var t=new D("facebook","facebook");t.setJS(A.js,A.js_id);var B=t.isJSdependent;t.isJSdependent=function(a){return A.load_js||B(a)};t.addPlugin({id:"like",js:true,init:function(c,e){var f=w(c);var d=u.data(c);var g={href:location.href,layout:"button_count","show-faces":"false",width:"100",action:"like",share:false};var a=u.extend(true,{},g,d);a.href=d.url||d.href||f.attr("href")||a.href;var b=w("<div class='fb-like'></div>");w.each(a,function(h,i){b.attr("data-"+h,i)
});f.empty();f.append(b);t.parse(c)}});t.addPlugin({id:"comments",js:true,init:function(b,d){var e=w(b);var c=u.data(b);var f={href:location.href,colorscheme:"light",numposts:10};var a=u.extend(true,{},f,c);a.href=c.url||c.href||e.attr("href")||a.href;var g=w("<div class='fb-comments'></div>");w.each(a,function(h,i){g.attr("data-"+h,i)});e.empty();e.append(g);t.parse(e[0])}});t.addPlugin({id:"share",alias:["button"],events:{click:function(b){var c=u.data(this);var a=c.title||document.title;t.share(c.url||w(this).attr("href"),a,c.summary,c.image,this)
}}});t.share=function(e,a,f,b,d){if(false&&window.FB&&A.appid){FB.ui({method:"feed",display:"popup",link:t.getAbsoluteUrl(e),picture:t.getAbsoluteUrl(b),name:a,description:f},function(g){})}else{var c={u:t.getAbsoluteUrl(e),display:"popup",sdk:"joey"};if(!v.empty(A.appid)){c.app_id=A.appid}t._share(A.share_url,c,{name:"facebook_share_dialog",width:626,height:(v.IE())?600:436},d)}};t.addPlugin({id:"follow",events:{click:function(a){t.follow(w(this).attr("data-url")||w(this).attr("href"))}},init:function(a,b){}});
t.follow=function(c,d){var b=t.getAbsoluteUrl(c);var a=window.open(c,"_blank");a.focus()};t.addPlugin({id:"login",js:true,events:{click:function(a){t.login()}}});var x=null;t.parse=function(a){if(typeof FB!=="undefined"){FB.XFBML.parse(a)}else{p.warn("'FB' is required in parse")}};t.getGrantedPermissions=function(a){if(typeof FB!=="undefined"){t.api("/me/permissions",function(b){if(a){a(b)}})}else{p.warn("'FB' is required in login")}};t.hasPermissions=function(b,a){if(typeof FB!=="undefined"){t.api("/me/permissions",function(c){if(c&&c.data&&c.data.length>0){var e=typeof b==="string"?b.split(","):(b instanceof Array?b:[]);
for(var f=0;f<e.length;f++){var d=c.data[0];if(d.hasOwnProperty(e[f])){if(a){a(true);return null}}}}if(a){a(false,c&&c.error?c.error:null)}})}else{p.warn("'FB' is required in login")}};t.getPermissions=function(b,a){if(typeof FB!=="undefined"){var c=typeof b==="string"?b:(b instanceof Array?b.join(","):"");t.hasPermissions(b,function(d){if(d===true){if(a){a(d)}}else{t.login(b,function(){t.hasPermissions(b,function(e){if(a){a(e)}})})}})}else{p.warn("'FB' is required in login")}};t.login=function(b,a){if(typeof FB!=="undefined"){p.log(b);
var c=typeof b==="string"?b:(b instanceof Array?b.join(","):"");if(x!=c){FB.login(a,{scope:c})}}else{p.warn("'FB' is required in login")}};t.addPlugin({id:"logout",events:{click:function(a){t.logout()}}});t.logout=function(a){if(typeof FB!=="undefined"){FB.logout(a)}else{p.warn("'FB' is required in logout")}};t._createFBroot=function(){var a="fb-root";var b=w("#"+a);if(!b||b.length==0){b=w("<div></div>");b.attr("id",a);b.css("display","none");w("body").append(b)}return b};t.beforeinit=function(){if(!A.appid){p.warn("'config.appid' is Required")
}};t.beforeloadjs=function(){t._createFBroot()};t.afterloadjs=function(a){if(typeof FB!=="undefined"){p.log("FB js loaded");if(A.init===true||a.init===true){FB.init({appId:A.appid,oauth:A.oauth,status:A.status,cookie:true,xfbml:A.xfbml,version:A.fb_version})}E.publish("FB.onload",FB);FB.Event.subscribe("edge.remove",function(b){E.publish("FB.edge.remove",b)});FB.Event.subscribe("edge.create",function(b){E.publish("FB.edge.create",b)});FB.Event.subscribe("comment.create",function(b){E.publish("FB.comment.create",b)
});FB.Event.subscribe("auth.authResponseChange",function(d){E.publish("FB.auth.authResponseChange",d);if(d.status==="connected"){var b=d.authResponse.userID;var c=d.authResponse.accessToken;E.publish("FB.auth.authResponseChange.connected",d);E.publish("FB.connected",FB)}else{if(d.status==="not_authorized"){E.publish("FB.auth.authResponseChange.not_authorised",d)}else{E.publish("FB.auth.authResponseChange.failed",d)}}})}else{p.warn("'FB' is required in afterloadjs")}};var z=null;t.getUser=function(a){if(typeof FB!=="undefined"&&!z){FB.api("/me",function(b){if(a){z=b;
a(b)}})}else{if(a){a(z)}}};t.onlogin=function(a){E.subscribe("FB.auth.authResponseChange.connected",function(b){t.getUser(function(c){if(a){a(c,b)}})})};t.oncomment=function(a){E.subscribe("FB.comment.create",function(b){t.getUser(function(c){if(a){a(c,b)}})})};t.onlogout=function(a){E.subscribe(["FB.auth.authResponseChange.not_authorised","FB.auth.authResponseChange.failed"],function(b){if(a){z=null;a(b)}})};t.fql=function(b,a){if(typeof FB!=="undefined"){p.log(b);FB.api({method:"fql.query",query:b},a)
}else{p.warn("'FB' is required in fql")}};t.getLikes=function(a){if(typeof FB!=="undefined"){FB.api("/me/likes",function(b){if(a){z=b;a(b)}})}};t.getLikesByCategory=function(c,a){if(c.length>0&&v.string(c)){c=c.split(",")}var d=[];if(c.length>0){u.each(c,function(e,f){d.push("type='"+f+"'")})}var b=d.length>0?"AND ("+d.join(" OR ")+")":"";t.getUser(function(e){if(e){t.fql("select name from page where page_id in (SELECT page_id FROM page WHERE page_id IN (SELECT uid, page_id, type FROM page_fan WHERE uid=me()) "+b+")",function(f){if(a){a(f)
}})}else{p.warn("User is not logged in. Cannot run facebook.getLikesByCategory.")}})};t.paging=t.pageNext=function(b,a){if(b&&b.paging&&b.paging.next){return q.getJSONP(b.paging.next,a)}else{a(null)}};t.pagePrev=function(b,a){if(b&&b.paging&&b.paging.previous){return q.getJSONP(b.paging.previous,a)}else{a(null)}};t.getRegisteredUsersTxt=function(a){t.getRegisteredUsers(function(b){if(a){if(b.length==1){a(b[0].name+" has planned his/her trips on HappyTrips.com.",b)}else{if(b.length>1){a(b.length+" of your friends have planned their trips on HappyTrips.com",b)
}else{a("None of your friends have planned their trips on HappyTrips.com.",b)}}}})};t.getRegisteredUsers=function(a){t.fql("SELECT uid,name,pic_square_with_logo FROM user WHERE is_app_user AND uid IN (SELECT uid2 FROM friend WHERE uid1 = me())",a)};t.api=function(){var d=arguments[0];var a=typeof arguments[1]==="string"?arguments[1]:"GET";var c=typeof arguments[2]==="object"?arguments[2]:{};var b=typeof arguments[1]==="function"?arguments[1]:(typeof arguments[2]==="function"?arguments[2]:(typeof arguments[3]==="function"?arguments[3]:null));
if(typeof FB!=="undefined"){p.debug(d);FB.api(d,a,c,function(e){if(b){b(e)}})}else{p.warn("'FB' is required in api")}};t.getCheckins=function(a){t.api("/me/locations",a)};t.post=function(b,a){var c=typeof arguments[0]==="string"?{message:arguments[0]}:arguments[0];t.login("publish_stream",function(){t.api("/me/feed","POST",c,a)})};t.checkin=function(b,c,a){t.post({message:b,place:c},a)};t.init(A);return t});define("tiljs/ext/date",[],function(){!function(i,l){var m=/(["'])((?:[^\\]|\\.)*?)\1|YYYY|([MD])\3\3(\3?)|SS|([YMDHhmsW])(\5?)|[uUAZSwo]/g,j=/(\d{4})[-.\/](\d\d?)[-.\/](\d\d?)/,k=/(\d\d?)[-.\/](\d\d?)[-.\/](\d{4})/,o=/(\d\d?):(\d\d):?(\d\d)?\.?(\d{3})?(?:\s*(?:(a)|(p))\.?m\.?)?(\s*(?:Z|GMT|UTC)?(?:([-+]\d\d):?(\d\d)?)?)?/i,p=/.[a-z]+/g,n=/\\(.)/g;
i[l].format=function(c){c=i.masks[c]||c||i.masks["default"];var b=this,a="get"+(c.slice(0,4)=="UTC:"?(c=c.slice(4),"UTC"):"");return c.replace(m,function(d,e,g,h,u,f,t){g=f=="Y"?b[a+"FullYear"]()%100:d=="YYYY"?b[a+"FullYear"]():f=="M"?b[a+"Month"]()+1:h=="M"?i.monthNames[b[a+"Month"]()+(u?12:0)]:f=="D"?b[a+"Date"]():h=="D"?i.dayNames[b[a+"Day"]()+(u?7:0)]:f=="H"?b[a+"Hours"]()%12||12:f=="h"?b[a+"Hours"]():f=="m"?b[a+"Minutes"]():f=="s"?b[a+"Seconds"]():d=="S"?b[a+"Milliseconds"]():d=="SS"?(e=b[a+"Milliseconds"](),e>99?e:(e>9?"0":"00")+e):d=="u"?(b/1000)>>>0:d=="U"?+b:d=="A"?i[b[a+"Hours"]()>11?"pm":"am"]:d=="Z"?"GMT "+(-b.getTimezoneOffset()/60):d=="w"?b[a+"Day"]()||7:f=="W"?(e=new i(+b+((4-(b[a+"Day"]()||7))*86400000)),Math.ceil(((e.getTime()-e["s"+a.slice(1)+"Month"](0,1))/86400000+1)/7)):d=="o"?new i(+b+((4-(b[a+"Day"]()||7))*86400000))[a+"FullYear"]():e?g.replace(n,"$1"):d;
return t&&g<10?"0"+g:g})};i.am="AM";i.pm="PM";i.masks={"default":"DDD MMM DD YYYY hh:mm:ss",isoUtcDateTime:'UTC:YYYY-MM-DD"T"hh:mm:ss"Z"'};i.monthNames="JanFebMarAprMayJunJulAugSepOctNovDecJanuaryFebruaryMarchAprilMayJuneJulyAugustSeptemberOctoberNovemberDecember".match(p);i.dayNames="SunMonTueWedThuFriSatSundayMondayTuesdayWednesdayThursdayFridaySaturday".match(p);String[l].date=Number[l].date=function(b){var d,c,a=new i,e=+this||""+this;if(isNaN(e)){if(d=e.match(j)){a.setFullYear(d[1],d[2]-1,d[3])
}else{if(d=e.match(k)){c=i.middle_endian?1:2;a.setFullYear(d[3],d[c]-1,d[3-c])}}d=e.match(o)||[0,0,0];a.setHours(d[6]&&d[1]<12?+d[1]+12:d[5]&&d[1]==12?0:d[1],d[2],d[3]|0,d[4]|0);if(d[7]){a.setTime(a-((a.getTimezoneOffset()+(d[8]|0)*60+((d[8]<0?-1:1)*(d[9]|0)))*60000))}}else{a.setTime(e<4294967296?e*1000:e)}return b?a.format(b):a}}(Date,"prototype");return{}});define("tiljs/apps/times/comments",["module","jquery","json","jsrender","localstoragec","../times/api","../../comments","../../ajax","../../plugin/dynamic","../../util","../../login","../../event","../../ui","../../is","../../string","../../plugin/lazy","../../cookie","../../logger","../../timer","../../analytics/mytimes","../../compatibility","../../social/facebook","../../page","../../user","../../ext/date"],function(module,$,json,jsrender,localstoragec,api,comments,ajax,dynamic,util,login,event,ui,is,string,lazy,cookie,logger,timer,mytimes,compatibility,facebook,page,userClass,ext_date){var CONSTANT={RATE_TYPE:{AGREE:100,DISAGREE:101,RECOMMEND:102,OFFENSIVE:103}};
var default_config={validation:{minlength:1},loadCommentFromMytimes:false,commentType:"comments",loadonscroll:true,sendCommentLiveEmail:true,loginRequiredForRating:true,nonloggedinComment:true,disabledirectcomment:false,maxchar:3000,maxCommentWrapLength:500,maxResponseCount:3,hideResponses:false,share_url:"/share.cms",verify_comment_url:"/json/cmtverified.cms",messages:{name_required:"Please enter your name.",location_required:"Please enter your location.",captcha_required:"Please enter captcha value.",name_toolong:"Name cannot be longer than 30 chars.",name_not_string:"Name can only contain alphabets.",location_toolong:"Location cannot be longer than 30 chars.",location_not_string:"Location can only contain alphabets.",captcha_toolong:"Captcha cannot be longer than 4 chars.",captcha_number_only:"Captcha value can only be a number.",email_required:"Please enter your email address.",email_invalid:"Please enter a valid email address.",captcha_invalid:"Please enter a valid captcha value.",minlength:"You can't post this comment as the length it is too short. ",blank:"You can't post this comment as it is blank.",maxlength:"You have entered more than 3000 characters.",popup_blocked:"Popup is blocked.",has_url:"You can't post this comment as it contains URL.",duplicate:"You can't post this comment as it is identical to the previous one.",abusive:"You can't post this comment as it contains inappropriate content.",self_agree:"You can't Agree with your own comment",self_disagree:"You can't Disagree with your own comment",self_recommend:"You can't Recommend your own comment",self_offensive:"You can't mark your own comment as Offensive",already_agree:"You have already Agreed with this comment",already_disagree:"You have already Disagreed with this comment",already_recommended:"You have already Recommended this comment",already_offensive:"You have already marked this comment Offensive",cant_agree_disagree:"You can't Agree and Disagree with the same comment",cant_agree_offensive:"You can't Agree and mark the same comment Offensive",cant_disagree_recommend:"You can't Disagree and Recommend the same comment",cant_recommend_offensive:"You can't Recommend and mark the same comment Offensive",permission_facebook:"You can't post to facebook. Post permission is required.",offensive_reason:"Please select a reason.",offensive_reason_text:"Please enter a reason.",offensive_reason_text_limit:"Please enter less than 200 chars.",loginreq:"Please login to post your comment"},isEUuser:false};
if(window.TimesGDPR&&TimesGDPR.common.consentModule.gdprCallback){TimesGDPR.common.consentModule.gdprCallback(function(data){if(!data.isEUuser){default_config.isEUuser=false}else{default_config.isEUuser=true}})}var times_comments=comments;comments.config=util.extend(true,{},comments.config,default_config,module.config());times_comments.prototype.updateConfig=function(update_config){};var commentType=comments.config.commentType;times_comments.prototype.initialize=function(){var tthis=this;this.config=util.extend(true,{},comments.config,module.config(),this.config);
tthis.comments=[];tthis.commentCount=0;tthis.countPresent=false;tthis.pageCount=1;tthis.config.comment_block_count=tthis.config.comment_block_count||25;tthis.config.commentType=tthis.config.commentType||commentType;tthis.config.attachReplyAction=tthis.config.attachReplyAction!==false;tthis.config.attachOpinionAction=tthis.config.attachOpinionAction!==false;if(tthis.config.disabledirectcomment){$(tthis.config.wrapper+' [data-plugin="comment-form"]').hide()}if(login.getUser()){$(tthis.config.wrapper+" [data-plugin='user-isloggedin']").show();
$(tthis.config.wrapper+" [data-plugin='user-notloggedin']").hide()}else{$(tthis.config.wrapper+" [data-plugin='user-isloggedin']").hide();$(tthis.config.wrapper+" [data-plugin='user-notloggedin']").show()}if(!tthis.config.nonloggedinComment&&tthis.pageCount===1){$(tthis.config.wrapper+' [data-plugin="user-notloggedin"]').remove()}tthis.config.opinions=[{name:"Agree",id:"agree"},{name:"Disagree",id:"disagree"},{name:"Recommend",id:"recommended"},{name:"Offensive",id:"offensive"}];if(tthis.config.attachOpinionAction===true){tthis.attachOpinionAction()
}if(tthis.config.attachReplyAction===true){tthis.attachReplyAction()}this.getData(function(data,commentCount){tthis.renderCommentTop(data[0]);tthis.renderCommentCount(commentCount||(data?data.length:0));if(data&&data.length>0){tthis.renderNoComment(false);tthis.render(data)}else{tthis.renderNoComment(true)}tthis.verifyEmailComment()});(function(tthis){event.subscribe("window.scroll",function(){var config=tthis.getConfig();if(tthis.config.loadonscroll===true&&tthis.isLoading===0&&ui.inView(tthis.config.wrapper+" #"+tthis.config.commentType+" [data-plugin='comment']:visible:last",true,200)){tthis.loadComment(tthis.config.commentType,function(data){},true,++tthis.pageCount)
}})})(tthis)};times_comments.prototype.processRating=function(){var user=login.getUser();if(!user){$(this.config.wrapper+" [data-plugin='comment-error-outer']").text("");$(this.config.wrapper+" [data-plugin='comment-error']").text("");event.publish("comment_error")}var commenttype="comments"+($(this.config.wrapper+" #comment_sort").length&&$(this.config.wrapper+" #comment_sort").val()!==""?"_"+$(this.config.wrapper+" #comment_sort").val():"");if(user&&this&&this.config&&this.config.msid){var savedComment=this.getSavedComment();
var usr_data={};usr_data.userId=user.getId();usr_data.baseEntityId=0;usr_data.uniqueAppKey=this.config.msid;usr_data.appKey="AM";$.getJSON("https://myt.indiatimes.com/mytimes/alreadyRated?callback=?",usr_data,function(data){event.publish("comments.user_has_rated",data);if(this.config&&(window.msid==this.config.msid)&&this.getSavedComment()){data=(data&&data!="")?data:" ";savedComment.urs=data;this.saveComment(savedComment);this.loadSavedComment()}})}this.markFollowingAll()};times_comments.run=function(config){this.config=util.extend(true,{},comments.config,module.config());
var msid=config&&config.msid?config.msid:window.msid;var main=config&&config.main?config.main:"#"+this.config.commentType;var wrapper=config&&config.wrapper?config.wrapper:this.config.wrapper;var toi_comment={};toi_comment[this.config.commentType]=new comments({main:main,msid:msid,wrapper:wrapper});toi_comment[this.config.commentType].initialize();var that=this;$(wrapper+" #comment_sort").change(function(){var rootid=$(this).val(),id="comments"+(rootid&&rootid.length>0?"_"+rootid:""),sortLbl=rootid.length?rootid:"newest";
$(wrapper+" .comments-list").hide();$(wrapper+" #"+id).show();$(wrapper+".comment-section .noComment").hide();if(toi_comment[id]){toi_comment[id].updateAfterCommentsLoaded();toi_comment[id].attachReplyAction();toi_comment[id].attachOpinionAction();toi_comment[id].updateCachedRating()}else{toi_comment[id]=new comments({main:"#"+id,msid:msid,commentType:id,wrapper:wrapper});toi_comment[id].initialize()}event.publish("comment.sort",sortLbl);$(wrapper+" [data-plugin='comment-error-outer']").text("");
$(wrapper+" [data-plugin='comment-error']").text("");event.publish("comment_error")});event.subscribe("user.status",function(){toi_comment[that.config.commentType].processRating()});event.subscribe("comments.loaded",function(commentObj){logger.log("comments.loaded:"+commentObj.config.commentType);commentObj.updateAfterCommentsLoaded();if(commentObj.config.hideResponses===true){commentObj.hideExtraResponses()}});event.subscribe("comments.loaded.none",function(commentObj){logger.log("comments.loaded.none:"+commentObj.config.commentType);
commentObj.updateAfterCommentsLoaded()});event.subscribe("login.error",function(err){if(err&&err.error){logger.error(err.error)}else{logger.error(err)}});return toi_comment};times_comments.prototype.processRating=function(){var user=login.getUser();if(!user){$(this.config.wrapper+" [data-plugin='comment-error-outer']").text("");$(this.config.wrapper+" [data-plugin='comment-error']").text("");event.publish("comment_error")}var commenttype="comments"+($(this.config.wrapper+" #comment_sort").length&&$(this.config.wrapper+" #comment_sort").val()!==""?"_"+$(this.config.wrapper+" #comment_sort").val():"");
if(user&&this&&this.config&&this.config.withrating){var savedComment=this.getSavedComment();var usr_data={};usr_data.userId=user.getId();usr_data.baseEntityId=0;usr_data.uniqueAppKey=this.config.withrating;usr_data.appKey=page.getChannel();$.getJSON("https://myt.indiatimes.com/mytimes/alreadyRated?callback=?",usr_data,function(data){event.publish("comments.user_has_rated",data);if(window.msid==this.config.msid&&this.getSavedComment()){data=(data&&data!="")?data:" ";savedComment.urs=data;this.saveComment(savedComment);
this.loadSavedComment()}})}this.markFollowingAll()};times_comments.prototype.attachUserToComment=function(commentObj,user){logger.log("Attaching user to comment");commentObj.user={id:user.getId(),uid:user.getId()?user.getUid():"",name:user.getFullName(),username:user.getUsername(),location:user.getCITY(),image:user.getThumb(),email:user.getEmail()}};times_comments.prototype.hideExtraResponses=function(){var ttthis=this;$($(this.config.wrapper+" #"+this.config.commentType+" .comment-box.level1").get().reverse()).each(function(i,v){var tc=$(this);
var tc_level=tc.data("level");var tc_next=tc.next();if(is.numberOnly(tc_next.data("level"))){var response_cnt=0;while((tc_next.data("level")!=tc_level)&&(tc_next.is(":hidden"))&&(i<ttthis.config.comment_block_count)){if(response_cnt==ttthis.config.maxResponseCount){tc_next.before('<div class="show_all_responses comment-box level'+(tc_level+1)+'" data-level="'+tc_level+'" data-action="all_responses"> Show all responses </div>');break}else{tc_next.slideDown();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break
}}response_cnt++}}})};times_comments.prototype.updateAfterCommentsLoaded=function(){var commentObj=this;if(this.pageCount===1){if(commentObj.config.commentType===this.config.commentType){if(commentObj.comments.length>0){logger.log("updateAfterCommentsLoaded : comments.loaded:"+commentObj.config.commentType);$(commentObj.config.wrapper+".comment-section .sortby").show()}else{logger.log("updateAfterCommentsLoaded : comments.loaded.none:"+commentObj.config.commentType);$(commentObj.config.wrapper+".comment-section .sortby").hide();
$(commentObj.config.wrapper+".comment-section .noComment").text("Be the first one to review.").show()}}if(commentObj.countPresent!==true){logger.log("updateAfterCommentsLoaded : countPresent:false:"+commentObj.config.commentType);if(commentObj.comments.length===0){$(commentObj.config.wrapper+".comment-section .noComment").text("Be the first one to review.").show()}else{if(commentObj.config.commentType==="comments_discussed"){$(commentObj.config.wrapper+".comment-section .noComment").text("None of the comments have been discussed.").show()
}else{if(commentObj.config.commentType==="comments_agree"){}else{if(commentObj.config.commentType==="comments_disagree"){$(commentObj.config.wrapper+".comment-section .noComment").text("None of the comments have been down voted.").show()}}}}}}};times_comments.prototype.renderCommentTop=function(data){usrid=data.user.username?data.user.username:"";TC="<h3><span>top comments</span></h3>";TC+="<div class='commentquote'><a href='#'></a></div><div class='dispalyTc'><p>"+data.comment+"</p>";if(usrid){TC+="<span><a href='https://mytimes.indiatimes.com/profile/"+usrid+"'><b>"+usrid+"'</b></a></span>"
}TC+="</div><div class='pb-10'></div>";$("[data-plugin='comment-top']").html(TC)};times_comments.prototype.renderCommentCount=function(count){var tthis=this;function displayCount(type,cnt){$(tthis.config.wrapper+" [data-plugin='comment-count"+(type?"-"+type:"")+"']").text(cnt?cnt:"0");event.publish("comment.count",(cnt?cnt:"0"))}if(is.object(count)){displayCount("",count.newest);displayCount("oldest",count.oldest);displayCount("recommended",count.recommended);displayCount("discussed",count.discussed);
displayCount("agree",count.agree);displayCount("disagree",count.disagree)}else{displayCount("",count)}};times_comments.prototype.loadComment=function(commentType,callback,append,curpg){var tthis=this;if(tthis.config.loadCommentFromMytimes==true){tthis._loadCommentMytimes(commentType,function(data){tthis.render(data,callback,append)},curpg)}else{tthis._loadComment(commentType,function(data){tthis.render(data,callback,append)},curpg)}};times_comments.prototype.getData=function(callback){var tthis=this;
if(tthis.config.loadCommentFromMytimes==true){this._loadCommentMytimes(this.config.commentType,callback)}else{this._loadComment(this.config.commentType,callback)}};times_comments.prototype._loadComment=function(commentType,callback,curpg){var tthis=this;var config=tthis.config;tthis.loading();logger.log("loading comments: "+config.msid);api.api(commentType,{msid:config.msid,curpg:curpg||1},function(comments_data){logger.log("loaded comments: "+config.msid);var commentsD=comments_data.articlecomment||comments_data.new_cmtofart2_nit||comments_data.new_cmtofart2_nit_v1||comments_data.articleshow_othcmtofart||comments_data.new_cmtofart2_nit_sub_dev||(comments_data.mytuserdata?comments_data:null);
var userData=commentsD.mytuserdata&&commentsD.mytuserdata.array?(is.array(commentsD.mytuserdata.array)?commentsD.mytuserdata.array:[commentsD.mytuserdata.array]):null;var commentsData=commentsD.rothrd&&commentsD.rothrd.op?(is.array(commentsD.rothrd.op)?commentsD.rothrd.op:[commentsD.rothrd.op]):null;if(!commentsData||commentsData.length==0){tthis.loadedAll();callback([]);return null}tthis.flagData=commentsData[0];var commentCount={total:commentsD.rothrd.opctr,newest:commentsD.rothrd.opctr,oldest:commentsD.rothrd.opctr,recommended:commentsD.rothrd.recommendcount,discussed:commentsD.rothrd.opctrtopcnt,disagree:commentsD.rothrd.disagreecount,agree:commentsD.rothrd.agreecount};
var commentPageCount={comments:Math.ceil(commentsD.rothrd.opctrtopcnt/config.comment_block_count),comments_oldest:Math.ceil(commentsD.rothrd.opctrtopcnt/config.comment_block_count),comments_recommended:Math.ceil(commentsD.rothrd.recommendcount/config.comment_block_count),comments_discussed:Math.ceil(commentsD.rothrd.opctrtopcnt/config.comment_block_count),comments_disagree:Math.ceil(commentsD.rothrd.disagreecount/config.comment_block_count),comments_agree:Math.ceil(commentsD.rothrd.agreecount/config.comment_block_count)};
var users=[];var i=0;if(userData){for(i=0;i<userData.length;i++){users.push(userData[i].sso)}}var commentsResult=[];for(var c=0;c<commentsData.length;c++){var cmt=commentsData[c];var user=userData?userData[users.indexOf(cmt.roaltdetails.fromaddress)]:null;var comment={index:++tthis.commentCount,id:cmt.messageid,comment:is.string(cmt.optext)?$("<div/>").text(cmt.optext).html():"",level:cmt.level,childcount:cmt.CHILD?cmt.CHILD.length:0,parentuid:cmt.parentuid,parentusername:cmt.parentusername,time:cmt.rodate?util.getDate(cmt.rodate).getTime():"",abstime:cmt.rodate,opinion:(function(cmt){var opinions=[];
if(tthis.config.opinions){for(var o=0;o<tthis.config.opinions.length;o++){opinions.push({name:tthis.config.opinions[o].name,id:tthis.config.opinions[o].id,count:cmt[tthis.config.opinions[o].id]})}}return opinions.length>0?opinions:null}(cmt)),user:{id:user&&user._id?user._id:cmt.roaltdetails.fromname,username:user?user.D_N_U:null,name:cmt.roaltdetails.fromname||(user&&user.FL_N?user.FL_N:""),location:user&&user.CITY&&!is.object(user.CITY)&&!is.empty(user.CITY)?user.CITY:(!is.empty(cmt.roaltdetails.location)&&!is.object(cmt.roaltdetails.location)?cmt.roaltdetails.location:null),image:user&&user.thumb?user.thumb:cmt.roaltdetails.imageurl,email:user?user.sso:"",rate:cmt.roaltdetails.urs,followers:user?user.F_C:0,follower_text:(user?user.F_C:0)>1?("("+user.F_C+" followers)"):((user?user.F_C:"")>0?"("+user.F_C+" follower)":""),points:user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null,pointslevel:user&&user.reward&&user.reward.user&&user.reward.user.levelName?user.reward.user.levelName:null,pointsNeeded:(function(user){var points_needed="";
var user_points=user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null;if(user_points==null||user_points<250){points_needed=250-user_points}else{if(user_points>249&&user_points<5000){points_needed=5000-user_points}else{if(user_points>4999&&user_points<25000){points_needed=25000-user_points}else{if(user_points>24999&&user_points<250000){points_needed=250000-user_points}}}}return points_needed}(user)),badge:(function(user){var badges=[];if(user&&user.rewardpoint&&user.rewardpoint.userbadges&&user.rewardpoint.userbadges.activityBadge){var activityBadge=user.rewardpoint.userbadges.activityBadge;
if(!is.array(activityBadge)){activityBadge=[activityBadge]}for(var d=0;d<activityBadge.length;d++){var badge=activityBadge[d].currentBadge;badges.push({name:badge.bname,count:badge.level,image:badge.bimg,desc:badge.desc,levelDesc:util.decodeHTML(badge.levelDesc)})}}return badges.length>0?badges:null}(user))}};commentsResult.push(comment);logger.log("Parsed comment "+c)}tthis.comments=tthis.comments.concat(commentsResult);logger.log("rendering  "+commentsResult.length+" comments");callback(commentsResult,commentCount);
logger.log("rendered "+commentsResult.length+" comments");tthis.loaded();var curpgn=curpg||1;if(tthis.config.loadonscroll==false&&!commentsResult||!(curpgn<commentPageCount[tthis.config.commentType])){tthis.loadedAll()}else{if(tthis.config.loadonscroll==true&&!commentsResult||commentsResult.length==0){tthis.loadedAll()}}});return null};times_comments.prototype.parseComment=function(cmt,commentsResult,level){var ttthis=this;var user=cmt.user_detail||{FL_N:cmt.A_D_N||cmt.F_NAME,CITY:cmt.CITY};user.reward={user:cmt.user_reward};
user.rewardpoint={userbadges:cmt.user_reward_point_info};user.rate=cmt&&cmt.U_R?cmt.U_R:"";var tthis=this;level=level||1;var comment={index:++tthis.commentCount,id:cmt.A_U_I,comment:is.string(cmt.C_T)?$("<div/>").html(cmt.C_T).text():"",trimcom:(function(cmt){var t_c=is.string(cmt.C_T)?$("<div/>").html(cmt.C_T).text():"";return util.trimText(t_c,ttthis.config.maxCommentWrapLength)}(cmt)),authrid:(cmt.C_A_ID?cmt.C_A_ID:""),level:level,parentuid:cmt.O_ID,childcount:cmt.CHILD?cmt.CHILD.length:0,parentusername:cmt.O_D_N||cmt.F_NAME,time:(cmt.A_DT?util.getDate(parseInt(cmt.A_DT,10)).getTime():""),abstime:cmt.A_DT?util.getDate(parseInt(cmt.A_DT,10)).format("DD MMM, YYYY HH:mm A"):"",opinion:(function(cmt){var opinions=[];
opinions.push({name:"Agree",id:"AC_A_C",count:(cmt.AC_A_C)?cmt.AC_A_C:0});opinions.push({name:"Disagree",id:"AC_D_C",count:(cmt.AC_D_C)?cmt.AC_D_C:0});opinions.push({name:"Recommend",id:"AC_R_C",count:(cmt.AC_R_C)?cmt.AC_R_C:0});opinions.push({name:"Offensive",id:"AC_O_C",count:(cmt.AC_O_C)?cmt.AC_O_C:0});return opinions.length>0?opinions:null}(cmt)),user:{id:user&&user._id?user._id:null,username:user&&user.D_N_U?user.D_N_U:null,name:user&&user.FL_N?user.FL_N:"",location:user&&user.CITY&&!is.object(user.CITY)&&!is.empty(user.CITY)&&(user.CITY!="Unknown")?user.CITY:null,image:user&&user.thumb?user.thumb:"",email:user&&user.sso?user.sso:"",rate:user&&user.rate?user.rate:"",followers:user&&user.F_C?user.F_C:0,follower_text:(user?user.F_C:0)>1?("("+user.F_C+" followers)"):((user?user.F_C:"")>0?"("+user.F_C+" follower)":""),points:user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null,pointslevel:user&&user.reward&&user.reward.user&&user.reward.user.levelName?user.reward.user.levelName:null,pointsNeeded:(function(user){var points_needed="";
var user_points=user&&user.reward&&user.reward.user&&user.reward.user.statusPoints?user.reward.user.statusPoints:null;if(user_points==null||user_points<250){points_needed=250-user_points}else{if(user_points>249&&user_points<5000){points_needed=5000-user_points}else{if(user_points>4999&&user_points<25000){points_needed=25000-user_points}else{if(user_points>24999&&user_points<250000){points_needed=250000-user_points}}}}return points_needed}(user)),badge:(function(user){var badges=[];if(user&&user.rewardpoint&&user.rewardpoint.userbadges&&user.rewardpoint.userbadges.activityBadge){var activityBadge=user.rewardpoint.userbadges.activityBadge;
if(!is.array(activityBadge)){activityBadge=[activityBadge]}for(var d=0;d<activityBadge.length;d++){var badge=activityBadge[d].currentBadge;badges.push({name:badge.bname,count:badge.level,image:badge.bimg,desc:badge.desc,levelDesc:util.decodeHTML(badge.levelDesc)})}}return badges.length>0?badges:null}(user))}};commentsResult.push(comment);if(cmt.CHILD){for(var cmtChild in cmt.CHILD){tthis.parseComment(cmt.CHILD[cmtChild],commentsResult,level+1)}}};times_comments.prototype._loadCommentMytimes=function(commentType,callback,curpg){var tthis=this;
var config=tthis.config;tthis.loading();logger.log("loading comments: "+config.msid);api.api(commentType,{msid:config.msid,pagenum:curpg||1},function(comments_data){logger.log("loaded comments: "+config.msid);var commentsData=comments_data;if(!commentsData||commentsData.length==0){tthis.loadedAll();callback([]);return null}tthis.flagData=commentsData[0];var commentCount={total:commentsData[0].totalcount,newest:commentsData[0].totalcount,oldest:commentsData[0].totalcount,recommended:commentsData[0].totalcount,discussed:commentsData[0].totalcount,disagree:commentsData[0].totalcount,agree:commentsData[0].totalcount};
var commentPageCount={comments:Math.ceil(commentCount.newest/config.comment_block_count),comments_oldest:Math.ceil(commentCount.oldest/config.comment_block_count),comments_recommended:Math.ceil(commentCount.recommended/config.comment_block_count),comments_discussed:Math.ceil(commentCount.discussed/config.comment_block_count),comments_disagree:Math.ceil(commentCount.disagree/config.comment_block_count),comments_agree:Math.ceil(commentCount.agree/config.comment_block_count)};var commentsResult=[];for(var c=1;
c<commentsData.length;c++){var cmt=commentsData[c];var reason=null;if(cmt.DLT==1){reason="DLT fail"}else{if(is.empty(cmt.C_T)){reason="Blank fail"}}if(reason){logger.log("Not Parsed "+reason+" comment "+c)}else{tthis.parseComment(cmt,commentsResult);logger.log("Parsed comment "+c)}}tthis.countPresent=commentsData[0].countPresent||false;tthis.comments=tthis.comments.concat(commentsResult);logger.log("rendering  "+commentsResult.length+" comments");callback(commentsResult,commentCount);logger.log("rendered "+commentsResult.length+" comments");
tthis.loaded();var curpgn=curpg||1;if(tthis.config.loadonscroll==false&&!commentsResult||!(curpgn<commentPageCount[tthis.config.commentType])){tthis.loadedAll()}else{if(tthis.config.loadonscroll==true&&!commentsResult||commentsResult.length==0){tthis.loadedAll()}}});return null};function replaceAll(find,replace,str){return str.replace(new RegExp(find,"g"),replace)}var domain="https://jcmsdev.indiatimes.com";var getUsers=function(data){var ssoids={};for(var i=0;i<data.length;i++){ssoids[(data[i].roaltdetails.fromaddress)]={}
}return ssoids};times_comments.prototype.postToSocial=function(message,sites,closeCallback){var tthis=this;var domainOnly=util.getDomainOnly();var user=login.getUser();window.newShare=true;window.newShareData={sites:sites,message:message,link:window.facebooklink||page.getMeta("og:url"),title:window.facebookktitle||page.getMeta("og:title"),domain:window.location.host,picture:window.fb_Img||page.getMeta("og:image"),desc:window.facebooksyn||page.getMeta("og:description"),facebook:user?user.facebook:null,twitter:user?user.twitter:null};
if(-1!=window.newShareData.sites.indexOf("facebook")){if(typeof FB=="undefined"){require(["tiljs/social/facebook","tiljs/event"],function(facebook,event){facebook.init({init:true,parse:true});event.subscribe("FB.onload",function(data){tthis.postToFB(window.newShareData)})})}else{tthis.postToFB(window.newShareData)}sites=sites.replace(/facebook,|facebook/g,"");window.newShareData.sites=sites}if(!sites.length){return true}var url=tthis.config.share_url+"?sites="+sites;var socialPost=ui.window(url,{width:600,height:230,name:"socialPost",closeCallback:closeCallback});
if(socialPost){try{socialPost.moveTo(250,240)}catch(e){logger.log("Handled IE Exception.");logger.error(e)}}else{logger.error("Popups are blocked. Please enable them.")}};times_comments.prototype.postToFB=function(data){FB.ui({method:"feed",message:data.message,name:data.title,link:data.link,picture:data.picture,caption:data.domain,description:data.desc})};times_comments.prototype.postToTwitter=function(message,closeCallback){var domainOnly=util.getDomainOnly();if(message.length>100){message=message.substring(0,99)+"..."
}window.log=window.log||function(){};window.popupblocked=0;cookie.remove("fbcheck","/",domainOnly);cookie.remove("twtcheck","/",domainOnly);cookie.set("twtcheck","1",1,"/",domainOnly);cookie.set("usercomt",message,1,"/",domainOnly);var url="/stgredirectpagetest.cms";var twitterPost=ui.window(url,{width:600,height:230,name:"twitterPost",closeCallback:closeCallback});if(twitterPost){twitterPost.moveTo(250,240)}else{window.popupblocked=1;if(is.desktop()){twitterPost=ui.iframe(url,{width:575,height:314,name:"twitterPost",closeCallback:closeCallback})
}else{alert("Popups are blocked. Please enable them.")}}};times_comments.prototype.postToFacebook=function(message,closeCallback){var domainOnly=util.getDomainOnly();var tthis=this;if(window.localStorage){localStorage.setItem("usercomt",message)}window.log=window.log||function(){};window.popupblocked=0;cookie.remove("fbcheck","/",domainOnly);cookie.remove("twtcheck","/",domainOnly);cookie.set("fbcheck","1",1,"/",domainOnly);cookie.set("usercomt",message,1,"/",domainOnly);var url="/stgredirectpagetest.cms";
var facebookPost=ui.window(url,{width:600,height:230,name:"facebookPost",closeCallback:closeCallback});if(facebookPost){facebookPost.moveTo(250,240)}else{window.popupblocked=1;if(is.desktop()){facebookPost=ui.iframe(url,{width:575,height:314,name:"facebookPost",closeCallback:closeCallback})}else{alert("Popups are blocked. Please enable them.")}}};times_comments.prototype.attachOpinionAction=function(){logger.log("Attaching Opinion Action");var tthis=this;var opinions=this.config.opinions;for(var o=0;
o<opinions.length;o++){var opinion=opinions[o];(function(opinion){$(tthis.config.wrapper).off("click","[data-action='comment-"+opinion.id+"']");$(tthis.config.wrapper).on("click","[data-action='comment-"+opinion.id+"']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;var opinionid=parent.attr("data-id");(function(tthis,parent,opinion,ref){tthis["rate"+opinion.name](opinionid,function(errMsg){if(errMsg){tthis.error(errMsg,ref["comment-error-outer"])}else{tthis.error("",ref["comment-error-outer"]);
var count_ele=parent.find("[data-plugin='comment-"+opinion.id+"-count']");var currentCount=parseInt(count_ele.text(),10);$(count_ele).text(++currentCount)}},ref)}(tthis,parent,opinion,ref));event.publish("comment.opinion",opinion.id);return false})}(opinion))}$(tthis.config.wrapper).find('[data-plugin="comment-input"]').off("focus");$(tthis.config.wrapper).find('[data-plugin="comment-input"]').on("focus",function(){var ref=ui.getActionReferences(this,tthis.config.comment);if(ref["comment-form"]&&!ref["comment-form"].hasClass("full")){ref["comment-form"].addClass("full")
}else{if(ref["comment-reply"]&&!ref["comment-reply"].hasClass("full")){ref["comment-reply"].addClass("full")}}setcaptcha(ref)});$(tthis.config.wrapper).off("focus","[data-plugin='get-user-name']");$(tthis.config.wrapper).on("focus","[data-plugin='get-user-name']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);if(ref["comment-form-login"]){ref["comment-form-login"].removeClass("noreg");setcaptcha(ref)}});$(tthis.config.wrapper).on("mouseover",".badges .more-btn",function(event){var elemTop=$(event.target).closest(".comment-box").position().top+$(event.target).closest(".comment-box").closest(".comment-box").height(),elemH=$(event.target).find(".popup_badge").height(),wH=$(window).height(),commentScrollPos=0;
$(event.target).find(".popup_badge").removeClass("popup_above");if(((elemTop-commentScrollPos)+elemH)>wH){$(event.target).find(".popup_badge").addClass("popup_above")}$(event.target).find(".popup_badge").show()});$(tthis.config.wrapper).on("mouseout",".badges .more-btn",function(event){$(event.target).find(".popup_badge").hide()});function setcaptcha(ref){var $set_user_captcha=ref["set-user-captcha"];if($set_user_captcha.text().length==0){$set_user_captcha.text(Math.floor((Math.random()*10))+"+"+Math.floor((Math.random()*10))+"=")
}}$(tthis.config.wrapper).off("click","[data-action='offensive_popup_submit']");$(tthis.config.wrapper).on("click","[data-action='offensive_popup_submit']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var opinionid=ref.parent.attr("data-id");var reason=null;reason=ref.offensive_popup.find("input:checked").val();if(!reason){tthis.error(tthis.config.messages.offensive_reason,ref["comment-offensive-error"])}else{if(reason=="Others"){var reasonVal=ref.offensive_popup_reason.val().trim();
if(!reasonVal||reasonVal==""){tthis.error(tthis.config.messages.offensive_reason_text,ref["comment-offensive-error"]);reason=null}else{if(reasonVal.length>200){tthis.error(tthis.config.messages.offensive_reason_text_limit,ref["comment-offensive-error"]);reason=null}else{reason="Others: "+reasonVal}}}}if(reason){tthis.rate(opinionid,CONSTANT.RATE_TYPE.OFFENSIVE,0,function(error,resp){if(error){tthis.error(error,ref["comment-offensive-error"])}else{if(!error&&ref.parent){ref.offensive_popup.addClass("submitted")
}}},ref,reason)}});$(tthis.config.wrapper).off("click","[data-action='offensive_popup_close']");$(tthis.config.wrapper).on("click","[data-action='offensive_popup_close']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);if(ref.offensive_popup&&ref.offensive_popup.hasClass("submitted")){ref.parent.find("[data-action='comment-offensive-already']").show();ref.parent.find("[data-action='comment-offensive']").hide()}ref.offensive_popup.hide();return false})};times_comments.prototype.attachReplyAction=function(){logger.log("Attaching Reply Action");
var tthis=this;$(tthis.config.wrapper).off("click","[data-action='all_responses']");$(tthis.config.wrapper).on("click","[data-action='all_responses']",function(){var tc_level=$(this).data("level"),tc_next=$(this).next();while(tc_next.data("level")!=tc_level){tc_next.slideDown();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break}}$(this).remove()});$(tthis.config.wrapper).off("click","[data-action='more-response-length']");$(tthis.config.wrapper).on("click","[data-action='more-response-length']",function(){$(this).parent().hide();
$(this).parent().next().show();event.publish("comment.readmore")});$(tthis.config.wrapper).off("click","[data-action='comment-reply']");$(tthis.config.wrapper).on("click","[data-action='comment-reply']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;if(ref["comment-reply"]){ref["comment-reply"].show();if(is.defined(tthis.config.rating)&&tthis.config.rating){if(userInfo.userRating!=null&&userInfo.userRating!=undefined&&userInfo.userRating!=""){$(tthis.config.wrapper+" [data-plugin='comment-rating']").val($(tthis.config.wrapper+" [data-plugin='rating-list'] [data-plugin='rating-vaue'][val="+userInfo.userRating+"]").html())
}}}else{var commentForm=$(tthis.config.wrapper+" [data-plugin='comment-form']");var commentFormHTML=$("<div>"+commentForm.html()+"</div>");commentFormHTML.find("[data-clear='true']").remove();var tmpl=$.templates("<div class='"+commentForm.attr("class")+" reply full' data-plugin='comment-reply'>"+commentFormHTML.html()+"</div>");parent.append(tmpl.render([{}]));if(is.defined(tthis.config.rating)&&tthis.config.rating){if(userInfo.userRating!=null&&userInfo.userRating!=undefined&&userInfo.userRating!=""){$(tthis.config.wrapper+" [data-plugin='comment-rating']").val($(tthis.config.wrapper+" [data-plugin='rating-list'] [data-plugin='rating-vaue'][val="+userInfo.userRating+"]").html())
}}}ref=ui.getActionReferences(this,tthis.config.comment);tthis.error("",ref["comment-error"]);$("[placeholder]").blur();return false});$(tthis.config.wrapper).off("click","[data-action='toggle_replies']");$(tthis.config.wrapper).on("click","[data-action='toggle_replies']",function(){var t=$(this);var tc=t.closest(".comment-box");var tc_level=tc.data("level");var tc_next=tc.next();var tstatus=t.attr("data-togglereplies");if(is.numberOnly(tc_next.data("level"))&&tstatus=="show"){event.publish("comment.togglereplies","Show");
t.attr("data-togglereplies","hide");var response_cnt=0;while(tc_next.data("level")!=tc_level){if(response_cnt==3){tc_next.before('<div class="show_all_responses comment-box level'+(tc_level+1)+'" data-level='+tc_level+' data-action="all_responses"> Show all responses </div>');break}else{tc_next.slideDown();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break}}response_cnt++}}else{event.publish("comment.togglereplies","Hide");t.attr("data-togglereplies","show");$(".show_all_responses").remove();
while(tc_next.data("level")!=tc_level){tc_next.slideUp();tc_next=tc_next.next();if(!is.numberOnly(tc_next.data("level"))){break}}}});$(tthis.config.wrapper).off("click",".loadmore");$(tthis.config.wrapper).on("click",".loadmore",function(){$(this).remove();if(tthis.config.loadonscroll==false){tthis.loadComment(tthis.config.commentType,function(data){},true,++tthis.pageCount)}});$(tthis.config.wrapper).find('[data-plugin="comment-input"]').off("keyup");$(tthis.config.wrapper).find('[data-plugin="comment-input"]').on("keyup",function(e){if(e.keyCode===27){var ref=ui.getActionReferences(this,tthis.config.comment);
ref["comment-input"].val("");ref["comment-reply"].hide()}});ui.maxlength("[data-plugin='comment-input']",tthis.config.maxchar,function(remainingChar,messageLength){var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;var charsrem=ref["comment-input-remaining"];charsrem.text(remainingChar>=0?remainingChar:0);if(tthis.config.messages.maxlength&&messageLength>tthis.config.maxchar){tthis.error(tthis.config.messages.maxlength,ref["comment-error"])}else{tthis.error("",ref["comment-error"])
}},tthis.config.wrapper);$(tthis.config.wrapper).off("click","[data-action='comment-close']");$(tthis.config.wrapper).on("click","[data-action='comment-close']",function(){var ref=ui.getActionReferences(this,tthis.config.comment);var reply=ref["comment-reply"];var input=ref["comment-input"];input.val("");reply.hide();tthis.error("",ref["comment-error"]);return false});tthis.onLoaded(function(tthis){tthis.updateCachedRating();var user=login.getUser();if(tthis.followee){tthis.markFollowingAll()}else{if(user){mytimes.getFollowee(function(data){tthis.followee=data;
tthis.markFollowingAll()})}}lazy.load();dynamic.uptime()});$(tthis.config.wrapper).off("click","[data-plugin='comment-user-follow']");$(tthis.config.wrapper).on("click","[data-plugin='comment-user-follow']",function(){var currentEle=$(this);var currentUser=login.getUser();var ref=ui.getActionReferences(this,tthis.config.comment);var userId=ref.parent.attr("data-userid");var userName=ref.parent.attr("data-user");if(currentUser&&currentUser.getId()!=userId){(function(userId,userName){mytimes.followUser(userId,function(dataa){tthis.followee=tthis.followee||[];
var currFollowee={_id:userId,F_N:userName};tthis.followee.push(currFollowee);tthis.markFollowingId(currFollowee)})}(userId,userName))}else{logger.warn("Cannot follow self.")}});$(tthis.config.wrapper).off("click","[data-plugin='comment-post'],[data-plugin='comment-facebook-post'],[data-plugin='comment-twitter-post'],[data-plugin='comment-google-post'],[data-plugin='comment-email-post']");$(tthis.config.wrapper).on("click","[data-plugin='comment-post'],[data-plugin='comment-facebook-post'],[data-plugin='comment-twitter-post'],[data-plugin='comment-google-post'],[data-plugin='comment-email-post']",function(){event.publish("comment.post.start");
var ref=ui.getActionReferences(this,tthis.config.comment);var parent=ref.parent;var reply=ref["comment-reply"];var errorElement=ref["comment-error"];var reply_input=ref["comment-input"];var parentid=parent.attr("data-id");var parentlevel=parent.attr("data-level");var rootid=parent.attr("data-id");var rootlevel=parent.attr("data-level");var preventInfinite=10;var prevParent=parent;while(rootlevel>1&&--preventInfinite>0){prevParent=prevParent.prev();if(prevParent.attr("data-plugin")==="comment"){rootid=prevParent.attr("data-id");
rootlevel=prevParent.attr("data-level")}else{break}}tthis.error("",errorElement);var val=(reply_input.val()===reply_input.attr("placeholder"))?"":reply_input.val().trim();var _post_button_clicked=($(this).attr("data-plugin")=="comment-post")?true:false;if(val){if(!login.getUser()&&default_config.isEUuser==true&&_post_button_clicked){event.publish("comment_error",tthis.config.messages.loginreq);$(tthis.config.wrapper+" [data-plugin='comment-error']").text(tthis.config.messages.loginreq)}else{tthis.add(val,parentid,rootid,rootlevel,function(commentObj,errMsg){tthis.renderComment(commentObj,errMsg);
event.publish("comment.post.end")},false,this)}}else{event.publish("comment_error",tthis.config.messages.blank);$(tthis.config.wrapper+" [data-plugin='comment-error']").text(tthis.config.messages.blank)}return false})};times_comments.prototype.markFollowingAll=function(){var tthis=this;var followees=tthis.followee;var comments=$(tthis.config.wrapper);var user=login.getUser();if(user){logger.info("Showing follow links");comments.find("[data-plugin='comment-user-follow_wrapper']").show();comments.find("[data-plugin='comment'][data-userid ='"+user.getId()+"'] [data-plugin='comment-user-follow_wrapper']").hide();
util.each(followees,function(i,followee){tthis.markFollowingId(followee)})}else{comments.find("[data-plugin='comment-user-follow_wrapper']").hide();logger.info("Follow links : Not logged in.")}};times_comments.prototype.markFollowingId=function(followee){var tthis=this;var user=login.getUser();var comments=$(tthis.config.wrapper);if(user){var foloweeEle=comments.find("[data-userid='"+followee._id+"'] .follow");if(foloweeEle&&foloweeEle.length>0){logger.info("Mark Following : "+user.getFullName()+"("+user.getId()+") >> "+followee.F_N+"("+followee._id+")");
tthis.markFollowing(foloweeEle)}else{logger.info("Mark Following : "+user.getFullName()+"("+user.getId()+") >> "+followee.F_N+"("+followee._id+")  - NA")}}else{logger.info("Follow link : Not logged in.")}};times_comments.prototype.markFollowing=function(currentEle){if(currentEle&&currentEle.length>0){currentEle.html("<span class='divider'></span><i class='icon-follow'></i>Following");currentEle.removeClass("follow");currentEle.addClass("following");currentEle.removeAttr("data-plugin");currentEle.attr("title",currentEle.attr("title").replace("Follow","Following"))
}};times_comments.prototype.onLoaded=function(callback){event.subscribe("comments.loaded",callback)};var savedComment=null;times_comments.prototype.saveComment=function(comment){savedComment=comment;cookie.set("comment"+window.msid,json.stringify(comment),1,document.location.pathname)};times_comments.prototype.getSavedComment=function(){var commentCookie=cookie.get("comment"+window.msid);if(is.defined(commentCookie)){return json.parse(commentCookie)}else{if(savedComment){return savedComment}else{return null
}}};times_comments.prototype.removeSavedComment=function(){savedComment=null;return cookie.remove("comment"+window.msid,document.location.pathname)};times_comments.prototype.loadSavedComment=function(){var tthis=this;var user=login.getUser();var savedComment=tthis.getSavedComment();if(savedComment){if(user){if(!tthis.config.rating||savedComment.urs!=""){savedComment.urs=tthis.config.rating?$.trim(savedComment.urs):"";logger.log("Has saved comment and user is logged in.");logger.log(savedComment);
tthis.attachUserToComment(savedComment,user);tthis.removeSavedComment();tthis.post(savedComment,function(savedComment,errMsg){tthis.renderComment(savedComment,errMsg)})}}else{logger.log("Saved comment but user not logged in")}}else{logger.log("No Saved comment.")}};times_comments.prototype.verifyEmailComment=function(){var url_params=util.getParam();var tthis=this;tthis.verify(function(commentObj,errMsg){if(is.object(commentObj)){tthis.renderComment(commentObj,errMsg,true);$(tthis.config.wrapper+" [data-plugin='comment-verified-msg']").show();
tthis.removeSavedComment()}})};times_comments.prototype.saveRatingValidation=function(opinionid,typeid,rateid,val,ref){logger.log("Save Rating: "+this.config.commentType+":"+opinionid);var user=login.getUser();var userId=user?user.getId():0;var rating=["rateV",opinionid,typeid,rateid];localstoragec.set(rating.join(":"),val||"1",1,"/")};times_comments.prototype.getSavedRatingValidation=function(opinionid,typeid,rateid,ref){var user=login.getUser();var userId=user?user.getId():0;var rating=["rateV",opinionid,typeid,rateid];
var commentCookie=localstoragec.csget(rating.join(":"));if(is.defined(commentCookie)){return commentCookie}else{return null}};times_comments.prototype.updateCachedRating=function(){var tthis=this;var cookies=cookie.getAll();var comments=$(tthis.config.wrapper+" #"+this.config.commentType);util.each(cookies,function(key,value){if(key.indexOf("rateV")===0){logger.log("Updating Rating from cookie: "+key);var keyArr=key.split(":");var rating={opinionid:parseInt(keyArr[1],10),typeid:parseInt(keyArr[2],10),rateid:parseInt(keyArr[3],10),commentType:tthis.config.commentType};
var eleType="";switch(rating.typeid){case CONSTANT.RATE_TYPE.AGREE:eleType="comment-agree-count";break;case CONSTANT.RATE_TYPE.DISAGREE:eleType="comment-disagree-count";break}if(eleType!=""){var commentRateCount=comments.find("[data-id='"+rating.opinionid+"']  [data-plugin='"+eleType+"']");var val=parseInt(commentRateCount.text(),10);var cookieVal=parseInt(cookie.get(key),10);if(cookieVal>val){commentRateCount.text(cookieVal);logger.log("Updated Rating from cookie: "+key+" : "+val+" updated to "+cookieVal)
}else{logger.log(key+" Already Updated")}}}})};times_comments.prototype.validateRating=function(opinionid,typeid,rateid,ref,callback){logger.log("Validate Rating: "+opinionid);var config=this.config;var user=login.getUser();var savedRating=this.getSavedRatingValidation(opinionid,typeid,rateid,ref);if(ref){if(user&&ref.parent&&ref.parent.attr("data-userid")==user.getId()){switch(typeid){case CONSTANT.RATE_TYPE.AGREE:callback(config.messages.self_agree);break;case CONSTANT.RATE_TYPE.DISAGREE:callback(config.messages.self_disagree);
break;case CONSTANT.RATE_TYPE.RECOMMEND:callback(config.messages.self_recommend);break;case CONSTANT.RATE_TYPE.OFFENSIVE:callback(config.messages.self_offensive);break}}else{if(savedRating&&savedRating>0){switch(typeid){case CONSTANT.RATE_TYPE.AGREE:callback(config.messages.already_agree);break;case CONSTANT.RATE_TYPE.DISAGREE:callback(config.messages.already_disagree);break;case CONSTANT.RATE_TYPE.RECOMMEND:callback(config.messages.already_recommended);break;case CONSTANT.RATE_TYPE.OFFENSIVE:callback(config.messages.already_offensive);
break}}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.AGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.DISAGREE){callback(config.messages.cant_agree_disagree)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.DISAGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.AGREE){callback(config.messages.cant_agree_disagree)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.AGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.OFFENSIVE){callback(config.messages.cant_agree_offensive)
}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.OFFENSIVE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.AGREE){callback(config.messages.cant_agree_offensive)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.DISAGREE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.RECOMMEND){callback(config.messages.cant_disagree_recommend)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.RECOMMEND,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.DISAGREE){callback(config.messages.cant_disagree_recommend)
}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.OFFENSIVE,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.RECOMMEND){callback(config.messages.cant_recommend_offensive)}else{if(this.getSavedRatingValidation(opinionid,CONSTANT.RATE_TYPE.RECOMMEND,rateid,ref)&&typeid==CONSTANT.RATE_TYPE.OFFENSIVE){callback(config.messages.cant_recommend_offensive)}else{callback()}}}}}}}}}}}else{logger.error("Cannot validate rating. 'ref' is undefined.")}};times_comments.prototype.validateComment=function(commentObj,callback,ref){event.publish("comment.post.validating");
var comment=commentObj.comment;var config=this.config;logger.info("Validating Comment: "+comment);commentObj.urs=(commentObj.urs==="")?undefined:commentObj.urs;if(is.empty(comment)){callback(config.messages.blank)}else{if(is.url(comment)){callback(config.messages.has_url)}else{if(comment.length<config.validation.minlength){callback(config.messages.minlength)}else{if(is.defined(this.config.rating)&&this.config.rating&&(!is.defined(commentObj.urs))){callback(config.messages.ratemendate)}else{var msgObj=this.commentObjToMsgObj(commentObj);
msgObj.message=msgObj.message.toLowerCase();api.validateComment(msgObj,function(response){if(response==="duplicatecontent"){event.publish("comment.post.validation.failed",response);callback(config.messages.duplicate)}else{if(response==="abusivecontent"){event.publish("comment.post.validation.failed",response);callback(config.messages.abusive)}else{event.publish("comment.post.validated");callback()}}})}}}}};times_comments.prototype.add=function(msg,parentId,rootId,level,callback,cnsl,currentEle){logger.info("Adding Comment: "+msg);
var tthis=this;$(tthis.config.wrapper+" [data-plugin='comment-verified-msg']").hide();var config=this.getConfig();var user=login.getUser();var ref=ui.getActionReferences(currentEle,tthis.config.comment);var commentObj={index:-1,id:-1,comment:msg.trim(),level:level||1,parentId:parentId||0,rootId:rootId||0,parentuid:ref.parent?ref.parent.attr("data-id"):null,parentusername:ref.parent?ref.parent.attr("data-user"):null,type:currentEle?$(currentEle).attr("data-plugin"):"comment-post",time:new Date().getTime(),configid:"41083278",url:window.location.href.split("?")[0].split("#")[0],rotype:typeof tthis.config.rotype=="undefined"?0:tthis.config.rotype,urs:typeof userInfo==="object"?userInfo.userRating:""};
var facebookCheckbox=ref["comment-facebook"];var twitterCheckbox=ref["comment-twitter"];commentObj.social=[];if(facebookCheckbox&&facebookCheckbox.is(":checked")){commentObj.social.push("facebook")}if(twitterCheckbox&&twitterCheckbox.is(":checked")){commentObj.social.push("twitter")}if(!user){var cmtUser=(commentObj.type=="comment-post"?this.getCommentUser(ref):null);if(is.object(cmtUser)){user=cmtUser}else{if(cmtUser){return}}}if(user){tthis.attachUserToComment(commentObj,user);if(cnsl===true){if(callback){callback(commentObj)
}}else{tthis.post(commentObj,callback)}}else{switch(commentObj.type){case"comment-facebook-post":tthis.commentOnFacebook(commentObj,ref);break;case"comment-google-post":tthis.commentOnGoogle(commentObj,ref);break;case"comment-twitter-post":tthis.commentOnTwitter(commentObj,ref);break;case"comment-email-post":tthis.commentUsingEmail(commentObj,ref);break;default:tthis.commentWithoutLogin(commentObj,ref);break}}};times_comments.prototype.getCommentUser=function(ref){var config=this.config;var $get_user_name=ref["get-user-name"];
var $get_user_email=ref["get-user-email"];var $get_user_location=ref["get-user-location"];var $set_user_captcha=ref["set-user-captcha"];var $get_user_captcha=ref["get-user-captcha"];if($get_user_name&&$get_user_email&&$get_user_name.length>0&&$get_user_email.length>0){var user={};user.name=$get_user_name.val().trim();user.email=$get_user_email.val().trim();if($get_user_location&&$get_user_location.length>0){user.location=$get_user_location.val().trim()}if(user.name.length==0||user.name==$get_user_name.attr("placeholder")){this.error(config.messages.name_required,ref["comment-error"]);
return true}if(user.name.length>30){this.error(config.messages.name_toolong,ref["comment-error"]);return true}if(!is.alphaOnly(user.name)){this.error(config.messages.name_not_string,ref["comment-error"]);return true}if(user.email.trim().length==0||user.email==$get_user_email.attr("placeholder")){this.error(config.messages.email_required,ref["comment-error"]);return true}if(!is.email(user.email.trim())){this.error(config.messages.email_invalid,ref["comment-error"]);return true}if($get_user_location&&$get_user_location.length>0){if(user.location.length==0||user.location==$get_user_location.attr("placeholder")){this.error(config.messages.location_required,ref["comment-error"]);
return true}if(user.location.length>30){this.error(config.messages.location_toolong,ref["comment-error"]);return true}if(!is.alphaOnly(user.location)){this.error(config.messages.location_not_string,ref["comment-error"]);return true}}if($get_user_captcha&&$get_user_captcha.val().trim().length==0){this.error(config.messages.captcha_required,ref["comment-error"]);return true}if($get_user_captcha&&$get_user_captcha.val().trim().length>4){this.error(config.messages.captcha_toolong,ref["comment-error"]);
return true}if($get_user_captcha&&!is.numberOnly($get_user_captcha.val().trim())){this.error(config.messages.captcha_number_only,ref["comment-error"]);return true}if($set_user_captcha&&$get_user_captcha&&!eval($set_user_captcha.text()+"="+$get_user_captcha.val())){this.error(config.messages.captcha_invalid,ref["comment-error"]);return true}return userClass.getNewUser(user,{id:"id",username:"username",thumb:"thumb",email:"email",name:"name",fullName:"name",CITY:"location"})}};times_comments.prototype.commentOnFacebook=function(commentObj,ref){var tthis=this;
var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkepfbtart","1",1,"/",domainOnly);cookie.set("clickkepfbtart"+window.msid,window.msid,1,"/",domainOnly);login.loginWithFacebook(function(){var _gdpr=cookie.get("gdpr");if(!!_gdpr&&_gdpr=="1#1#0"&&_gdpr=="1#1#1"){tthis.loadSavedComment()}})};times_comments.prototype.commentOnGoogle=function(commentObj,ref){var tthis=this;tthis.saveComment(commentObj);login.loginWithGoogle(function(){var _gdpr=cookie.get("gdpr");if(!!_gdpr&&_gdpr=="1#1#0"&&_gdpr=="1#1#1"){tthis.loadSavedComment()
}})};times_comments.prototype.commentOnTwitter=function(commentObj,ref){var tthis=this;var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkeptwtart","1",1,"/",domainOnly);cookie.set("clickkeptwtart"+window.msid,window.msid,1,"/",domainOnly);login.loginWithTwitter(function(){var _gdpr=cookie.get("gdpr");if(!!_gdpr&&_gdpr=="1#1#0"&&_gdpr=="1#1#1"){tthis.loadSavedComment()}})};times_comments.prototype.commentUsingEmail=function(commentObj,ref){var tthis=this;var domainOnly=util.getDomainOnly();
tthis.saveComment(commentObj);cookie.set("clickkepssoart","1",1,"/",domainOnly);cookie.set("clickkepssoart"+window.msid,window.msid,1,"/",domainOnly);login.login(function(){var _gdpr=cookie.get("gdpr");if(!!_gdpr&&_gdpr=="1#1#0"&&_gdpr=="1#1#1"){tthis.loadSavedComment()}})};times_comments.prototype.commentWithoutLogin=function(commentObj,ref){var tthis=this;var domainOnly=util.getDomainOnly();tthis.saveComment(commentObj);cookie.set("clickkepssoart","1",1,"/",domainOnly);cookie.set("clickkepssoart"+window.msid,window.msid,1,"/",domainOnly);
login.login(function(){if(!(tthis.config.rating)){tthis.loadSavedComment()}})};times_comments.prototype.verify=function(callback,ref){var tthis=this;var url=tthis.config.verify_comment_url;var msgObj={msid:window.msid,cmtid:null,r:null};var url_params=util.getParam();if(window.messageid&&window.param_r){msgObj.cmtid=window.messageid;msgObj.r=window.param_r}else{msgObj.cmtid=url_params.messageid;msgObj.r=url_params.r}if(msgObj.msid&&msgObj.cmtid&&msgObj.r){logger.info("Verifying Comment.");ajax.get(url,msgObj,function(response){if(response.cmtverified.commentbyid&&response.cmtverified.commentbyid.roaltdetails){var cmt=response.cmtverified.commentbyid;
cmt.roaltdetails=cmt.roaltdetails.roaltdetails;var commentObj={index:-1,id:-1,comment:is.string(cmt.message)?$("<div/>").text(cmt.message).html():"",level:1,parentuid:cmt.parentuid,parentusername:cmt.parentusername,abstime:msgObj.r?util.getDate(msgObj.r).getTime():"",time:msgObj.r,type:"comment-post",user:{name:cmt.roaltdetails.fromname,location:cmt.roaltdetails.location}};if(callback){callback(commentObj)}}else{if(callback){callback(null,{})}}})}if(url_params.register==="1"){logger.info("Display register window.");
if(!login.getUser()){login.login()}}};times_comments.prototype.post=function(commentObj,callback,ref){var tthis=this;if(!is.empty(commentObj.social)){if(is.defined(tthis.config.rating)&&tthis.config.rating){if(is.defined(tthis.config.moviename)&&tthis.config.moviename){var socialtext="Movie: "+tthis.config.moviename+", My Rating "+(commentObj.urs/2)+"/5. "+commentObj.comment;tthis.postToSocial(socialtext,commentObj.social.join(","))}else{if(is.defined(tthis.config.techprdtname)&&tthis.config.techprdtname){var socialtext=tthis.config.techprdtname+" : My Rating "+(commentObj.urs/2)+"/5, "+commentObj.comment;
tthis.postToSocial(socialtext,commentObj.social.join(","))}}}else{tthis.postToSocial(commentObj.comment,commentObj.social.join(","))}}tthis.validateComment(commentObj,function(error){if(!is.empty(error)){if(callback){callback(commentObj,error)}return}event.publish("comment.post.posting");logger.info("Posting Comment:"+commentObj.comment);var msgObj=tthis.commentObjToMsgObj(commentObj);msgObj.pcode=page.getChannel();if(tthis.config.sendCommentLiveEmail===false){msgObj.verifyuser=1;api.postCommentWithoutVerification(msgObj,function(response){event.publish("comment.post.posted");
if(callback){callback(commentObj)}})}else{if(tthis.config.enableparam&&msgObj.rotype!=0){msgObj.url=msgObj.url+"?"+window.location.search.replace("?","").split("&")[0]+"&";msgObj.configid="46516605"}else{if(msgObj.rotype!=0){msgObj.url=msgObj.url+"?"}}api.postComment(msgObj,function(response){event.publish("comment.post.posted");if(callback){callback(commentObj)}})}},ref)};times_comments.prototype.commentObjToMsgObj=function(commentObj){var config=this.config;var msgObj={fromname:commentObj.user?commentObj.user.name:null,fromaddress:commentObj.user?commentObj.user.email:null,userid:commentObj.user?(commentObj.user.id?commentObj.user.uid:"qrst"):"qrst",location:commentObj.user?commentObj.user.location:null,imageurl:commentObj.user?commentObj.user.image:null,loggedstatus:commentObj.user&&commentObj.user.id?1:0,message:commentObj.comment,roaltdetails:1,ArticleID:config.msid,msid:config.msid,parentid:commentObj.parentId,rootid:commentObj.rootId,url:commentObj.url,configid:commentObj.configid,urs:commentObj.urs?commentObj.urs:null,rotype:commentObj.rotype};
if(!commentObj.user.id){msgObj.verifyuser=1}return msgObj};times_comments.prototype.error=function(errMsg,wrapper){if(is.visible(wrapper)){wrapper.text(errMsg)}else{if(!is.empty(errMsg)){alert(errMsg)}}event.publish("comment_error",errMsg)};times_comments.prototype.rateAgree=times_comments.prototype.rateUpVote=function(opinionid,callback,ref){logger.log("Agree Comment: "+opinionid);this.rate(opinionid,CONSTANT.RATE_TYPE.AGREE,0,callback,ref)};times_comments.prototype.rateDisagree=times_comments.prototype.rateDownVote=function(opinionid,callback,ref){logger.log("Disagree Comment: "+opinionid);
this.rate(opinionid,CONSTANT.RATE_TYPE.DISAGREE,0,callback,ref)};times_comments.prototype.rateRecommend=function(opinionid,callback,ref){logger.log("Recommend Comment: "+opinionid);this.rate(opinionid,CONSTANT.RATE_TYPE.RECOMMEND,0,callback,ref)};times_comments.prototype.flag=times_comments.prototype.rateOffensive=function(opinionid,callback,ref,reason){var tthis=this;logger.log("Flag/Offensive Comment: "+opinionid);$(ref.offensive_popup).off("click");$(ref.offensive_popup).on("click",function(){var ref=ui.getActionReferences(this,tthis.config.comment);
var valReason=ref.offensive_popup.find("input:checked").val();if(valReason&&valReason.length>0&&valReason=="Others"){ref.offensive_popup_reason.show()}else{ref.offensive_popup_reason.hide()}tthis.error("",ref["comment-offensive-error"])});event.publish("comment.flag.show",ref.offensive_popup);var elemTop=$(ref.offensive_popup).closest(".comment-box").position().top+$(ref.offensive_popup).closest(".comment-box").closest(".comment-box").height(),elemH=$(ref.offensive_popup).height(),wH=$(window).height(),commentScrollPos=0;
$(ref.offensive_popup).removeClass("popup_above");if(((elemTop-commentScrollPos)+elemH)>wH){$(ref.offensive_popup).addClass("popup_above")}ref.offensive_popup.show();return};times_comments.prototype.showRateOffensiveBox=function(opinionid,callback,ref){};times_comments.prototype.rate=function(opinionid,typeid,rateid,callback,ref,reason){logger.log("Rate Comment: "+opinionid+":"+typeid);var tthis=this;var rating={opinionid:opinionid,typeid:typeid,rateid:rateid||0};if(reason){rating.ofreason=reason
}var user=login.getUser();if(user){logger.log("Rate Comment user is logged in");this.validateRating(opinionid,typeid,rateid,ref,function(error){if(!is.empty(error)){if(callback){callback(error)}return}var val=parseInt(ref["comment-agree-count"].text(),10);tthis.saveRatingValidation(opinionid,typeid,rateid,val+1,ref);api.rateComment(rating,function(resp){if(callback){callback(null,resp)}},user)})}else{logger.log("Rate Comment user is NOT logged in, login prompted.");(function(rating,callback,ref){if(tthis.config.loginRequiredForRating===true){login.login(function(){logger.log("Rate Comment user logged in, continue rating.");
tthis.rate(rating.opinionid,rating.typeid,rating.rateid,callback,ref,rating.reason)},true)}else{logger.log("Rate Comment user NOT logged in, continue rating.");tthis.validateRating(rating.opinionid,rating.typeid,rating.rateid,ref,function(error){if(!is.empty(error)){if(callback){callback(error)}return}var val=parseInt(ref["comment-agree-count"].text(),10);tthis.saveRatingValidation(rating.opinionid,rating.typeid,rating.rateid,val+1,ref);api.rateComment(rating,function(resp){if(callback){callback(null,resp)
}})})}}(rating,callback,ref))}};times_comments.prototype.renderComment=function(commentObj,errMsg,verified){var tthis=this;if(commentObj){var ref=ui.getActionReferences(tthis.config.wrapper+" [data-id='"+commentObj.parentId+"']");var parent=ref.parent;var input=ref["comment-input"];var facebookCheckbox=ref["comment-facebook"];var twitterCheckbox=ref["comment-twitter"];if(errMsg){event.publish("comment.post.error",errMsg);this.error(errMsg,ref["comment-error"])}else{event.publish("comment.post.rendering");
commentObj.comment=$("<div/>").text(commentObj.comment).html();commentObj.user.rate=commentObj.urs;if($(tthis.config.wrapper+" .comment-verification-msg").length){$(tthis.config.wrapper+" .comment-verification-msg").remove()}if(this.isReply(commentObj)){var reply=ref["comment-reply"];if(!is.number(commentObj.level)){commentObj.level=parseInt(commentObj.level,10)}++commentObj.level;if((commentObj&&commentObj.user&&commentObj.user.id)||!ref["set-user-captcha"]){parent.after(this.renderEach(-1,commentObj,true));
reply.hide()}else{parent.after("<div class='comment-box comment-verification-msg'>"+$(tthis.config.wrapper+" [data-plugin='comment-verification-msg']").html()+"</div>");reply.hide()}}else{if((commentObj&&commentObj.user&&commentObj.user.id)||verified==true||!ref["set-user-captcha"]){$(tthis.config.wrapper+" "+this.config.main).prepend(this.renderEach(-1,commentObj,true))}else{$(tthis.config.wrapper+" "+this.config.main).prepend("<div class='comment-box comment-verification-msg'>"+$(tthis.config.wrapper+" [data-plugin='comment-verification-msg']").html()+"</div>")
}}if(input){input.val("");input.keyup();input.focus();if(facebookCheckbox){facebookCheckbox.prop("checked",false)}if(twitterCheckbox){twitterCheckbox.prop("checked",false)}var $get_user_captcha=ref["get-user-captcha"];var $set_user_captcha=ref["set-user-captcha"];if($get_user_captcha){$get_user_captcha.val("")}if($set_user_captcha){$set_user_captcha.text(Math.floor((Math.random()*10))+"+"+Math.floor((Math.random()*10))+"=")}}this.error("",ref["comment-error"])}lazy.load()}else{this.error(errMsg)}};
times_comments.prototype.renderUsingTemplate=function(index,dataOne,tmpl,prepend){return $("#"+tmpl).render(dataOne,{formatNumber:function(val){return util.formatNumber(val)},timeToDate:function(time){return new Date(time)},parseDate:function(time){if(jsonDate!=null){var date=new Date(time);var newDate=$.fullCalendar.formatDate(date,"MMM dd, yyyy");return newDate}}})};times_comments.prototype.isReply=function(cmt){return cmt.parentuid&&cmt.parentusername};times_comments.prototype.loadingDiv=function(text){var tthis=this;
if(text==="Loading..."){$(tthis.config.wrapper+" [data-plugin='comment-loading']").show()}else{$(tthis.config.wrapper+" [data-plugin='comment-loading']").hide()}};return times_comments});define("comments",["tiljs/apps/times/comments","tiljs/login","tiljs/logger","tiljs/event","jquery","tiljs/util","module","tiljs/cookie","tiljs/ui","jsrender"],function(q,n,m,y,t,r,w,x,o,p){var v=q;var u={validation:{minlength:1},messages:{name_required:"Please enter your name.",name_toolong:"Name cannot be longer than 30 chars.",email_required:"Please enter your email address.",email_invalid:"Please enter a valid email address.",minlength:"Whoops! Your review is too short. Please write a review which is at least 140 characters long so that it is helpful for others as well :)",maxlength:"You have entered more than 3000 characters.",blank:"You can't post this review as it is blank.",popup_blocked:"Popup is blocked.",has_url:"You can't post this review as it contains URL.",duplicate:"You can't post this review as it is identical to the previous one.",abusive:"You can't post this review as it contains inappropriate content.",self_agree:"You can't Agree with your own review",self_disagree:"You can't Disagree with your own review",self_recommend:"You can't Recommend your own review",self_offensive:"You can't mark your own review as Offensive",already_agree:"You have already Agreed with this review",already_disagree:"You have already Disagreed with this review",already_recommended:"You have already Recommended this review",already_offensive:"You have already marked this review Offensive",cant_agree_disagree:"You can't Agree and Disagree with the same review",cant_agree_offensive:"You can't Agree and mark the same review Offensive",cant_disagree_recommend:"You can't Disagree and Recommend the same review",cant_recommend_offensive:"You can't Recommend and mark the same review Offensive",permission_facebook:"You can't post to facebook. Post permission is required.",loginreq:"Please login to post your comment"}};
v.config=r.extend(true,{},q.config,u,w.config());return v});define("homepage",["tiljs/cookie","tiljs/load"],function(e,d){var f={};f.init=function(){};return f});define("crwdcnctrl",["tiljs/cookie","tiljs/event"],function(f,i){var h={};var g=function(a){var b=new Date(),d=new Date(a),c=b.getFullYear()-d.getFullYear();var e=b.getMonth()-d.getMonth();if(e<0||(e===0&&b.getDate()<d.getDate())){c--}return c};var j=function(){var b=f.get("MSCSAuthDetail");var a={};a.act=(typeof b!="undefined")?"AM":"";
if(typeof b!="undefined"){a.dob=(b.match("DOB=(.*) ")!=null)?b.match("DOB=(.*) ")[1]:"";a.gender=(b.match("Gender=(.*)~Country")!=null)?b.match("Gender=(.*)~Country")[1]:""}a.age=(a.dob!="")?g(a.dob):"";return a};h.init=function(){var a=j();if(a.gender!=""||a.age!=""){if(typeof _cc2801!="undefined"){_cc2801.add("act",a.act);_cc2801.add("dem","toi.web:gender="+a.gender);_cc2801.add("dem","toi.web:age="+a.age);if(typeof _cc2801.bcp!="undefined"){_cc2801.bcp()}}}};h.init();i.subscribe(["user.login"],function(a){if(typeof h.init=="function"){h.init()
}})});define("tiljs/social/twitter",["../social/social","../ui","../logger","../event","../util","jquery","module"],function(x,n,m,y,p,q,w){var o=new x("twitter","twitter");var t={parse:false,js:"https://platform.twitter.com/widgets.js",js_id:"twitter-wjs",share_url:"https://twitter.com/share",via:null,format:"{{:title}}",sharePageTitle:true};var v=p.extend(true,{},t,w.config());o.setJS(v.js,v.js_id);o.addPlugin({id:"button",js:true,init:function(c,e){var f=q(c);var d=p.data(c);var a={count:"vertical",url:location.href};
var b=p.extend(true,{},a,d);b.url=d.url||d.href||f.attr("href")||b.href;var g=q("<a class='twitter-share-button'></a>");q.each(b,function(i,h){g.attr("data-"+i,h)});f.empty();f.append(g);o.parse(c)}});o.addPlugin({id:"frame",js:true,init:function(d,f){var g=q(d);var e=p.data(d);var a={twtid:"",theme:"light"};var c=p.extend(true,{},a,e);var b="twt-"+c.twtid;if(window.twttr){twttr.widgets.createTweet(c.twtid,document.getElementById(b),{theme:c.theme})}}});o.addPlugin({id:"share",alias:["tweet"],events:{click:function(b){var a=p.data(this);
o.tweet(a.url||q(this).attr("href"),p.format(a.format||v.format,a),a.via||v.via,this)}},init:function(b,a){}});o.tweet=o.share=function(e,b,a,c){b=(typeof b=="string")?b.trim():b;var d={url:o.getAbsoluteUrl(e),text:b||(v.sharePageTitle===true?document.title.split("|")[0]:"")};if(a){d.via=a}o._share(v.share_url,d,{name:"twitter_tweet_dialog",width:500,height:400},c)};o.addPlugin({id:"follow",events:{click:function(a){o.follow(q(this).attr("data-url")||q(this).attr("href"))}},init:function(b,a){}});
o.follow=function(d,a){var c=o.getAbsoluteUrl(d);var b=window.open(d,"_blank");b.focus()};o.addPlugin({id:"login",init:function(b,a){}});var r=null;o.login=function(a,b){};o.addPlugin({id:"logout",init:function(b,a){}});o.parse=function(a){if(typeof twttr!=="undefined"){twttr.widgets.load(a)}else{m.warn("'twttr' is required in parse")}};o.logout=function(a){};o.beforeinit=function(){};o.beforeloadjs=function(){};o.afterloadjs=function(){if(typeof twttr!=="undefined"){m.log("twttr js loaded");var a=["click","tweet","retweet","follow","favorite"];
p.each(a,function(c,b){if(a.hasOwnProperty(b)){twttr.events.bind(b,function(d){return function(e){y.publish("twttr."+d,{intent_event:e})}}(b))}})}else{m.warn("'twttr' is required in afterloadjs")}};var u=null;o.getUser=function(a){};o.onlogin=function(a){};o.onlogout=function(a){};o.init(v);return o});define("tiljs/social/pinterest",["../social/social","../ui","../logger","../event","../util","../load","jquery","module"],function(v,n,l,w,p,m,q,u){var o=new v("pinterest","pinterest");var r={parse:false,js:"//assets.pinterest.com/js/pinit.js",js_id:"pinterest-js",share_url:"//www.pinterest.com/pin/create/button/"};
var t=p.extend(true,{},r,u.config());o.setJS(t.js,t.js_id);o.addPlugin({id:"button",init:function(e,g){var h=q(e);var f=p.data(e);var a={"pin-do":"buttonPin","pin-config":"above"};var c=p.extend(true,{},a,f);c.href=f.url||f.href||h.attr("href")||c.href;var d=q("<a></a>");var b={url:o.getAbsoluteUrl(c.href),media:o.getAbsoluteUrl(c.image),description:c.summary};d.attr("href","https://www.pinterest.com/pin/create/button/?"+q.param(b));q.each(c,function(j,i){d.attr("data-"+j,i)});h.empty();h.append(d);
o.parse(e)}});o.addPlugin({id:"share",alias:["pin"],events:{click:function(a){var b=p.data(this);o.share(b.url||q(this).attr("href"),b.title,b.summary,b.image,this)}},init:function(a,b){}});o.pin=o.share=function(a,c,b,d,e){o._share(t.share_url,{url:o.getAbsoluteUrl(a),description:c,summary:b,media:o.getAbsoluteUrl(d)},{name:"pinterest_pin_dialog",width:700,height:400},e)};o.addPlugin({id:"follow",events:{click:function(a){o.follow(q(this).attr("data-url")||q(this).attr("href"))}},init:function(a,b){}});
o.follow=function(a,b){var d=o.getAbsoluteUrl(a);var c=window.open(a,"_blank");c.focus()};o.parse=function(a){var b=q("#"+t.js_id);b.remove();m.js(t.js,null,t.js_id)};o.init(t);return o});define("tiljs/social/linkedin",["../social/social","../ui","../logger","../event","../util","jquery","module"],function(t,m,k,u,n,o,r){var l=new t("linkedin","linkedin");var p={parse:false,js:"//platform.linkedin.com/in.js",js_id:"linkedin-js",share_url:"https://www.linkedin.com/shareArticle"};var q=n.extend(true,{},p,r.config());
l.setJS(q.js,q.js_id);l.addPlugin({id:"button",js:true,init:function(f,a){var b=o(f);var g=n.data(f);var c={url:location.href,counter:"top"};var d=n.extend(true,{},c,g);d.url=g.url||g.href||b.attr("href")||d.href;var e=o("<script type='IN/Share'><\/script>");o.each(d,function(i,h){e.attr("data-"+i,h)});b.empty();b.append(e);l.parse(f)}});l.addPlugin({id:"share",events:{click:function(a){var b=n.data(this);l.share(b.url||o(this).attr("href"),b.title,b.summary,b.image,this)}},init:function(a,b){}});
l.share=function(b,d,c,e,a){l._share(q.share_url,{url:l.getAbsoluteUrl(b),title:d,summary:c},{name:"linkedin_share_dialog",width:500,height:570},a)};l.parse=function(a){if(typeof IN!=="undefined"){IN.parse(a)}else{k.warn("'IN' is required in parse")}};l.init(q);return l});define("tiljs/social/googleplus",["../social/social","../ui","../logger","module","../event","../util","jquery"],function(t,l,k,r,u,m,o){var p={parse:false,js:"https://apis.google.com/js/plusone.js?onload=attachgoogleevent",js_id:"googleplus-js",share_url:"https://plus.google.com/share"};
var q=m.extend(true,{},p,r.config());var n=new t("googleplus","googleplus");n.setJS(q.js,q.js_id);n.addPlugin({id:"button",js:true,init:function(f,a){var b=o(f);var g=m.data(f);var c={href:location.href,size:"tall",annotation:"bubble",width:null};var d=m.extend(true,{},c,g);d.href=g.url||g.href||b.attr("href")||d.href;var e=o("<div class='g-plusone'></div>");o.each(d,function(i,h){e.attr("data-"+i,h)});b.empty();b.append(e);n.parse(b[0])}});n.addPlugin({id:"share",events:{click:function(a){var b=m.data(this);
n.share(b.url||o(this).attr("href"),b.title,b.summary,b.image,this)}},config:{shareUrl:""},init:function(a,b){}});n.share=function(b,d,c,e,a){n._share(q.share_url,{url:n.getAbsoluteUrl(b)},{name:"googleplus_share_dialog",width:500,height:400,scrollbars:1},a)};n.addPlugin({id:"follow",events:{click:function(a){n.follow(o(this).attr("data-url")||o(this).attr("href"))}},init:function(a,b){}});n.follow=function(b,c){var a=n.getAbsoluteUrl(b);var d=window.open(b,"_blank");d.focus()};n.parse=function(a){if(typeof gapi!=="undefined"){gapi.plusone.go()
}else{k.warn("'gapi' is required in parse")}};n.init(q);return n});define("tiljs/plugin/pre_event",["../event","module","../util","../is"],function(l,n,i,m){var j={};var k={};var h=i.extend(true,{},k,n.config());j.init=function(){if(window.__times){j.process(window.__times)}else{window.__times=[]}window.__times.push=function(a){j.processOne(a);return Array.prototype.push.apply(this,arguments)}};j.process=function(a){i.each(a,function(b,c){j.processOne(c)})};j.processOne=function(e){try{if(m.funct(e)){e()
}else{if(m.array(e)){var d=e[0],a=e[1],b=e.splice(2);require(d)[a].apply(this,b)}else{l.publish("logger.warn","Invali params in __times")}}}catch(c){l.publish("logger.error",c)}};j.init();return j});define("pgtrack",[],function(){var b={};b.evtCap=function(a){try{if(window.event&&window.event.srcElement){var f=3,g=window.event.srcElement;while(f>0&&g!=document.querySelector("body")){if(g.getAttribute("pg")!=null){b.track(b.addUrl(g));break}f--;g=g.parentNode}}else{if(a&&a.stopPropagation&&!window.opera){if(a.target.getAttribute("pg")!=null){b.track(b.addUrl(a.target))
}}}}catch(h){}};b.addUrl=function(a){var d=a.getAttribute("pg");if(d&&d.indexOf("geturl")>-1){if(a.nodeName=="IMG"||a.nodeName=="SPAN"){a=a.parentElement}d=d.replace("geturl",a.getAttribute("href"))}return d};b.track=function(l){if(l!=null){var a=l.split("#");var j=null;if(l!=null){var k=l.indexOf("~"),h="action";if(k>-1){h=l.substr(k+1);l=l.substr(0,k)}var a=l.split("#"),i=a[0];if(toiprops._AB_version&&i!=="WEB-TOIFooter"){i=toiprops._AB_version}var j=null;if(a.length==1){j=ga("send","event",i,h)
}else{if(a.length==2||(a.length==3&&a[2]=="")){j=ga("send","event",i,h,a[1])}else{j=ga("send","event",i,h,a[1],a[2])}}}}};$(document).click(b.evtCap);return b});define("breakingnews",["jquery","tiljs/ajax","tiljs/load"],function(g,h,e){var f={};f.reloadtime=2000;f.breakingnews=function(){var a="/breakingnews.cms";if(document.location.hostname=="toidev8381.indiatimes.com"||document.location.hostname=="jcmsdev.indiatimes.com"){a="/test_breakingnews.cms"}if(window.homeObj&&window.homeObj.breakingNewsPause==0){h.get(a,function(d){d=d.replace(/[\r\n]/g,"");
if(!g.trim(d)){myMethod();f.reloadtime=180000;return true}var j=d.split(/[|]/g);window.isICC=0;g(j).each(function(i,l){if(msid&&l.indexOf(g.trim(msid))>-1){j.splice(i,1)}if(g(l).attr("data-type")=="icc"){isICC=1}else{isICC=0}});if(j.length===0){myMethod();f.reloadtime=180000;return true}g(".breaking-news .wrapper").html("");g(".breaking-news .wrapper").html("<ul id='js-news'/>");var b=0;var c=0;g.each(j,function(l,i){if(g(i).text().length>90){c+=(g(i).text().length-90);b++}i='<li class="news-item">'+i+"</li>";
g("#js-news").append(i)});if(isICC){g.fn.ticker.defaults.titleText='<a target="_blank" style="color:white;text-decoration:none;" data-track="ICC Champion|ticker_ref" href="https://mumbaimirror.indiatimes.com/sports/icc-champions-trophy-2017">ICC 2017 NEWS</a>'}else{g.fn.ticker.defaults.titleText="BREAKING NEWS"}myMethod(j.length,d.length,b,c)})}else{setTimeout(function(){f.breakingnews()},f.reloadtime)}myMethod=function(d,c,k,l){if(d&&c&&((isICC&&g("#pageName").val()=="default")||!isICC)){if(g("#js-news").ticker()){g("#js-news").show()
}if(isICC){g(".ticker-title").css("font-size","24px")}g(".breaking-news").show();if(d<2){g(".ticker-controls").hide()}if(!c){return true}f.reloadtime=d>1?d:2;c=d>1?c:c*2;var b=l*155;f.reloadtime=(d*6000)+f.reloadtime+b+(d*2500);f.reloadtime=f.reloadtime*5}else{g(".breaking-news").hide()}setTimeout(function(){f.breakingnews()},f.reloadtime)}};setTimeout(function(){if(g("#js-news")){f.breakingnews()}},1000);return f});define("global",[],function(){var d={};var c={};c.global=d;c.set=function(b,a){d[b]=a
};c.get=function(a){return d[a]};return c});define("navsearchbox",["jquery"],function(c){if(c("#pageType").val()&&c("#pageType").val().indexOf("video")!=-1){return}var d={};d.toTitleCase=function(a){return a.replace(/\w\S*/g,function(b){return b.charAt(0).toUpperCase()+b.substr(1).toLowerCase()})};d.validateForm=function(){if(c("#query").val()==""){alert("Please enter text to search");return false}else{var b=document.frmsearch1.query.value;var i=-1;i=document.frmsearch1.search1.value;var a=null;if(b==""){alert("Please enter text to search");
document.frmsearch1.query.focus();return false}switch(i){case"0":var j=d.toTitleCase(b);a="https://timesofindia.indiatimes.com/topic/"+j.replace(/\s+/g,"-");break;case"1":a="http://search.indiatimes.com/websearch.cms";document.frmsearch1.type.value=1;break;case"2":a="http://search.indiatimes.com/websearch.cms";document.frmsearch1.type.value=0;break;case"3":var j=d.toTitleCase(b);a="https://timesofindia.indiatimes.com/topic/"+j.replace(/\s+/g,"-")+"/videos";break;case"4":var j=d.toTitleCase(b);a="http://photogallery.indiatimes.com/resultsearch.cms?source=toisearch&q="+j.replace(/\s+/g,"-");
document.frmsearch1.target="_blank";break;default:break}ga("send","event","WEB-HPV2","Nav-Bar-Search","Search_initiate-"+document.frmsearch1.query.value);window.location.href=a;return false}};c("[data-plugin='navsearchboxvalidate']").on("submit",d.validateForm);(function(){window.navsearch={};var b,j,k,i,l;window.navsearch.handleAutoSearchResult=function(q){c("#nav_autosuggest_result").html("");if(q&&c.type(q)=="array"){var h=q[1].length;for(var g=0;g<h;g++){var e=q[1][g][0].replace(/\b[a-z]/g,function(m){return m.toUpperCase()
});var p="",f="https://timesofindia.indiatimes.com/topic/"+e.replace(/\s+/g,"-");p='<li><a href="'+f+'" target="_blank">'+e+"</li>";c("#nav_autosuggest_result").append(p)}j=c("#nav_autosuggest_result li")}};var a=null;c("[data-plugin='navsearchboxvalidate'] #query").on("keyup","",function(h){b=h.keyCode;var n=c(this).val().trim(),g=c("#nav_autosuggest_result");if(n&&!(b==40||b==38||b==27&&c("#nav_autosuggest_result").is(":visible"))){var e="https://suggestqueries.google.com/complete/search?client=youtube&jsonp=navsearch.handleAutoSearchResult&q="+n;
if(a){a.abort()}a=c.ajax({type:"GET",dataType:"jsonp",url:e,success:function(m){}})}else{if(n){if(b==27){!(c("#main-nav").length)&&c("#nav_autosuggest_result").closest(".search-form").removeClass("hover")}else{if(b==40){!(c("#main-nav").length)&&c("#nav_autosuggest_result").closest(".search-form").addClass("hover");if(!j.hasClass("selected")){j.first().addClass("selected");c("#query").val(j.first().find("a").text())}else{k=j.filter(".selected");var f;if(!k.length||k.is(":last-child")){f=j.eq(0)}else{f=k.next()
}k.removeClass("selected");f.addClass("selected");c("#query").val(f.find("a").text())}}else{if(b==38){!(c("#main-nav").length)&&c("#nav_autosuggest_result").closest(".search-form").addClass("hover");if(!j.hasClass("selected")){j.first().addClass("selected");c("#query").val(j.first().find("a").text())}else{k=j.filter(".selected");var f;if(!k.length||k.is(":first-child")){f=j.last()}else{f=k.prev()}k.removeClass("selected");f.addClass("selected");c("#query").val(f.find("a").text())}}}}}else{c("#nav_autosuggest_result").html("")
}}})})();return d});define("navigation",["jquery","tiljs/ajax","global","tiljs/plugin/lazy","tiljs/is","tiljs/cookie","navsearchbox"],function(B,u,H,C,x,G,A){var r={func:{},getelem:{},ajax:{}};H.set("nav",r);(function(){var b=G.get("geolocation");var a=(window.getCityJSON&&getCityJSON[b]&&getCityJSON[b]["lang"])?getCityJSON[b]["lang"]:"hindi";if(B("#nav-tv.category").length){u.get("/tvlistingdrop.cms?languagename="+a+"&type=default",function(c){B("#rnav45449811, #rnav41505232").remove();B("body").append(c)
})}})();jQuery(document).ready(function(b){var a=G.get("cnt");function c(d){if(d=="UK"){var e="";if(b("#nav-amazon").length>0){e="/amazonuk.cms"}else{e="/amazon_drop.cms?geoid=5"}b.get(e,function(f){b("#nav-amazon").replaceWith(f);b("#amzn_domain").show();b("li[drop='amazon']").html(f)})}else{b("#amzn_domain").show()}}});function F(b){var a=B(b).closest("li").find(".list7 li:first").attr("id");B("#rnav"+a).show()}function I(b){if(B(b).parent().attr("class").match(/current/)||B(b).parent().attr("class").match(/category/)){return true
}r.id=B(b).parent().attr("id");r.extfile="";r.extfile=B(b).attr("data-external");r.name=r.id.substring(4);B(b).parent().find("li:first").addClass("active");F(b);if(r.id=="nav-home"&&B("#rnav-2128932452")){B(".rnavclass").hide();B("#rnav-2128932452").show();if(!r.ajax[r.id]&&B(b).hasClass("lnavdata")){B(".level-one .loader").show()}}if(!r.ajax[r.id]&&B(b).hasClass("lnavdata")){var a=function(g){var c=g;if(typeof s!=="undefined"&&s==1){c=c+"&s="+s}if(c=="entertainment-tv"||c=="tv"){var d=G.get("geolocation");
var e=(window.getCityJSON&&getCityJSON[d]&&getCityJSON[d]["lang"])?getCityJSON[d]["lang"]:"hindi";u.get("/tvlistingdrop.cms?languagename="+e,function(h){B("#rhsnav"+g).append(h)})}if(c.match(/movie-reviews/g)){u.get("/nav_moviereview.cms?mvlang="+c,function(h){B("#rhsnav"+g).html(h)})}r.ajax["nav-"+g]=1;var f=(r.extfile)?r.extfile:"/homeajax.cms?nav="+c;B.ajax({url:f}).done(function(h){B("#rhsnav"+g).append(h);var i=B("#rhsnav"+g).siblings(".left-column").find(".list7 li:first").attr("id");i=i&&i.indexOf("lnav")>-1?i.replace("lnav",""):i;
B("#rnav"+i).show();B(".level-one .loader").hide();r.ajax["nav-"+g]=1;B("#rnavtravel").html();B("#rnavtravel").html(B("#rnav22806450").html());B("#rnav22806450").hide();if(r.id=="nav-home"&&B("#rnav-2128932452")){B(".rnavclass").hide();B("#rnav-2128932452").show()}C.load()}).fail(function(){r.ajax["nav-"+g]=0})};a(r.name)}if(!r.getelem[r.id]&&B("#rnav"+r.name).length){var a=function(c){$span=B("#rnav"+c).clone();B("#rnav"+c).remove();B("#nav-"+c+" #rhsnav"+c).append($span);B("#rnav"+c).show()};a(r.name);
r.getelem[r.id]=1}if(!r.timeoutId){r.timeoutId=window.setTimeout(function(){r.timeoutId=null;B(".level-one .hover").removeClass("hover");B("#rnav"+r.name).show();B("#"+r.id).addClass("hover");B("#rnav22806450").hide();C.load()},300)}}function y(){if(r.timeoutId){window.clearTimeout(r.timeoutId);r.timeoutId=null}else{B(".dropdown, .all-sections").mouseleave(function(){B(".level-one .hover").removeClass("hover");B(".list7 li.active").removeClass("active");B(".rnavclass").hide()})}}B("#header, #trending, #content, .article-content-wrapper, .breaking-news").hover(function(){B(".level-one .hover").removeClass("hover");
B(".search-form.hover").removeClass("hover");B(".rnavclass").hide()});B(".search-form").hover(function(){B(".level-one li").removeClass("hover")});B("#navigation").on("mouseenter",".navquery",function(){I(this)}).on("mouseleave",".navquery",function(){y(this)});B(".navquery").on("click",function(a){if(x.touch()){var b=window.curNav;window.curNav=B(this).attr("pg");if(typeof b==="undefined"||b!==window.curNav){I(this);return false}}return true});B(document).on("click"),function(){if(x.touch()&&window.curNav!==null){window.curNav=null;
y(this)}};function D(c){var a=B(c).attr("id");a=a.replace(/lnav/g,"");if(r.ajax[B(c).parents(".hover").attr("id")]!=1||B("#rnav"+a).length==0){r.activeTab=c;B(c).parents(".two-column-layout").find(".loader").show();B(".rnavclass").hide();return false}B(c).parents(".two-column-layout").find(".loader").hide();B(".rnavclass").hide();B(".level-one .active").removeClass("active");B(c).addClass("active");var b=B(c).parents("ul.level-one li");if(b.length==0){b=B(c).parents(".two-column-layout")}b.find("#rnav"+a).show();
B("#rnav22806450").hide();C.load()}B(".lnavclass").mouseover(function(){D(this)});B(".lnavclass a").click(function(){if(x.touch()){var a=window.curNav2;window.curNav2=B(this).attr("pg");if(typeof a==="undefined"||a!==window.curNav2){D(this);return false}}return true});B(".latestwidget").click(function(){r.id=B(this).attr("id");url="";loop=0;if(r.id=="latest"&&!r[r.id]){url="/mostread_blockibeat.cms?tabname=mostread"}else{if(r.id=="mostcommented"&&!r[r.id]){url="/mostcommented_block.cms?tabname=mostcomm"
}else{if(r.id=="mostshared"&&!r[r.id]){url="/mostshared_blocknew.cms?tabname=mostshared&top=5&tabname=mostshared";loop++}}}if(url!=""){t(url,loop)}B(".latestwidget").removeClass("active");B(this).addClass("active");B(".tabcontent").hide();B("."+r.id).show()});B(document).ready(function(){if(B(".mostshared ol li").length<=3){B("#mostshared").trigger("click")}});function t(a,b){b++;if(b>1){a=a+"&version=1"}u.get(a,function(c){if(B(c).find("ul li").length<=3&&b<2){t(a,b)}else{B("."+r.id+" ol").html(c);
r[r.id]=1;B("span.number").show()}})}B(".shopWidget").click(function(){r.id=B(this).attr("id");B(".shopWidget").removeClass("active");B(this).addClass("active");B(".tabcontent").hide();B("."+r.id).show();C.load()});setTimeout(function(){B("span.number").show()},500);var w=0,v="upwards";if(typeof(disabledStickyNav)==="undefined"){r.stickyTop=B("#navigation").offset()?B("#navigation").offset().top:0;B(window).scroll(function(){r.windowTop=B(window).scrollTop();if(r.windowTop>r.stickyTop){B("#navigation").addClass("sticky")
}else{B("#navigation").removeClass("sticky")}var a=B(this).scrollTop();if(a>w){v="downwards";B("body").removeClass("scroll-up").addClass("scroll-down")}else{v="upwards";B("body").addClass("scroll-up").removeClass("scroll-down")}w=a})}function E(){var a=null;return function(){if(B(window).width()<=999){if(!B("#navigation ul.level-one").hasClass("ipadflow")){B("#navigation ul.level-one").addClass("ipadflow");if(B("#navigation ul.level-one li.nav-ipad .drpdwn-nav-ipad li").length<1){var b=B('#navigation .level-one>li:visible:gt(8):not(".nav-home"):not(".nav-amazon"):not(".nav-ipad")').clone();
a=B('#navigation .level-one>li:visible:gt(8):not(".nav-home"):not(".nav-amazon"):not(".nav-ipad")');B("#navigation ul.level-one li.nav-ipad").append('<ul class="drpdwn-nav-ipad"></ul>');b.find("div.dropdown").remove();B("#navigation ul.level-one li.nav-ipad .drpdwn-nav-ipad").append(b);B("#navigation ul.level-one li.nav-ipad .drpdwn-nav-ipad").css("background",B("#navigation").css("background-color"));B("#navigation ul.level-one").addClass("nooverflow")}a.hide()}}else{if(a!=null){a.show();B("#navigation ul.level-one").removeClass("ipadflow")
}}}}var z=E();B(window).resize(function(){z()});B(document).ready(function(){loadVideos();if(!B("#pageType").val()||(B("#pageType").val()&&B("#pageType").val().indexOf("video")==-1)){B(".search-form").click(function(){B(".hover").removeClass("hover");B(this).addClass("hover");B("#nav_autosuggest_result").html("");B("#query").removeAttr("disabled");B("#query").focus()})}z()});return{}});define("compatibility_toi",[],function(){return{}});define("ajax",["tiljs/ajax"],function(b){return b});define("event",["tiljs/event"],function(b){return b
});define("localstorage",["tiljs/localstorage"],function(b){return b});define("preload",[],function(){});define("util",["tiljs/util"],function(b){return b});define("is",["tiljs/is"],function(b){return b});define("ui",["tiljs/ui"],function(b){return b});define("cookie",["tiljs/cookie"],function(b){return b});define("event",["tiljs/event"],function(b){return b});define("plugin/lazy",["tiljs/plugin/lazy"],function(b){return b});define("load",["tiljs/load"],function(b){return b});define("toicommonjs/rodate",["rodate"],function(b){return b
});define("logger",["tiljs/logger"],function(b){return b});define("page",["tiljs/page"],function(b){return b});define("user",["tiljs/user"],function(b){return b});define("times/comments",["comments"],function(b){return b});define("authorcomments",["tiljs/apps/times/authorcomments"],function(b){return b});define("tiljs/apps/times/authorcomments",["jquery","event","plugin/lazy"],function(g,h,e){var f={};f.run=function(){h.subscribe("comments.loaded",function(a){var l=g(a.config.main);if(!g("#"+g(l).attr("id")+' [id="authComment"]').length){var i=a.flagData?a.flagData.authorsComment:null;
if(i){var c=[];for(var d=0;d<i.length;d++){a.parseComment(i[d],c)}var b;b="<div id='authComment' style='border:1px solid #ccc;margin-bottom:10px;'><div class='authorTxt'>Author's Comment</div>";for(var d=0;d<c.length;d++){b=b+a.renderEach(d,c[d])}b=b+"</div>";l.prepend(b);e.load();g("#authComment .authorTxt:not(:first-child)").remove()}}})};return f});define("index",["./preload","./config","tiljs/compatibility","login","./api","tiljs/plugin/dynamic","./rodate","tiljs/plugin/lazy","tiljs/event","tiljs/util","./comments","./homepage","./crwdcnctrl","tiljs/social/facebook","tiljs/social/twitter","tiljs/social/pinterest","tiljs/social/linkedin","tiljs/social/googleplus","tiljs/plugin/pre_event","pgtrack","breakingnews","navigation","localstoragec","global","tiljs/load","jquery","./compatibility_toi","tiljs/apps/times/authorcomments"],function(U,M,ah,Q,N,ac,X,H,e,ag,aa,G,J,ae,Z,S,L,K,V,ai,ad,af,R,I,Y,ab,T,O){setTimeout(function(){Q.init()
},1000);window.toicommonjs=true;e.subscribe(["user.login","user.logout"],function(a){ag.reloadIframe("#fbk");document.cookie="ssolt=null; domain=.indiatimes.com; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT"});try{ab(document).on("click",'[data-action="login"]',function(){Q.login();return false})}catch(P){}ab(document).off("contextmenu").on("contextmenu","img",function(a){return false});require(["ajax","cookie","event","tiljs/social/facebook","tiljs/social/twitter","tiljs/social/pinterest","tiljs/social/linkedin","tiljs/social/googleplus"],function(c,g,d,h,f,a,i,b){ab("blockquote").each(function(){if(typeof FB=="undefined"&&/facebook/.test(ab(this).attr("cite"))){h.init({init:true,parse:true})
}if(typeof twttr=="undefined"&&/twitter/.test(ab(this).attr("class"))){f.init({parse:true})}});ab(window).load(function(){if(ab(".g-ytsubscribe").length){Y.js("https://apis.google.com/js/platform.js",function(){})}});d.subscribe("user.status",function(k){var j=g.get("ssoid");var l=g.get("ssolt");if((l===undefined&&j!==undefined)||(l&&j&&l!=j)){c.ajax({url:"https://jsso.indiatimes.com/sso/crossdomain/getTicket?channel=toi&platform=web&version=v1",dataType:"jsonp",success:function(m){if(m&&m.ticketId){var n="https://socialappsintegrator.indiatimes.com/socialsite/v1validateTicket?ticketId="+m.ticketId+"&channel=toi";
c.getJSONP(n,function(o){if(o&&o.code==200){now=new Date();then=new Date(new Date().setHours(24,0,0,0));g.set("ssolt",j,(then.getTime()-now.getTime())/(1000*60*60*24),"/",".indiatimes.com","")}})}}})}})});var W=window.TimesApps||{};W.SignIn=function(){require(["tiljs/login"],function(a){a.login()})};W.comscoreTrackingConfig={comscoreCustomerId:"6036484",stationTitle:"AhmedabadMirror",publisherName:"The Times of India",contentGenre:"News",c3:"10"};(function(a,r,p){var am=p(r),B={configSelectors:{},urls:{},cssClasses:{hover:"active",twoColumn:"two-column",rightColumn:"right-column",leftColumn:"left-column",loader:"nav-loading",dropdown:"dropdown"}},al={domSelectors:{navigation:"#main-nav",navItem:"li[data-menu-type]",preloadData:"[data-preload]",leftColumnItem:"li[data-id]",visibleLinks:"#main-nav .visible-links",hiddenLinks:"#main-nav .hidden-links",moreBtn:"#main-nav .cyclicnav",cyclicClass:".cyclicnav",preloaded:"[data-preloaded]"}},A={},C={processing:false},o,v=false,k={},l=[],E={};
function w(){var ao={};return p.extend(true,al,ao)}function q(ao){A.$navigation=p(o.domSelectors.navigation);A.$navItems=A.$navigation.find(o.domSelectors.navItem);A.$header=p("#header");A.$subNav=A.$header.find("#sub-nav");A.$bottomArea=A.$header.find(".bottom-area");A.$allMenu=p("#allmenu");A.$menuMore=p("[data-more-nav]");A.$allMenuContent=p("#allmenu-content")}function j(au,ay){var az=p("#main-nav").find('li[data-id="'+au+'"]'),av=az.text(),ax=az.find("a").attr("href"),aw={title:av,link:ax};if(ay===B.cssClasses.twoColumn){az.closest("."+B.cssClasses.dropdown).find("."+B.cssClasses.rightColumn).html("").addClass(B.cssClasses.loader)
}else{az.find("."+B.cssClasses.dropdown).html("").addClass(B.cssClasses.loader)}}function h(ar){var at=ar;if(typeof ar==="string"){at=at.replace(/\s\s+/g," ");while(at.indexOf("<!--")>-1){at=at.substr(0,at.indexOf("<!--"))+at.substr(at.indexOf("-->")+3,at.length)}try{at=JSON.parse(at)}catch(aq){at=null}}return at}function d(az,av){var ay,au=az.data("id"),aw=az.data("params"),ax=az.data("external");if(ax){ay=ax}else{ay="/navjson/nav-"+au+".cms";if(av&&aw&&au){ay+="?"+aw}}return ay}function f(at,aq,ar){p.ajax({url:d(at,ar)}).then(function(an){if(typeof aq==="function"){aq(an)
}}).fail(function(an){j(id)})}function z(aE,aG){var aB,az=false,ay=false,aD=aE,aC,aA,aF=aG.data("menu-type"),aH=aG.find("."+B.cssClasses.dropdown);switch(aF){case"top-stories":(aE.stories&&aE.stories.length&&(az=true))||(ay=true);break;case"multi-list":(aE.lists&&aE.lists.length&&(az=true))||(ay=true);break;case"simple-list":(aE.items&&aE.items.length&&(az=true))||(ay=true);break;case"two-column":(aE.items&&aE.items.length&&(az=true))||(ay=true);break}if(ay){j(aG.data("id"))}else{if(az){aB=p.templates("#"+aF+"-menu-tmpl");
if(aF==="two-column"){aC=aH.find("."+B.cssClasses.leftColumn+" "+al.domSelectors.leftColumnItem);aA=aC.filter("."+B.cssClasses.hover);aH=aH.find("."+B.cssClasses.rightColumn)}aD=aB.render(aE)}}aH.html(aD);aH.removeClass(B.cssClasses.loader);if(aE.items&&aE.items.length){aj(aE)}if(aA&&aA.length){b.call(aA.get(0))}require(["tiljs/plugin/lazy"],function(an){an.load()})}function x(ao){ao.data("loading",true);f(ao,function(aq){var an=aq;if(ao.data("menu-type")!=="external-html"){an=h(aq)}if(!an){return
}ao.data("loaded",true);ao.data("loading",false);z(an,ao)})}function t(at){var ar=at.find("."+B.cssClasses.leftColumn),aq=ar.find("li").get(0);b.call(aq)}function g(aq){var at=p(this),ar=at.find(o.domSelectors.leftColumnItem+"."+B.cssClasses.hover);if(!at.data("loaded")&&!at.data("loading")){x(at)}if(!ar.length){t(at)}}function c(ap){var aq=p(this);p("#main-nav .active").removeClass("active")}function aj(ao){p.each(ao.items,function(){k[this.catkey]={stories:this.stories,className:(this.className?this.className:null),domain:(this.domain?this.domain:null),catkey:this.catkey}
})}function i(){}function ak(av){var at=new Date().getTime();try{var ax=JSON.parse(localStorage.getItem(av));var aw=ax.timestamp+(ax.expires*24*60*60*1000);if(aw>at){return ax.value}return false}catch(au){m()}}function m(){var au=new Date().getTime();var at=new RegExp("taffy_");for(_x in localStorage){try{var av=JSON.parse(localStorage[_x]);if(!av.timestamp){continue}ed=(av.expires)?av.expires:1;ed=av.timestamp+(ed*24*60*60*1000);if(au>ed){localStorage.removeItem(_x)}}catch(ar){}}}function F(){function ao(an){p(o.domSelectors.navItem+o.domSelectors.preloadData).each(function(){var au=p(this),at=au.data("id"),av=ak(at);
if(av&&nl===undefined){z(av,au)}else{if(an==1){f(au,function(ap){var aq=ap,ar=au.data("menu-type");if(ar!=="external-html"){aq=h(ap);if(ar==="top-stories"){au.data("loaded",true)}}if(!aq){return}z(aq,au);localStorage.setItem(at,JSON.stringify(aq))},true)}}})}setTimeout(function(){ao(1)},"3000")}function D(){A.$navigation.on("mouseover",o.domSelectors.navItem,g);A.$menuMore.on("mouseover",function(){p(this).toggleClass(B.cssClasses.hover);A.$allMenuContent.addClass(B.cssClasses.hover);if(!A.$allMenuContent.data("loaded")){A.$allMenuContent.addClass(B.cssClasses.loader);
p.ajax({url:"/allmenu.cms"}).then(function(ao){A.$allMenuContent.html(ao);A.$allMenuContent.removeClass(B.cssClasses.loader);A.$allMenuContent.data("loaded",true)}).fail(function(){})}});p(document).on("mouseover",function(ao){if(!p(ao.target).closest(A.$allMenuContent).length&&!p(ao.target).closest("li.all-sections").length){A.$allMenuContent.removeClass(B.cssClasses.hover)}});p(document).on("click",function(au){if(!p(au.target).closest(A.$navigation).length){return}var av=require("is");var ax=!p(au.target).closest(".no-hover").length;
var aw=p(au.target).closest(".jDropdownOpen").length;C.tapTrack=C.tapTrack||{};C.tapTrack.latesttap=C.tapTrack.latesttap||new Date().getTime();if(!aw&&ax&&av.touch()){var ay=new Date().getTime();var az=ay-C.tapTrack.latesttap;p(o.domSelectors.navItem).removeClass("jDropdownOpen");p(au.target).closest("li").addClass("jDropdownOpen");if(!(p(au.target).closest(A.$allMenu).length||p(au.target).closest(A.$menuMore).length)){A.$allMenuContent.removeClass(B.cssClasses.hover);A.$allMenu.removeClass(B.cssClasses.hover)
}C.tapTrack.latesttap=new Date().getTime();return false}});A.$allMenu.on("click",function(){A.$allMenuContent.toggleClass(B.cssClasses.hover);if(A.$allMenuContent.hasClass(B.cssClasses.hover)){A.$allMenu.addClass(B.cssClasses.hover)}else{A.$allMenu.removeClass(B.cssClasses.hover)}if(!A.$allMenuContent.data("loaded")){A.$allMenuContent.addClass(B.cssClasses.loader);p.ajax({url:"/allmenu.cms"}).then(function(ao){A.$allMenuContent.html(ao);A.$allMenuContent.removeClass(B.cssClasses.loader);A.$allMenuContent.data("loaded",true)
}).fail(function(){})}});if(!p("#pageType").val()||(p("#pageType").val()&&p("#pageType").val().indexOf("video")==-1)){p(".search-form .search-btn").click(function(){var ar=p(this).closest(".search-form"),at=ar.hasClass("active"),aq=ar.find("form input#query");if(at){ar.removeClass("active");aq.blur()}else{ar.addClass("active");aq.focus()}})}}function b(){var az=p(this),aH=az.data("id"),aB=az.data("external"),aD=az.data("param-lang"),aE,aG=az.closest("."+B.cssClasses.dropdown+"."+B.cssClasses.twoColumn),aA=aG.find("."+B.cssClasses.leftColumn),ay=aA.find("li[data-id]"),aF=aG.find("."+B.cssClasses.rightColumn),aC=p.templates("#top-stories-menu-tmpl");
ay.removeClass(B.cssClasses.hover);az.addClass(B.cssClasses.hover);if(aB){if(E[aH]){aF.html(E[aH]);az.closest("."+B.cssClasses.dropdown).find("."+B.cssClasses.rightColumn).removeClass(B.cssClasses.loader);require(["tiljs/plugin/lazy"],function(an){an.load()})}else{require(["tiljs/cookie"],function(an){var aq=an.get("geolocation"),ap=(window.getCityJSON&&getCityJSON[aq]&&getCityJSON[aq]["lang"])?getCityJSON[aq]["lang"]:"hindi",ao=aB;if(aD){ao=ao+(ao.indexOf("?")>-1?"&":"?")+aD+"="+ap}az.closest("."+B.cssClasses.dropdown).find("."+B.cssClasses.rightColumn).html("").addClass(B.cssClasses.loader);
p.ajax({url:ao}).then(function(ar){E[aH]=ar;aF.html(ar);az.closest("."+B.cssClasses.dropdown).find("."+B.cssClasses.rightColumn).removeClass(B.cssClasses.loader);require(["tiljs/plugin/lazy"],function(at){at.load()})}).fail(function(){j(aH,B.cssClasses.twoColumn)})})}}else{if(k[aH]&&k[aH].stories&&k[aH].stories.length){aE=aC.render(k[aH]);aF.html(aE);az.closest("."+B.cssClasses.dropdown).find("."+B.cssClasses.rightColumn).removeClass(B.cssClasses.loader);require(["tiljs/plugin/lazy"],function(an){an.load()
})}else{j(aH,B.cssClasses.twoColumn)}}}function y(){$leftColumns=A.$navigation.find("."+B.cssClasses.leftColumn);$leftColumns.each(function(){var ao=p(this);ao.on("mouseover",al.domSelectors.leftColumnItem,function(an){an.stopPropagation();b.call(this)})})}function u(at){var aq=at.offset()?at.offset().top:0,ar;am.scroll(function(){ar=am.scrollTop();if(ar>aq){at.addClass("sticky")}else{at.removeClass("sticky")}})}function n(){p("."+B.cssClasses.leftColumn+" "+al.domSelectors.leftColumnItem).each(function(){var at=p(this),aq=at.data("id"),ar=(function(){try{return JSON.parse(localStorage.getItem(aq))
}catch(an){return null}})();if(ar&&ar.items.length){aj(ar)}})}a.NavigationManager={init:function(){o=w();q();D();n();F();i();y();u(A.$bottomArea);if(!p("#pageType").val()||(p("#pageType").val()&&p("#pageType").val().indexOf("video")==-1)){require(["navsearchbox"],function(ao){})}},updateNav:function(){var ao=p(al.domSelectors.moreBtn).hasClass("hidenav")?p(al.domSelectors.navigation).width():p(al.domSelectors.navigation).width()-p(al.domSelectors.moreBtn).width()-30;if(p(al.domSelectors.visibleLinks).width()>ao-20){l.push(p(al.domSelectors.visibleLinks).width());
p(al.domSelectors.visibleLinks).children().not(al.domSelectors.cyclicClass).not(".current").last().prependTo(p(al.domSelectors.hiddenLinks));if(p(al.domSelectors.moreBtn).hasClass("hidenav")){p(al.domSelectors.moreBtn).removeClass("hidenav")}}else{if(ao>l[l.length-1]){p(al.domSelectors.hiddenLinks).children().first().insertAfter(p(al.domSelectors.visibleLinks).children().not(al.domSelectors.cyclicClass).last());l.pop()}if(l.length<1){p(al.domSelectors.moreBtn).addClass("hidenav");p(al.domSelectors.hiddenLinks).addClass("hidenav")
}}p(al.domSelectors.moreBtn).attr("count",l.length);p(al.domSelectors.visibleLinks).addClass("show-extra");if(p(al.domSelectors.visibleLinks).width()>ao){this.updateNav()}}}})(window.TimesApps,window,jQuery);ab(window).load(function(){ab("#main-nav").length&&window.TimesApps.NavigationManager.init();ab("#main-nav").length&&window.TimesApps.NavigationManager.updateNav()});ab(window).resize(function(){ab("#main-nav").length&&window.TimesApps.NavigationManager.updateNav()});window.top.adsCallback=function(a){if(typeof a!="undefined"&&a=="gutter"){setTimeout(function(){window.TimesApps.NavigationManager.updateNav()
},1000)}}});(function(){$(".slidingDiv").hide();$(".show_hide").show();$(".show_hide").click(function(a){a.preventDefault();if($(".slidingDiv").css("display")=="none"){$(this).find("span").removeClass("down-arrow").addClass("up-arrow")}else{$(this).find("span").removeClass("up-arrow").addClass("down-arrow")}$(".slidingDiv").stop(false,true).slideToggle()});$("div.cclab a").live("hover",function(){if($(this).text().trim().length>40){var a=$(this).parent().offset().left-30;var c=$(this).parent().offset().top-50;
var b=$(this).parent().find("span").text();$("#tooltip_a").html(b).css("left",a+"px").css("top",c+"px").show()}}).live("mouseout",function(){$("#tooltip_a").html("").hide()});if(jQuery("#sliderin").length){var A=jQuery("#sliderin > li").length,w=jQuery("#sliderin > li:first").outerWidth(true),D=(/iphone|ipod|android|blackberry|mini|iemobile|sce|palm/i.test(navigator.userAgent.toLowerCase()))==true?Math.floor($(".slidewrap").width()/w):Math.ceil($(".slidewrap").width()/w);_srtNo=D,count=D;_childCount=$("#sliderin li").size();
totalWidth1=w*A;jQuery("#sliderin").width(totalWidth1);jQuery("#gallery-next1").click(function(){if(count<_childCount){jQuery("#sliderin").animate({left:"-="+((w*1))+"px"});count=count+1;if(_childCount>D&&_childCount<=count){$("#gallery-next1 .gal-nextArw").removeClass("gal-nextArw");$("#gallery-next1 div").addClass("gal-nextArwhide")}for(var a=_srtNo;a<=_srtNo+D;a++){$(".dataimg"+a).attr("src",$(".dataimg"+a).attr("data-src"))}_srtNo=_srtNo+D;if(_srtNo==D*2){$("#gallery-prev1 .gal-prevArwhide").removeClass("gal-prevArwhide").addClass("gal-prevArw")
}$("#gallery-prev1 .gal-prvArwhide").removeClass("gal-prvArwhide").addClass("gal-prvArw")}return false});jQuery("#gallery-prev1").click(function(){if(jQuery("#sliderin").position().left<0&&!jQuery("#sliderin").is(":animated")){jQuery("#sliderin").animate({left:"+="+((w*1))+"px"});if(count>D){count--}_srtNo=_srtNo-D;if(_srtNo==D){$("#gallery-prev1 .gal-prvArw").removeClass("gal-prvArw").addClass("gal-prvArwhide")}$("#gallery-next1 .gal-nextArwhide").removeClass("gal-nextArwhide").addClass("gal-nextArw")
}return false})}if(jQuery(".slider_ph").length){var B=jQuery(".slider_ph > li").length,x=jQuery(".slider_ph > li:first").outerWidth(true),C=(/iphone|ipod|android|blackberry|mini|iemobile|sce|palm/i.test(navigator.userAgent.toLowerCase()))==true?Math.floor($(".slidewrap_sp").width()/x):Math.ceil($(".slidewrap_sp").width()/x),t=C,I=C;_childCount2=$(".slider_ph li").size();totalWidth2=x*B;jQuery(".slider_ph").width(totalWidth2);jQuery("#gallery-next1").click(function(){if(I<_childCount2){jQuery(".slider_ph").animate({left:"-="+((x*1))+"px"});
I=I+1;if(_childCount2>C&&_childCount2<=I){$("#gallery-next1 .gal-nextArw").removeClass("gal-nextArw");$("#gallery-next1 div").addClass("gal-nextArwhide")}for(var a=t;a<=t+C;a++){$(".dataimg"+a).attr("src",$(".dataimg"+a).attr("data-src"))}t=t+C;if(t==C*2){$("#gallery-prev1 .gal-prevArwhide").removeClass("gal-prevArwhide").addClass("gal-prevArw")}$("#gallery-prev1 .gal-prvArwhide").removeClass("gal-prvArwhide").addClass("gal-prvArw")}return false});jQuery("#gallery-prev1").click(function(){if(jQuery(".slider_ph").position().left<0&&!jQuery(".slider_ph").is(":animated")){jQuery(".slider_ph").animate({left:"+="+((x*1))+"px"});
if(I>C){I--}t=t-C;if(t==C){$("#gallery-prev1 .gal-prvArw").removeClass("gal-prvArw").addClass("gal-prvArwhide")}$("#gallery-next1 .gal-nextArwhide").removeClass("gal-nextArwhide").addClass("gal-nextArw")}return false})}if(jQuery(".slider_vdo").length){var E=jQuery(".slider_vdo > li").length,y=jQuery(".slider_vdo > li:first").outerWidth(true),F=(/iphone|ipod|android|blackberry|mini|iemobile|sce|palm/i.test(navigator.userAgent.toLowerCase()))==true?Math.floor($(".slidewrap_sp:eq(1)").width()/y):Math.ceil($(".slidewrap_sp:eq(1)").width()/y),u=F,J=F;
_childCount3=$(".slider_vdo li").size();totalWidth3=y*E;jQuery(".slider_vdo").width(totalWidth3);jQuery("#gallery-next2").click(function(){if(J<_childCount3){jQuery(".slider_vdo").animate({left:"-="+((y*1))+"px"});J=J+1;if(_childCount3>F&&_childCount3<=J){$("#gallery-next2 .gal-nextArw").removeClass("gal-nextArw");$("#gallery-next2 div").addClass("gal-nextArwhide")}for(var a=u;a<=u+F;a++){$(".dataimg"+a).attr("src",$(".dataimg"+a).attr("data-src"))}u=u+F;if(u==F*2){$("#gallery-prev2 .gal-prevArwhide").removeClass("gal-prevArwhide").addClass("gal-prevArw")
}$("#gallery-prev2 .gal-prvArwhide").removeClass("gal-prvArwhide").addClass("gal-prvArw")}return false});jQuery("#gallery-prev2").click(function(){if(jQuery(".slider_vdo").position().left<0&&!jQuery(".slider_vdo").is(":animated")){jQuery(".slider_vdo").animate({left:"+="+((y*1))+"px"});if(J>F){J--}u=u-F;if(u==F){$("#gallery-prev2 .gal-prvArw").removeClass("gal-prvArw").addClass("gal-prvArwhide")}$("#gallery-next2 .gal-nextArwhide").removeClass("gal-nextArwhide").addClass("gal-nextArw")}return false
})}if(jQuery(".slider_rec").length){var G=jQuery(".slider_rec > li").length,z=jQuery(".slider_rec > li:first").outerWidth(true),H=(/iphone|ipod|android|blackberry|mini|iemobile|sce|palm/i.test(navigator.userAgent.toLowerCase()))==true?Math.floor($(".slidewrap_sp:eq(2)").width()/z):Math.ceil($(".slidewrap_sp:eq(2)").width()/z),v=H,K=H;_childCount4=$(".slider_rec li").size();totalWidth4=z*G;jQuery(".slider_rec").width(totalWidth4);jQuery("#gallery-next3").click(function(){if(K<_childCount4){jQuery(".slider_rec").animate({left:"-="+((z*1))+"px"});
K=K+1;if(_childCount4>H&&_childCount4<=K){$("#gallery-next3 .gal-nextArw").removeClass("gal-nextArw");$("#gallery-next3 div").addClass("gal-nextArwhide")}for(var a=v;a<=v+H;a++){$(".dataimg"+a).attr("src",$(".dataimg"+a).attr("data-src"))}v=v+H;if(v==H*2){$("#gallery-prev3 .gal-prevArwhide").removeClass("gal-prevArwhide").addClass("gal-prevArw")}$("#gallery-prev3 .gal-prvArwhide").removeClass("gal-prvArwhide").addClass("gal-prvArw")}return false});jQuery("#gallery-prev3").click(function(){if(jQuery(".slider_rec").position().left<0&&!jQuery(".slider_rec").is(":animated")){jQuery(".slider_rec").animate({left:"+="+((z*1))+"px"});
if(K>H){K--}v=v-H;if(v==H){$("#gallery-prev3 .gal-prvArw").removeClass("gal-prvArw").addClass("gal-prvArwhide")}$("#gallery-next3 .gal-nextArwhide").removeClass("gal-nextArwhide").addClass("gal-nextArw")}return false})}$(".sbtn #searchButton").click(function(b){var a=$(".search-form1");if(a.is(":visible")){a.addClass("hide")}else{a.removeClass("hide").addClass("theme-form")}});$("#_searchForm").on("submit",function(a){var b=$("#searchKeyword").val();if((b.trim()=="SEARCH"||b.trim()=="")){alert("Please enter a keyword to search");
return false}return true});$(".search-form1 .textbox").on({focus:function(){$(this).val("")},blur:function(){$(this).val("SEARCH")}});$(document).ready(function(){$("#navigation").on("click",".toggle-nav-btn",function(){$("#navigation ul.level1").slideToggle()})});$(".mostcomment li").find("a").off("click").on("click",function(b){b.preventDefault();var a=$(".mostcomment li a.active"),c=$(this);if(c.is(a)){return}else{c.addClass("active");a.removeClass("active");$("#commentdata div").addClass("hideDiv");
$("#commentdata").find("."+c.data("day")).removeClass("hideDiv")}});$(".mostread li").find("a").off("click").on("click",function(b){b.preventDefault();var a=$(".mostread li a.active"),c=$(this);if(c.is(a)){return}else{c.addClass("active");a.removeClass("active");$("#latestbloData div").addClass("hideDiv");$("#latestbloData").find("."+c.data("day")).removeClass("hideDiv")}});$(".pollform .vote").on("click",function(){var b=$(this).parents(".pollform");if(!b.find('input[type="radio"]:checked').val()){alert("Please select an Option to participate in the poll");
return false}if(b.find(".mathans").text()!=b.find(".mathuserans").val()){alert("Please enter correct answer");return false}var a=$(this).parents(".main-poll").length>0?"vote_article.cms":"vote.cms";$.ajax({type:"POST",url:a,data:{PRadio:b.find('input[name="PRadio"]:checked').val(),txtPolliD:b.find("input[name='txtPolliD']").val()}}).done(function(c){b.parents(".poll-widget").html(c)})});$(document).ready(function(){$(".vid_items-list").mCustomScrollbar({theme:"light-2",scrollButtons:{enable:false},mouseWheel:{enable:true,scrollAmount:52}})
});require(["breakingnews","tiljs/cookie","jquery","tiljs/ui"],function(c,d,a,b){if(!d.get("BRKN_HIDE")){window.homeObj={};window.homeObj.breakingNewsPause=0;a(".breaking-news").on("click",".close_btn",function(e){a(".breaking-news .jnt-play-pause").click();a(this).parent().remove();d.set("BRKN_HIDE","1",1,"/","."+document.domain,false)});a(window).scroll(function(){if(a(window).width()<899){var e=a(".breaking-news .ticker-wrapper.has-js");if(b.inView(e,false,0)){e.css("height","auto")}else{e.css("height",a(".breaking-news .ticker-wrapper.has-js").outerHeight())
}}})}})}());require(["index"]);var TimesApps=window.TimesApps||{};TimesApps.VideoGalleryApp=(function(){var h,j,k,i,l,g;i={videoBoxMap:{},videoCount:0};g={PLAYING:"PLAYING",PAUSED:"PAUSED",AUTOPLAY_LOCALSTORAGE_KEY:"autoplay_userInitiated"};l=function(){var a=i;$(document).on("videodash.invokeVideo",function(c,b){j._playNext.call(null,[c,b,a])});$(document).on("videodash.userAction LIVE_TV_EVENTS",function(c,b,d){j._playCurrentAndPauseOthers.call(null,[c,b,d])});$(document).on("MINI_TV_EVENTS VOD_EVENTS",function(c,b,d){require(["tiljs/event"],function(e){e.publish("VOD_EVENTS",[c,b,d])
});j._playCurrentAndPauseOthers.call(null,[c,b,d]);if(d&&d.toUpperCase()=="VIDEOIFRAMEREMOVED"){TimesApps.playingSubsequentVideo=false}});$(document).on("GAANA_PLAYER_LOADED VOD_LOADED",function(b,c,e,d){i.pageName=i.pageName?i.pageName:($("body").data("page-name")||"");if(e=="VOD_LOADED"&&c.source=="MG_0"){return}j._processSystemInitiatedEvents.call(null,[b,c,e,d])});$(document).on("PLAYER_LOADED",function(b,c,e,d){j._processSystemInitiatedEvents.call(null,[b,c,e,d])});$(document).on("GAANA_PLAYER_EVENTS",function(c,b,d){j._playCurrentAndPauseOthers.call(null,[c,b,d])
});$(document).on("videodash.videoEvents LIVE_TV_EVENTS MINI_TV_LOADED",function(b,c,e,d){j._processSystemInitiatedEvents.call(null,[b,c,e,d])});require(["event"],function(b){b.subscribe("MINI_TV_EVENTS",function(c){var d={};var e=c[0];var f=c[1];j._playCurrentAndPauseOthers.call(null,[d,e,f])})});$(document).on("videodash.switchOffAutoPlay",function(b,c){j._toggleAutoPlay.call(null,[b,c])});$(".jMediaGalleryWidget").on("MG_EVENTS",function(b,c,e,d){j._processSystemInitiatedEvents.call(null,[b,c,e,d])
})};h={_createVideoObjForOtherTypePlayer:function(a,b,d,c,e){return new TimesApps.OtherVideoBox(a,b,d,c,e)}};j={_init:function(){l()},_playCurrentAndPauseOthers:function(b){var t=b[0];var a=b[1];var f=typeof b[2]=="string"&&b[2].toUpperCase();var c=a.source.toUpperCase();if(i.videoBoxMap[c]){var e=i.videoBoxMap[c];e.setStatus(g.PLAYING);if(TimesApps.isDevMode){console.log("VOD_STATUS_playing__"+c+"__videoMap-",i.videoBoxMap)}j._pauseVideosNotInFocus.call(null,[t,a,f])}if(t.type=="VOD_EVENTS"&&f=="VIDEOREADY"){var c=a.source.toUpperCase();
if(i.videoBoxMap[c]){var q=i.videoBoxMap[c];if(q.markPlaying){q.markPlaying(a.id)}if(q.findNext){var u=q.findNext(q.domEle.find(".playing"));var r=q.domEle.find("iframe")[0].contentWindow;var d=u.attr("data-msid")||"";if(r.TimesApps&&r.TimesApps.Vod_Player&&r.TimesApps.Vod_Player.addNextVideoToList){r.TimesApps.Vod_Player.addNextVideoToList(d)}}}}},_processSystemInitiatedEvents:function(o){var c=o[0];var d=o[1];var f=typeof o[2]=="string"&&o[2].toUpperCase();var a=d.source.toUpperCase();if(f=="VIDEOREADY"){j._pauseVideosNotInFocus.call(null,[c,d,f]);
if(j._checkIfVideoShouldPause(a)){j._pauseVideo(a)}}else{if(f=="LIVE_TV_LOADED"||f=="MG_LOADED"||f=="MINI_TV_LOADED"||f=="GAANA_PLAYER_LOADED"||f=="VOD_LOADED"||f=="PLAYER_LOADED"){var p=d.domSelector;var e=o[3];if(f=="LIVE_TV_LOADED"||f=="MINI_TV_LOADED"||f=="GAANA_PLAYER_LOADED"||f=="VOD_LOADED"||f=="PLAYER_LOADED"){j._turnOffAutoPlayForAll()}if(f=="MINI_TV_LOADED"){TimesApps.overlayModule&&TimesApps.overlayModule.close()}var b=(d.userInitiated==true)?false:true;j._registerOtherTypePlayers(a,p,e,b,d.msid)
}}},_checkIfVideoShouldPause:function(a){var b=i.videoBoxMap[a];if(b.getStatus()==g.PAUSED){return true}return false},_pauseVideo:function(a){var b=i.videoBoxMap[a];if(b&&typeof b.pauseVideo=="function"){b.pauseVideo()}},_pauseVideosNotInFocus:function(b){var t=b[0];var a=b[1];var q=typeof b[2]=="string"&&b[2].toUpperCase();var c=a.source.toUpperCase();if(q=="PLAYING"||q=="VIDEOREADY"||q=="START"){if(i.videoBoxMap[c]){var f=i.videoBoxMap[c]}var e=Object.keys(i.videoBoxMap);for(var d=0;d<e.length;
d++){var c=e[d].toUpperCase();var r=i.videoBoxMap[c];if(c!=f.getId()){r.setStatus(g.PAUSED);j._pauseVideo(c)}}}},_playNext:function(f){var e=f[0];var c=f[1];var b=f[2];var a=c.source.toUpperCase();if(b.videoBoxMap[a]){var d=b.videoBoxMap[a];if(d&&typeof d.playNext=="function"){d.playNext()}}},_toggleAutoPlay:function(c){var a=c[0];var b=c[1];localStorage.setItem(g.AUTOPLAY_LOCALSTORAGE_KEY,b.stxt)},_addNewVideo:function(c,d){var a=c.id;var b=new TimesApps.VideoBox(c,d);i.videoBoxMap[a]=b;i.videoCount++
},_addOtherTypeVideo:function(b,a,d,c,f){var e=h._createVideoObjForOtherTypePlayer(b,a,d,c,f);i.videoBoxMap[b]=e;i.videoCount++},_turnOffAutoPlayForAll:function(){var a=Object.keys(i.videoBoxMap);for(var d=0;d<a.length;d++){var b=a[d].toUpperCase();var c=i.videoBoxMap[b];if(typeof c.setAutoPlay=="function"){c.setAutoPlay(false)}}},_registerOtherTypePlayers:function(b,a,d,c,e){b=b.toUpperCase();j._addOtherTypeVideo(b,a,d,c,e)}};k={init:function(){return j._init()},addNewVideo:function(a,b){return j._addNewVideo(a,b)
},getVideoCount:function(){return i.videoCount},getVideoList:function(){return i.videoBoxMap},pauseVideo:function(a){return j._pauseVideo(a)}};j._init();return k}());TimesApps.OtherVideoBox=function(i,j,l,k,g){this.id=i;this.domEle=$(j).eq(0);this.status="PLAYING";this.pauseVideoCallBack=l;this.msid=g;this.config={autoplay:k||false};var h=this;this.domEle.on("click",function(a){h.setStatus("PLAYING")})};TimesApps.OtherVideoBox.prototype.getStatus=function(){return this.status};TimesApps.OtherVideoBox.prototype.setStatus=function(b){this.status=b
};TimesApps.OtherVideoBox.prototype.getId=function(){return this.id};TimesApps.OtherVideoBox.prototype.pauseVideo=function(){if(typeof this.pauseVideoCallBack=="function"){this.pauseVideoCallBack()}else{if(typeof this.domEle.prop("contentDocument")=="undefined"){return}var b=this.domEle.prop("contentDocument").embeds.myMovie;if(typeof b=="undefined"){return}this.setStatus("PAUSED");b.pauseVideo()}};var TimesApps=window.TimesApps||{};TimesApps.VideoBox=function(j,o){var q=$.extend({},{autoplay:1,index:0},j);
this.config=q;this.domEle=o;this.id=q.id;var m=this.domEle.find("li");var n=m.eq(0).attr("data-msid");if(typeof n!="undefined"){this.msid=n;var r=this.formVideoSrcUrl(m.eq(0));var p=this.createImgUrl();this.setPlayerData(p,this.msid);var k=this.config.autoplay?"PLAYING":"PAUSED";this.setStatus(k);var l=this;if(this.config.autoplay){$(window).one("scroll",function(){if(l.domEle.find(".playing").length==0&&l.config.autoplay){l.addIframe.call(l,m.eq(0),r);l.styleVideo.call(l)}})}}var l=this;this.domEle.on("click",function(b){b.preventDefault();
var c=$(b.target);if(c.closest(".jSocialIcons").length>0){var a=require("pgtrack");a.evtCap(b)}else{if(c.closest(".jVideoList li").length>0){l.setStatus("PLAYING");l.playVideo.call(l,[b]);l.domEle.find(".vid_mainplayer img").hide();l.clickHandler.call(l,[b]);l.styleVideo.call(l,[])}else{if(c.closest(".vid_mainplayer").length>0){l.domEle.find(".jVideoList li").eq(0).trigger("click")}}}});if(!this.config.autoplay){this.domEle.find(".jVideoList").on("mouseover",function(a){l.handleHover.call(l,a)})}};
TimesApps.VideoBox.prototype.getId=function(){return this.id};TimesApps.VideoBox.prototype.setStatus=function(b){if(b.toUpperCase()=="PLAYING"){this.status="PLAYING"}else{this.status="PAUSED"}};TimesApps.VideoBox.prototype.getStatus=function(){return this.status};TimesApps.VideoBox.prototype.setAutoPlay=function(b){this.config.autoplay=b};TimesApps.VideoBox.prototype.createImgUrl=function(){return"/photo/"+this.msid+".cms"};TimesApps.VideoBox.prototype.handleHover=function(h){var g=$(h.target);var e=g.closest("li").attr("data-msid");
if(typeof e!="undefined"){this.setMsid(e);var f=this.createImgUrl();this.setPlayerData(f,this.msid)}};TimesApps.VideoBox.prototype.clickHandler=function(g){var h=g[0];var f=$(h.target);var e=f.closest("li");this.removePlayingClass(e.siblings())};TimesApps.VideoBox.prototype.setMsid=function(b){this.msid=b};TimesApps.VideoBox.prototype.playVideo=function(j){var k=j[0];var h=$(k.target);var l=h.closest("li");var g=l.attr("data-msid");this.setMsid(g);var i=this.formVideoSrcUrl(l);this.addIframe.call(this,l,i)
};TimesApps.VideoBox.prototype.styleVideo=function(){var b="/photo/"+this.msid+".cms";this.domEle.find(".vid_mainplayer").css("background-image","url("+b+")");this.domEle.find(".vid_mainplayer iframe").addClass("loading")};TimesApps.VideoBox.prototype.setThumbImages=function(){var b=this.domEle.find(".vid_items-list ul li");b.each(function(){var a=$(this);var h=$(this).attr("data-msid");if(typeof h=="undefined"){h=a.find("[data-msid]").data("msid");a.attr("data-msid",h)}var f="/thumb/msid-"+h+",width-400,resizemode-4/"+h+".cms";
var g="/photo/"+h+".cms";a.find("img").attr("data-src",f).attr("src",g)})};TimesApps.VideoBox.prototype.setPlayerData=function(c,d){this.domEle.find(".vid_mainplayer img").removeClass("hidden").attr("src",c);this.domEle.find(".vid_mainplayer").attr("current_msid",d)};TimesApps.VideoBox.prototype.formVideoSrcUrl=function(k){if(this.config.autoplay){var i="off"}else{if(!this.config.autoplay){var i="on"}}var g=this.msid||k.attr("data-msid");var l=this.findNext(k);nxt_msid=l.attr("data-msid");nxt_title=l.find("span").data("title")||"";
nxt_title=encodeURIComponent(nxt_title);var h=k.data("pos");if(this.id=="MG_0"&&h=="1"){videoSection="homepage.top-first-videos"}else{videoSection="homepage.top-rest-videos"}var j="/vod_player.cms?msid="+g+"&videosection="+videoSection+"&rlvideo=3812907&source="+this.config.id+"&audio=5";j+="&relatedvideo=pagevar&toividpage=homepage&autoplay=1";j+="&utm_source=DesktopHome&utm_medium=LatestNews&utm_campaign=VideoPlug&pg=toihp";j+="&version=2";if(!this.config.autoplay){j+="&userInitiated=1"}if(this.domEle.attr("data-autoplay")==1){j+="&hpauto=1&stxt="+i
}return j};TimesApps.VideoBox.prototype.addIframe=function(d,c){d.addClass("playing");this.domEle.find(".vid_mainplayer i").hide();this.domEle.find(".vid_mainplayer").find("iframe").attr("src",c);this.domEle.find(".jVideoList").off("mouseover")};TimesApps.VideoBox.prototype.pauseVideo=function(){this.setStatus("PAUSED");var d=this.domEle.find("iframe").eq(0).prop("contentWindow");if(typeof d=="undefined"||!d.TimesApps||!d.TimesApps.VideoPlayer2){return}var c=d.TimesApps.VideoPlayer2;if(typeof c=="undefined"||!c){return
}if(!c.getPlayer&&!c.getPlayer("VOD")&&!c.getPlayer("VOD").pause){return}c.getPlayer("VOD").pause()};TimesApps.VideoBox.prototype.playNext=function(){var j=this.domEle;var h=j.find(".playing");var i=this.findNext(h);var f=i.attr("data-msid");this.setMsid(f);this.setStatus("PLAYING");var g=i.data("pos");$(".jVideoList").mCustomScrollbar("scrollTo",$(".jVideoList li:nth-child("+g+")").position().top,{timeout:0,scrollInertia:200});this.setAutoPlay(true)};TimesApps.VideoBox.prototype.markPlaying=function(b){this.setMsid(b);
this.setStatus("PLAYING");this.domEle.find(".vid_mainplayer img").hide();this.domEle.find(".playing").removeClass("playing");this.domEle.find("[data-msid='"+b+"']").addClass("playing")};TimesApps.VideoBox.prototype.removePlayingClass=function(b){b.filter(".playing").removeClass("playing")};TimesApps.VideoBox.prototype.findNext=function(d){var e;var f=this.domEle.eq(0).find(".jVideoList li").size();if(d.index()<f-1){e=d.next()}else{e=this.domEle.find("li").first()}return e};var loadVideos=function(){var k=localStorage.getItem("autoplay_userInitiated");
if(k=="on"){var j=0}else{var j=1}var l=$(".video_parent");for(var m=0;m<l.length;m++){var n=l.eq(m).attr("data-autoplay");var i=(parseInt(n)&&j);var h={autoplay:i,id:"MG_"+m};TimesApps.VideoGalleryApp.addNewVideo(h,l.eq(m))}};